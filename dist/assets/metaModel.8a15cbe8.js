import{b as g,a8 as le,d as ie,O as se,ac as oe,a as V,L as ue,r as w,M as a,N as i,S as v,Z as I,Q as P,V as C,W as p,F as m,ah as y,$ as c,Y as h,X as F,as as D,au as pe,al as ce,ai as me,a1 as de,bQ as re,R as _e,aB as ve,aa as ye}from"./index.3614183b.js";import{_ as fe}from"./index.5931ae8c.js";/* empty css              *//* empty css               */import{P as ke,a as he,_ as ge}from"./index.01976f6f.js";import{_ as be}from"./index.89207c6a.js";/* empty css               */var Ve={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M880 112H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V144c0-17.7-14.3-32-32-32zM704 536c0 4.4-3.6 8-8 8H544v152c0 4.4-3.6 8-8 8h-48c-4.4 0-8-3.6-8-8V544H328c-4.4 0-8-3.6-8-8v-48c0-4.4 3.6-8 8-8h152V328c0-4.4 3.6-8 8-8h48c4.4 0 8 3.6 8 8v152h152c4.4 0 8 3.6 8 8v48z"}}]},name:"plus-square",theme:"filled"};const $e=Ve;function J(d){for(var o=1;o<arguments.length;o++){var u=arguments[o]!=null?Object(arguments[o]):{},f=Object.keys(u);typeof Object.getOwnPropertySymbols=="function"&&(f=f.concat(Object.getOwnPropertySymbols(u).filter(function(b){return Object.getOwnPropertyDescriptor(u,b).enumerable}))),f.forEach(function(b){xe(d,b,u[b])})}return d}function xe(d,o,u){return o in d?Object.defineProperty(d,o,{value:u,enumerable:!0,configurable:!0,writable:!0}):d[o]=u,d}var M=function(o,u){var f=J({},o,u.attrs);return g(le,J({},f,{icon:$e}),null)};M.displayName="PlusSquareFilled";M.inheritAttrs=!1;const qe=M,Ce={style:{height:"100%","overflow-x":"hidden!important"}},Se={key:1},we={key:2},Ie={key:3},Oe={key:1},Ue={key:5,class:"editable-row-operations"},Pe={key:0},Me=["onClick"],Be=["onClick"],Ne={key:1},Te=["onClick"],Fe={style:{"margin-left":"0.625rem"}},De=ie({__name:"metaModel",setup(d){se();let o=oe();sessionStorage.setItem("meta_"+o.params._id,JSON.stringify(o.params._id));let u=V();async function f(e){let l=await P.get(`/api/templates/${e}`,{params:{q:"category:meta",search:""}});o.params.name=l.name,u.value=l,u.value.model=l.model,l.model&&l.model.length>0&&(r.value=b(l.model))}const b=e=>e.map((l,k)=>({...l,editing:!1,inputVisible:!1,inputValue:""}));ue(()=>{let e=sessionStorage.getItem("meta_"+o.params._id);console.log(JSON.parse(e)),f(JSON.parse(e))});let r=V([]);const R=w({});let s=w({name:"",description:"",type:"",enum:[],required:!1,editing:!0,inputVisible:!1,inputValue:""}),B=sessionStorage.getItem("meta_"+o.params._id);const j=async e=>{e.__v?delete e.__v:(await P.put(`/api/templates/${JSON.parse(B)}`,{model:e}),_e.success("Modification succeeded"),$.value=!0,N())};let $=V(!0);const z=e=>{s.name=e.name,s.description=e.description,s.type=e.type,s.enum=e.enum,s.required=e.required,e.editing=!0,$.value=!1},N=()=>{s.name="",s.description="",s.type="",s.enum=[],s.required=!1,s.editing=!0,s.inputVisible=!1,s.inputValue=""},A=async e=>{console.log(e),e.editing=!1,await j(r.value)},H=async e=>{r.value=r.value.filter(l=>l!==e),console.log(R[e.key]),u.value.model=r.value,u.value.__v&&delete u.value.__v,await P.put(`/api/templates/${JSON.parse(B)}`,u.value)},K=e=>{if(s.name===""){const l=r.value.findIndex(k=>k===e);r.value.splice(l,1)}else e.name=s.name,e.description=s.description,e.enum=s.enum,e.editing=!1;$.value=!0,N()},E=()=>{$.value=!1,r.value.unshift({name:"",type:"str",enum:"",editing:!0,inputVisible:!0,inputValue:"",required:!1})};V(),w({inputVisible:!1,inputValue:"",tags:[]});let O=V();const L=e=>{e.inputVisible=!0,pe(()=>{O.value.focus()})},S=e=>{let l=e.enum;e.inputValue&&l.indexOf(e.inputValue)===-1&&(l=[...l,e.inputValue],console.log(l)),Object.assign(e,{enum:l,inputVisible:!1,inputValue:""}),console.log(e)},T=(e,l)=>{const k=e.enum.filter(x=>x!==l);e.enum=k},Q=w([{title:"component.table.required",dataIndex:"required",key:"required",width:10},{title:"component.table.name",dataIndex:"name",key:"name",width:180},{title:"component.table.description",dataIndex:"description",key:"description",width:180},{title:"component.table.type",dataIndex:"type",key:"type",width:180},{title:"component.table.enum",dataIndex:"enum",key:"enum",width:180},{title:"component.table.action",dataIndex:"action",key:"action",width:100}]),W=V([{value:"str",label:"str"},{value:"float",label:"float"},{value:"boolean",label:"boolean"},{value:"number",label:"number"},{value:"int",label:"int"},{value:"SUT",label:"SUT"}]);return(e,l)=>{const k=ce,x=me,X=de,q=he,Y=ve,Z=re,G=be,ee=ge,te=fe;return a(),i("main",Ce,[g(te,{columns:Q,"data-source":I(r),bordered:""},{headerCell:v(({column:_})=>[C("span",null,p(e.$t(_.title)),1),_.key==="action"?(a(),i(m,{key:0},[I($)?(a(),i("span",{key:0,class:"iconsave",style:{color:"#1890ff"},onClick:E},[g(I(qe))])):y("",!0)],64)):y("",!0)]),bodyCell:v(({column:_,text:U,record:t})=>[_.key==="required"?(a(),i(m,{key:0},[t.editing?(a(),c(k,{key:0,checked:t.required,"onUpdate:checked":n=>t.required=n},null,8,["checked","onUpdate:checked"])):(a(),c(k,{key:1,checked:t.required,"onUpdate:checked":n=>t.required=n,disabled:!0},null,8,["checked","onUpdate:checked"]))],64)):y("",!0),_.key==="name"?(a(),i("div",Se,[t.editing?(a(),c(x,{key:0,value:t.name,"onUpdate:value":n=>t.name=n,style:{margin:"-5px 0"}},null,8,["value","onUpdate:value"])):(a(),i(m,{key:1},[h(p(U),1)],64))])):y("",!0),_.key==="description"?(a(),i("div",we,[t.editing?(a(),c(x,{key:0,value:t.description,"onUpdate:value":n=>t.description=n,style:{margin:"-5px 0"}},null,8,["value","onUpdate:value"])):(a(),i(m,{key:1},[h(p(U),1)],64))])):y("",!0),_.key==="type"?(a(),i("div",Ie,[t.editing?(a(),c(X,{key:0,options:W.value,value:t.type,"onUpdate:value":n=>t.type=n},null,8,["options","value","onUpdate:value"])):(a(),i(m,{key:1},[h(p(U),1)],64))])):y("",!0),_.key==="enum"?(a(),i(m,{key:4},[t.editing?(a(),i(m,{key:0},[(a(!0),i(m,null,F(t.enum,(n,ne)=>(a(),i(m,{key:ne},[n.length>20?(a(),c(Y,{key:0,title:n},{default:v(()=>[g(q,{closable:!0,visible:!0,onClose:ae=>T(t,n)},{default:v(()=>[h(p(`${n.slice(0,20)}...`),1)]),_:2},1032,["onClose"])]),_:2},1032,["title"])):n.length==0?(a(),c(q,{key:1})):(a(),c(q,{key:2,closable:!0,visible:!0,onClose:ae=>T(t,n)},{default:v(()=>[h(p(n),1)]),_:2},1032,["onClose"]))],64))),128)),t.inputVisible&&t.type=="str"?(a(),c(x,{key:0,ref_key:"inputRef",ref:O,value:t.inputValue,"onUpdate:value":n=>t.inputValue=n,valueModifiers:{trim:!0},type:"text",size:"small",style:{width:"78px"},onBlur:n=>S(t),onKeyup:D(n=>S(t),["enter"])},null,8,["value","onUpdate:value","onBlur","onKeyup"])):t.inputVisible&&t.type=="number"?(a(),c(Z,{key:1,ref_key:"inputRef",ref:O,value:t.inputValue,"onUpdate:value":n=>t.inputValue=n,valueModifiers:{number:!0},type:"text",size:"small",style:{width:"78px"},onBlur:n=>S(t),onKeyup:D(n=>S(t),["enter"])},null,8,["value","onUpdate:value","onBlur","onKeyup"])):(a(),c(q,{key:2,style:{background:"#fff","border-style":"dashed"},onClick:n=>L(t)},{default:v(()=>[g(I(ke)),h(" "+p(e.$t("common.newValue")),1)]),_:2},1032,["onClick"]))],64)):(a(),i("span",Oe,[(a(!0),i(m,null,F(t.enum,n=>(a(),c(q,{key:n,color:"cyan"},{default:v(()=>[h(p(n),1)]),_:2},1024))),128))]))],64)):y("",!0),_.dataIndex==="action"?(a(),i("div",Ue,[t.editing?(a(),i("span",Pe,[C("a",{style:{color:"red"},onClick:n=>A(t)},p(e.$t("common.saveText")),9,Me),g(G,{type:"vertical"}),C("a",{style:{"margin-left":"0.625rem"},onClick:n=>K(t)},p(e.$t("common.cancelText")),9,Be)])):(a(),i("span",Ne,[C("a",{onClick:n=>z(t)},p(e.$t("common.editText")),9,Te),g(ee,{title:e.$t("component.message.sureDel"),"ok-text":e.$t("common.yesText"),"cancel-text":e.$t("common.noText"),onConfirm:n=>H(t)},{default:v(()=>[C("a",Fe,p(e.$t("common.delText")),1)]),_:2},1032,["title","ok-text","cancel-text","onConfirm"])]))])):y("",!0)]),_:1},8,["columns","data-source"])])}}});const Ee=ye(De,[["__scopeId","data-v-35f85408"]]);export{Ee as default};
