import{d as A,a as s,O as U,r as Z,w as E,M as x,N as L,V as Q,b as t,S as l,Z as n,ar as C,Q as y,az as W,$ as Y,ah as G,Y as H,W as J,au as K,ai as X,a0 as ee,ae,aj as te,aa as le}from"./index.3614183b.js";/* empty css               *//* empty css              */import{_ as ne}from"./index.c5cedc9d.js";/* empty css              *//* empty css               */import{_ as oe}from"./index.vue_vue_type_script_setup_true_lang.dc6c6f55.js";import{_ as se}from"./index.351a724d.js";import{P as re}from"./index.01976f6f.js";import{_ as ce}from"./index.a4a12abb.js";import"./index.5931ae8c.js";import"./index.89207c6a.js";/* empty css               */import"./EditOutlined.cfe60ffa.js";import"./DeleteOutlined.a585300f.js";const ie={style:{height:"100%","overflow-x":"hidden!important"}},me={class:"block shadow",style:{width:"100%","margin-bottom":"1rem"}},ue=A({__name:"statictemplate",setup(pe){let _=s(null);const b={url:"/api/templates",searchText:"",noPage:!0,createParams:"static"},$=[{title:"name",link:"staticModeler",require:!0},{title:"description",require:!0},{title:"tags"},{title:"action",actionList:["edit","delete","clone"]}],{t:f}=U();s(!1);const r=Z({search:"",q:"category:static"});E(()=>r.search,e=>{b.searchText=e});const P=async e=>{r.search="",_.value.query(r.search)},q=e=>{console.log(e)};let k=s(),g=s(!1),d=s(""),h=s([{value:"tags:",label:"tags:",isLeaf:!1},{value:"name:",label:"name:"}]);const F=async e=>{console.log(e);let a=await y.get("/api/templates/_tags",{params:{q:"category:static"}});const i=e[0];i.loading=!0,a.length>0&&(a=a.map(p=>({value:p,label:p})),i.children=a),i.loading=!1,h.value=[...h.value]},M=async e=>{if(e){let a=new RegExp(",","g");r.search+=e.toString().replace(a,"")}d.value="",g.value=!1,K(()=>{k.value.focus()})},V=e=>{r.search=="@"&&(g.value=!0)},N=()=>{_.value.createNewRow({name:"",description:"",category:"static",tags:[]})};let D=async(e,a)=>{let i=/^[a-zA-Z\$_][a-zA-Z\d_]*$/,p=/^[\u4e00-\u9fa5_a-zA-Z0-9]+$/;if(a){if(!i.test(a)&&!p.test(a))return Promise.reject(f("templateManager.namehefa"));{let m=await y.get("/api/templates",{params:{q:"category:static",search:`@name:${a}`}});return m.data&&m.data.length>0&&m.data[0].name==a?Promise.reject(f("templateManager.duplicate")):Promise.resolve()}}else return Promise.reject(f("templateManager.nameinput"))},v=s(),S={name:[{required:!0,validator:D,trigger:"blur"}]},c=s({name:""}),u=s(!1);const j=e=>{c.value.name=`${e.name}_clone`,c.value={...e,name:c.value.name},u.value=!0},B=()=>{n(v).validate().then(async()=>{delete c.value._id,y.post("/api/templates",c.value).then(e=>{let a=_.value.getTableData();a.unshift(e),_.value.setTableData(a),e&&e._id&&(u.value=!1)})})},I=()=>{v.value.clearValidate()};return(e,a)=>{const i=X,p=ne,m=ce,w=ee,T=ae,O=se,R=te,z=W;return x(),L("main",ie,[Q("header",me,[t(O,null,{default:l(()=>[t(m,{span:20},{default:l(()=>[t(T,{layout:"inline",class:"search_form",model:r,onFinish:P,onFinishFailed:q,"wrapper-col":{span:24}},{default:l(()=>[t(m,{span:20},{default:l(()=>[t(i,{value:r.search,"onUpdate:value":a[0]||(a[0]=o=>r.search=o),placeholder:e.$t("awModeler.inputSearch1"),onChange:V,ref_key:"searchInput",ref:k},null,8,["value","placeholder"]),n(g)?(x(),Y(p,{key:0,"load-data":F,value:n(d),"onUpdate:value":a[1]||(a[1]=o=>C(d)?d.value=o:d=o),placeholder:"Please select",options:n(h),onChange:M},null,8,["value","options"])):G("",!0)]),_:1}),t(m,{span:4},{default:l(()=>[t(w,{type:"primary","html-type":"submit"},{default:l(()=>[H(J(e.$t("common.searchText")),1)]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),t(m,{span:4},{default:l(()=>[t(w,{type:"primary",onClick:N},{icon:l(()=>[t(n(re))]),_:1})]),_:1})]),_:1})]),t(n(oe),{ref_key:"staticTable",ref:_,columns:$,tableRef:"staticTemplateTable",fetchObj:b,onClone:j},null,512),t(z,{visible:n(u),"onUpdate:visible":a[3]||(a[3]=o=>C(u)?u.value=o:u=o),title:e.$t("component.table.clone"),onOk:B,"ok-text":e.$t("common.okText"),"cancel-text":e.$t("common.cancelText"),onCancel:I},{default:l(()=>[t(T,{model:n(c),ref_key:"refCopy",ref:v,rules:n(S)},{default:l(()=>[t(R,{name:"name",label:e.$t("component.table.name")},{default:l(()=>[t(i,{value:n(c).name,"onUpdate:value":a[2]||(a[2]=o=>n(c).name=o)},null,8,["value"])]),_:1},8,["label"])]),_:1},8,["model","rules"])]),_:1},8,["visible","title","ok-text","cancel-text"])])}}});const qe=le(ue,[["__scopeId","data-v-892d2c21"]]);export{qe as default};
