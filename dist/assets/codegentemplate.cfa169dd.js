import{d as E,O as L,a as s,r as Q,w as W,a5 as Y,M as C,N as G,V as H,b as t,S as l,Z as n,ar as $,Q as y,az as J,bS as K,$ as X,ah as ee,Y as x,W as M,au as ae,ai as te,a0 as le,ae as ne,aj as oe,aa as se}from"./index.3614183b.js";/* empty css               *//* empty css              */import{_ as re}from"./index.c5cedc9d.js";/* empty css              *//* empty css               */import{_ as ce}from"./index.vue_vue_type_script_setup_true_lang.dc6c6f55.js";import{_ as ie}from"./index.351a724d.js";import{P as ue}from"./index.01976f6f.js";import{_ as me}from"./index.a4a12abb.js";import"./index.5931ae8c.js";import"./index.89207c6a.js";/* empty css               */import"./EditOutlined.cfe60ffa.js";import"./DeleteOutlined.a585300f.js";const pe={style:{height:"100%","overflow-x":"hidden!important"}},de={class:"block shadow"},_e=E({__name:"codegentemplate",setup(fe){const{t:f}=L(),q=K,F=[{title:"name",width:40,link:"codegenModeler",require:!0},{title:"description",width:120,require:!0},{title:"tags",width:100},{title:"action",width:100,actionList:["edit","delete","clone"]}],b={url:q,searchText:"",createParams:"codegen"};let d=s(null);s();const u=Q({search:"",q:"category:codegen"});W(()=>u.search,e=>{b.searchText=e}),Y();const P=e=>{d.value.query(u.search)},V=e=>{console.log(e)};let w=s(),g=s(!1),_=s(""),h=s([{value:"tags:",label:"tags:",isLeaf:!1},{value:"name:",label:"name:"}]);const N=async e=>{console.log(e);let a=await y.get("/api/templates/_tags",{params:{q:"category:codegen"}});const c=e[0];c.loading=!0,a.length>0&&(a=a.map(p=>({value:p,label:p})),c.children=a),c.loading=!1,h.value=[...h.value]},S=async e=>{if(e){let a=new RegExp(",","g");u.search+=e.toString().replace(a,"")}_.value="",g.value=!1,ae(()=>{w.value.focus()})},D=e=>{u.search=="@"&&(g.value=!0)},R=()=>{d.value.createNewRow({name:"",description:"",tags:[]})};let j=async(e,a)=>{let c=/^[a-zA-Z0-9\$][a-zA-Z0-9\d_]*$/,p=/^[\u4e00-\u9fa5_a-zA-Z0-9]+$/;if(a){if(!c.test(a)&&!p.test(a))return Promise.reject(f("templateManager.namehefa"));{let i=await y.get("/api/templates",{params:{q:"category:codegen",search:`@name:${a}`}});return i.data&&i.data.length>0&&i.data[0].name==a?Promise.reject(f("templateManager.duplicate")):Promise.resolve()}}else return Promise.reject(f("templateManager.nameinput"))},v=s(),B={name:[{required:!0,validator:j,trigger:"blur"}]},r=s({name:""}),m=s(!1);const I=e=>{r.value.name=`${e.name}_clone`,r.value={...e,name:r.value.name},m.value=!0},O=()=>{n(v).validate().then(async()=>{delete r.value._id,y.post("/api/templates",r.value).then(e=>{let a=d.value.getTableData();a.unshift(e),d.value.setTableData(a),e&&e._id&&(m.value=!1)})})},U=()=>{v.value.clearValidate()};return(e,a)=>{const c=te,p=re,i=me,k=le,T=ne,z=ie,A=oe,Z=J;return C(),G("main",pe,[H("header",de,[t(z,null,{default:l(()=>[t(i,{span:20},{default:l(()=>[t(T,{layout:"inline",class:"search_form",model:u,onFinish:P,onFinishFailed:V,"wrapper-col":{span:24}},{default:l(()=>[t(i,{span:20},{default:l(()=>[t(c,{value:u.search,"onUpdate:value":a[0]||(a[0]=o=>u.search=o),placeholder:e.$t("awModeler.inputSearch1"),onChange:D,ref_key:"searchInput",ref:w},null,8,["value","placeholder"]),n(g)?(C(),X(p,{key:0,"load-data":N,value:n(_),"onUpdate:value":a[1]||(a[1]=o=>$(_)?_.value=o:_=o),placeholder:"Please select",options:n(h),onChange:S},null,8,["value","options"])):ee("",!0)]),_:1}),t(i,{span:4},{default:l(()=>[t(k,{type:"primary","html-type":"submit"},{default:l(()=>[x(M(e.$t("common.searchText")),1)]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),t(i,{span:4},{default:l(()=>[t(k,{type:"primary",onClick:R},{icon:l(()=>[t(n(ue))]),default:l(()=>[x(" "+M(e.$t("templateManager.newCodegenTemp")),1)]),_:1})]),_:1})]),_:1})]),t(n(ce),{ref_key:"codegenTable",ref:d,columns:F,tableRef:"codegenTemplateTable",fetchObj:b,onClone:I},null,512),t(Z,{visible:n(m),"onUpdate:visible":a[3]||(a[3]=o=>$(m)?m.value=o:m=o),title:e.$t("component.table.clone"),onOk:O,"ok-text":e.$t("common.okText"),"cancel-text":e.$t("common.cancelText"),onCancel:U},{default:l(()=>[t(T,{model:n(r),ref_key:"refCopy",ref:v,rules:n(B)},{default:l(()=>[t(A,{name:"name",label:e.$t("component.table.name")},{default:l(()=>[t(c,{value:n(r).name,"onUpdate:value":a[2]||(a[2]=o=>n(r).name=o)},null,8,["value"])]),_:1},8,["label"])]),_:1},8,["model","rules"])]),_:1},8,["visible","title","ok-text","cancel-text"])])}}});const Ve=se(_e,[["__scopeId","data-v-9b68675a"]]);export{Ve as default};
