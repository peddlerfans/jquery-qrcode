import{d as pe,u as $e,cl as te,l as Ue,j as k,b as e,s as Ne,ap as Ie,P as j,bc as Pe,cm as He,cn as Me,k as ke,c as Oe,a as V,O as Ge,ac as Ke,a5 as Re,r as Ce,w as qe,M as B,N as de,V as ae,S as c,Z as o,ar as ze,W as O,az as We,Q as Se,R as Te,Y as H,F as xe,X as Be,$ as R,as as Ze,q as Qe,v as Xe,co as Ye,aA as Je,au as et,ai as tt,a0 as at,ae as Le,aj as nt,aB as lt,al as ot,cp as st,aa as it}from"./index.3614183b.js";/* empty css               *//* empty css              */import{T as je}from"./index.4642cd79.js";/* empty css               */import{P as Ae,a as rt}from"./index.01976f6f.js";import{_ as ut}from"./index.vue_vue_type_script_setup_true_lang.dc6c6f55.js";import{G as ct,s as dt}from"./input-select-item.b98c8f1f.js";import{_ as q}from"./index.351a724d.js";import{_ as S}from"./index.a4a12abb.js";import"./useRefs.e2c20bfc.js";import"./index.5931ae8c.js";/* empty css              */import"./index.89207c6a.js";/* empty css               */import"./EditOutlined.cfe60ffa.js";import"./DeleteOutlined.a585300f.js";var pt=je.TabPane,ft=function(){return{prefixCls:String,title:j.any,extra:j.any,bordered:{type:Boolean,default:!0},bodyStyle:{type:Object,default:void 0},headStyle:{type:Object,default:void 0},loading:{type:Boolean,default:!1},hoverable:{type:Boolean,default:!1},type:{type:String},size:{type:String},actions:j.any,tabList:{type:Array},tabBarExtraContent:j.any,activeTabKey:String,defaultActiveTabKey:String,cover:j.any,onTabChange:{type:Function}}},vt=pe({compatConfig:{MODE:3},name:"ACard",props:ft(),slots:["title","extra","tabBarExtraContent","actions","cover","customTab"],setup:function(r,U){var i=U.slots,f=$e("card",r),x=f.prefixCls,w=f.direction,v=f.size,M=function(h){var _=h.map(function(C,D){return Pe(C)&&!He(C)||!Pe(C)?e("li",{style:{width:"".concat(100/h.length,"%")},key:"action-".concat(D)},[e("span",null,[C])]):null});return _},g=function(h){var _;(_=r.onTabChange)===null||_===void 0||_.call(r,h)},L=function(){var h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],_;return h.forEach(function(C){C&&Me(C.type)&&C.type.__ANT_CARD_GRID&&(_=!0)}),_};return function(){var F,h,_,C,D,y,T,N,m=r.headStyle,fe=m===void 0?{}:m,W=r.bodyStyle,Z=W===void 0?{}:W,G=r.loading,p=r.bordered,ne=p===void 0?!0:p,le=r.type,I=r.tabList,oe=r.hoverable,Q=r.activeTabKey,se=r.defaultActiveTabKey,ve=r.tabBarExtraContent,me=ve===void 0?te((F=i.tabBarExtraContent)===null||F===void 0?void 0:F.call(i)):ve,_e=r.title,X=_e===void 0?te((h=i.title)===null||h===void 0?void 0:h.call(i)):_e,Y=r.extra,J=Y===void 0?te((_=i.extra)===null||_===void 0?void 0:_.call(i)):Y,ee=r.actions,t=ee===void 0?te((C=i.actions)===null||C===void 0?void 0:C.call(i)):ee,a=r.cover,s=a===void 0?te((D=i.cover)===null||D===void 0?void 0:D.call(i)):a,u=Ue((y=i.default)===null||y===void 0?void 0:y.call(i)),n=x.value,E=(T={},k(T,"".concat(n),!0),k(T,"".concat(n,"-loading"),G),k(T,"".concat(n,"-bordered"),ne),k(T,"".concat(n,"-hoverable"),!!oe),k(T,"".concat(n,"-contain-grid"),L(u)),k(T,"".concat(n,"-contain-tabs"),I&&I.length),k(T,"".concat(n,"-").concat(v.value),v.value),k(T,"".concat(n,"-type-").concat(le),!!le),k(T,"".concat(n,"-rtl"),w.value==="rtl"),T),P=Z.padding===0||Z.padding==="0px"?{padding:"24px"}:void 0,b=e("div",{class:"".concat(n,"-loading-block")},null),K=e("div",{class:"".concat(n,"-loading-content"),style:P},[e(q,{gutter:8},{default:function(){return[e(S,{span:22},{default:function(){return[b]}})]}}),e(q,{gutter:8},{default:function(){return[e(S,{span:8},{default:function(){return[b]}}),e(S,{span:15},{default:function(){return[b]}})]}}),e(q,{gutter:8},{default:function(){return[e(S,{span:6},{default:function(){return[b]}}),e(S,{span:18},{default:function(){return[b]}})]}}),e(q,{gutter:8},{default:function(){return[e(S,{span:13},{default:function(){return[b]}}),e(S,{span:9},{default:function(){return[b]}})]}}),e(q,{gutter:8},{default:function(){return[e(S,{span:4},{default:function(){return[b]}}),e(S,{span:3},{default:function(){return[b]}}),e(S,{span:16},{default:function(){return[b]}})]}})]),ie=Q!==void 0,be=(N={size:"large"},k(N,ie?"activeKey":"defaultActiveKey",ie?Q:se),k(N,"onChange",g),k(N,"class","".concat(n,"-head-tabs")),N),re,ue=I&&I.length?e(je,be,{default:function(){return[I.map(function(d){var we=d.tab,ce=d.slots,De=ce==null?void 0:ce.tab;Ne(!ce,"Card","tabList slots is deprecated, Please use `customTab` instead.");var ye=we!==void 0?we:i[De]?i[De](d):null;return ye=Ie(i,"customTab",d,function(){return[ye]}),e(pt,{tab:ye,key:d.key,disabled:d.disabled},null)})]},rightExtra:me?function(){return me}:null}):null;(X||J||ue)&&(re=e("div",{class:"".concat(n,"-head"),style:fe},[e("div",{class:"".concat(n,"-head-wrapper")},[X&&e("div",{class:"".concat(n,"-head-title")},[X]),J&&e("div",{class:"".concat(n,"-extra")},[J])]),ue]));var ge=s?e("div",{class:"".concat(n,"-cover")},[s]):null,he=e("div",{class:"".concat(n,"-body"),style:Z},[G?K:u]),l=t&&t.length?e("ul",{class:"".concat(n,"-actions")},[M(t)]):null;return e("div",{class:E,ref:"cardContainerRef"},[re,ge,u&&u.length?he:null,l])}}});const z=vt;var mt=function(){return{prefixCls:String,title:j.any,description:j.any,avatar:j.any}};const Fe=pe({compatConfig:{MODE:3},name:"ACardMeta",props:mt(),slots:["title","description","avatar"],setup:function(r,U){var i=U.slots,f=$e("card",r),x=f.prefixCls;return function(){var w=k({},"".concat(x.value,"-meta"),!0),v=ke(i,r,"avatar"),M=ke(i,r,"title"),g=ke(i,r,"description"),L=v?e("div",{class:"".concat(x.value,"-meta-avatar")},[v]):null,F=M?e("div",{class:"".concat(x.value,"-meta-title")},[M]):null,h=g?e("div",{class:"".concat(x.value,"-meta-description")},[g]):null,_=F||h?e("div",{class:"".concat(x.value,"-meta-detail")},[F,h]):null;return e("div",{class:w},[L,_])}}});var _t=function(){return{prefixCls:String,hoverable:{type:Boolean,default:!0}}};const Ee=pe({compatConfig:{MODE:3},name:"ACardGrid",__ANT_CARD_GRID:!0,props:_t(),setup:function(r,U){var i=U.slots,f=$e("card",r),x=f.prefixCls,w=Oe(function(){var v;return v={},k(v,"".concat(x.value,"-grid"),!0),k(v,"".concat(x.value,"-grid-hoverable"),r.hoverable),v});return function(){var v;return e("div",{class:w.value},[(v=i.default)===null||v===void 0?void 0:v.call(i)])}}});z.Meta=Fe;z.Grid=Ee;z.install=function($){return $.component(z.name,z),$.component(Fe.name,Fe),$.component(Ee.name,Ee),$};const Ve=[{label:"\u8BF7\u6C42\u6570\u636E",value:"post"},{label:"\u4FEE\u6539\u6570\u636E",value:"put"},{label:"\u5220\u9664\u6570\u636E",value:"delete"}],bt=[{label:"post",value:"post"},{label:"put",value:"put"},{label:"delete",value:"delete"}],gt={post:"\u8BF7\u6C42\u6570\u636E",delete:"\u5220\u9664\u6570\u636E",get:"\u83B7\u53D6\u6570\u636E",put:"\u4FEE\u6539\u6570\u636E"},ht={style:{height:"100%","overflow-x":"hidden !important"}},yt={class:"block shadow"},kt={slot:"title",class:"topics-title"},Ct={class:"tableContainer"},Tt=pe({__name:"webHook",setup($){let r={title:"",type:"object",properties:{inputText:{title:"\u81EA\u5B9A\u4E49widget",patternProperties:!1,type:"string"}}},U={inputText:{"ui:widget":dt,"ui:options":[{value:"lucy",label:"Lucy"}]}},i=V();const{t:f}=Ge(),x=Ye;Ke(),Re(),V();const w=Ce({search:""}),v={url:"/api/webhooks",searchText:""};qe(()=>w.search,t=>{v.searchText=t});const M=[{title:"name",require:!0},{title:"description",require:!0},{title:"tags"},{title:"url"},{title:"action",actionList:["detail","edit","delete"],cbName:["edit"]}];let g=V(null);const L=Ce({topicsFnList:[{title:"hlfs",checkList:[]},{title:"templates",checkList:[]},{title:"test-models",checkList:[]}]}),F=Je(),h=t=>{console.log("Failed:",t)},_=t=>{g.value.query(w.search)},C=t=>{console.log(t)},D=V(!1);let y=V(!1);const T=()=>{D.value=!0,y.value=!1},N=()=>{y.value=!0,D.value=!0};let m=V({name:"",description:"",_id:"",tags:[],url:"",topics:[]});const fe=Oe(()=>y.value?f("settings.detailWebHook"):m.value._id?f("settings.updateWebHook"):f("settings.saveWebHook"));let W=V();const Z=()=>{m.value={name:"",description:"",_id:"",tags:[],url:"",topics:[]},p.tags=[],p.topics=[],(F==null?void 0:F.refs.refForm).resetFields()};let G=V(),p=Ce({tags:[],topics:[],inputVisible:!1,inputValue:"",topicsInputVisible:!1,inputTopics:""});const ne=(t,a)=>{m.value.name=t.name,m.value.description=t.description,m.value._id=t._id,m.value.url=t.url,p.tags=t.tags;let s={};t.topics.forEach(u=>{let n=u.split(":"),E=n[0];a&&(E=gt[E]);let P=n[1];!E||!P||(s.hasOwnProperty(P)?s[P].includes(E)||s[P].push(E):s[P]=[E])}),s.topicsOpts=Object.keys(s),Object.keys(s).forEach(u=>{L.topicsFnList.forEach(n=>{n.title===u&&(n.checkList=s[u])})}),a?N():T()},le=(t,a)=>{let s=t.target.checked;!L.topicsFnList[a]||(L.topicsFnList[a].checkList=s?Ve.map(n=>n.value):[])};async function I(t){return g.value.loading=!0,new Promise((a,s)=>{Se.post(x,t).then(u=>{let n=g.value.getTableData();n.unshift(u),g.value.setTableData(n)}).catch(function(u){u.response.status==409&&Te.error(f("settings.requiredNameADesc"))}).finally(()=>g.value.loading=!1)})}const oe=async t=>{await o(W).validate(),t.value.tags=p.tags;let a=[];L.topicsFnList.forEach(s=>{s.checkList.forEach(u=>a.push(`${u}:${s.title}`))}),t.value.topics=a,t.value._id?(g.value.loading=!0,Se.put(x+`/${t.value._id}`,t.value).then(s=>{let u=g.value.getTableData(),n=u.filter(P=>P._id===s._id)[0],E=u.indexOf(n);E!==-1&&(u[E]=s,g.value.setTableData(u),Te.success(f("component.message.updateText")))}).finally(()=>g.value.loading=!1)):(delete t.value._id,Te.success(f("component.message.saveText")),I(t.value))},Q=()=>{oe(m)},se=()=>{Z(),D.value=!1};let X={name:[{required:!0,validator:async(t,a)=>a?Promise.resolve():Promise.reject(f("component.message.emptyName")),trigger:"blur"}],description:[{required:!0,validator:async(t,a)=>a?Promise.resolve():Promise.reject(f("component.message.emptyDescription")),trigger:"blur"}],url:[{required:!0,validator:async(t,a)=>a?/(((^https?:(?:\/\/)?)(?:[-;:&=\+\$,\w]+@)?[A-Za-z0-9.-]+|(?:www.|[-;:&=\+\$,\w]+@)[A-Za-z0-9.-]+)((?:\/[\+~%\/.\w-_]*)?\??(?:[-\+=&;%@.\w_]*)#?(?:[\w]*))?)$/g.test(a)?Promise.resolve():Promise.reject(f("component.message.realUrl")):Promise.reject(f("component.message.emptyUrl")),trigger:"blur"}]};const Y=t=>{const a=p.tags.filter(s=>s!==t);p.tags=a},J=()=>{p.inputVisible=!0,et(()=>{G.value.focus(),G.value.toString().toUpperCase()})},ee=()=>{let t=p.tags;p.inputValue&&t.indexOf(p.inputValue)===-1&&(t=[...t,p.inputValue.toUpperCase()]),Object.assign(p,{tags:t,inputVisible:!1,inputValue:""})};return(t,a)=>{const s=tt,u=S,n=at,E=Le,P=q,b=nt,K=rt,ie=lt,be=ot,re=st,ue=z,ge=Le,he=We;return B(),de("main",ht,[ae("header",yt,[e(P,null,{default:c(()=>[e(u,{span:20},{default:c(()=>[e(E,{layout:"inline",class:"search_form",model:w,onFinish:_,onFinishFailed:C,"wrapper-col":{span:24}},{default:c(()=>[e(u,{span:20},{default:c(()=>[e(s,{value:w.search,"onUpdate:value":a[0]||(a[0]=l=>w.search=l),split:"",placeholder:t.$t("settings.searchText")},null,8,["value","placeholder"])]),_:1}),e(u,{span:4},{default:c(()=>[e(n,{type:"primary","html-type":"submit"},{default:c(()=>[H(O(t.$t("common.searchText")),1)]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),e(u,{span:4},{default:c(()=>[e(n,{type:"primary",onClick:T},{icon:c(()=>[e(o(Ae))]),_:1})]),_:1})]),_:1})]),ae("div",null,[e(he,{visible:D.value,"onUpdate:visible":a[5]||(a[5]=l=>D.value=l),title:o(fe),onCancel:se,onOk:Q,width:700},{footer:c(()=>[e(n,{onClick:se},{default:c(()=>[H(O(t.$t("common.cancelText")),1)]),_:1}),e(n,{onClick:Q,type:"primary",class:"btn_ok"},{default:c(()=>[H(O(t.$t("common.okText")),1)]),_:1})]),default:c(()=>[e(ge,{ref_key:"refForm",ref:W,model:o(m),rules:o(X),name:"basic","label-col":{span:6},"wrapper-col":{span:16},autocomplete:"off",onFinish:oe,onFinishFailed:h},{default:c(()=>[e(b,{label:t.$t("component.table.name"),name:"name"},{default:c(()=>[e(s,{value:o(m).name,"onUpdate:value":a[1]||(a[1]=l=>o(m).name=l),disabled:o(y)},null,8,["value","disabled"])]),_:1},8,["label"]),e(b,{label:t.$t("component.table.description"),name:"description"},{default:c(()=>[e(s,{value:o(m).description,"onUpdate:value":a[2]||(a[2]=l=>o(m).description=l),disabled:o(y)},null,8,["value","disabled"])]),_:1},8,["label"]),e(b,{label:t.$t("component.table.url"),name:"url"},{default:c(()=>[e(s,{value:o(m).url,"onUpdate:value":a[3]||(a[3]=l=>o(m).url=l),disabled:o(y)},null,8,["value","disabled"])]),_:1},8,["label"]),e(b,{label:t.$t("component.table.tags"),name:"tags"},{default:c(()=>[(B(!0),de(xe,null,Be(o(p).tags,(l,A)=>(B(),de(xe,{key:l},[l.length>20?(B(),R(ie,{key:0,title:l},{default:c(()=>[e(K,{closable:!0,onClose:d=>Y(l)},{default:c(()=>[H(O(`${l.slice(0,20)}...`),1)]),_:2},1032,["onClose"])]),_:2},1032,["title"])):l.length===0?(B(),R(K,{key:1})):(B(),R(K,{key:2,closable:!o(y),onClose:d=>Y(l)},{default:c(()=>[H(O(l),1)]),_:2},1032,["closable","onClose"]))],64))),128)),o(p).inputVisible?(B(),R(s,{key:0,ref_key:"inputRef",ref:G,value:o(p).inputValue,"onUpdate:value":a[4]||(a[4]=l=>o(p).inputValue=l),type:"text",size:"small",style:{width:"78px"},onBlur:ee,onKeyup:Ze(ee,["enter"])},null,8,["value","onKeyup"])):Qe((B(),R(K,{key:1,style:{background:"#fff","border-style":"dashed"},onClick:J},{default:c(()=>[e(o(Ae)),H(" "+O(t.$t("common.newTag")),1)]),_:1},512)),[[Xe,!o(y)]])]),_:1},8,["label"]),e(b,{label:t.$t("component.table.topics"),name:"topics"},{default:c(()=>[(B(!0),de(xe,null,Be(L.topicsFnList,(l,A)=>(B(),R(ue,{key:A,class:"web-hook-topics-card"},{default:c(()=>[ae("div",kt,[e(be,{disabled:o(y),onChange:d=>le(d,A),name:l.title},{default:c(()=>[H(O(l.title),1)]),_:2},1032,["disabled","onChange","name"])]),e(re,{disabled:o(y),value:l.checkList,"onUpdate:value":d=>l.checkList=d,options:o(y)?o(Ve):o(bt)},null,8,["disabled","value","onUpdate:value","options"])]),_:2},1024))),128))]),_:1},8,["label"])]),_:1},8,["model","rules"])]),_:1},8,["visible","title"])]),ae("div",Ct,[e(o(ut),{ref_key:"webHookTable",ref:g,columns:M,tableRef:"webHookTable",fetchObj:v,onEdit:a[6]||(a[6]=l=>ne(l,!1)),onDetail:a[7]||(a[7]=l=>ne(l,!0))},null,512)]),e(o(ct),{modelValue:o(i),"onUpdate:modelValue":a[8]||(a[8]=l=>ze(i)?i.value=l:i=l),schema:o(r),"ui-schema":o(U)},null,8,["modelValue","schema","ui-schema"]),ae("div",null,O(o(i)),1)])}}});const Ht=it(Tt,[["__scopeId","data-v-0b933fb6"]]);export{Ht as default};
