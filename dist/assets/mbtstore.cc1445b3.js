import{d as E,a as r,ac as L,a5 as Q,O as W,r as Y,w as G,M as C,N as H,V as x,b as t,S as o,Z as l,ar as $,bR as B,Q as b,az as J,$ as K,ah as X,Y as ee,W as ae,au as te,ai as oe,a0 as le,ae as ne,aj as se,aa as re}from"./index.3614183b.js";/* empty css               *//* empty css              */import{_ as ce}from"./index.c5cedc9d.js";/* empty css              *//* empty css               */import{_ as ie}from"./index.vue_vue_type_script_setup_true_lang.dc6c6f55.js";import{_ as me}from"./index.351a724d.js";import{P as ue}from"./index.01976f6f.js";import{_ as pe}from"./index.a4a12abb.js";import"./index.5931ae8c.js";import"./index.89207c6a.js";/* empty css               */import"./EditOutlined.cfe60ffa.js";import"./DeleteOutlined.a585300f.js";const de={style:{height:"100%","overflow-x":"hidden !important"}},_e={class:"block shadow"},fe={class:"tableContainer"},he=E({__name:"mbtstore",setup(ve){const N=[{title:"name",width:40,link:"mbtmodeler",require:!0},{title:"description",width:120,require:!0},{title:"tags",width:100},{title:"action",width:100,actionList:["edit","delete","clone"]}],y={url:B,searchText:"",createParams:""};let d=r(null);const M=B;L(),Q();const{t:f}=W(),m=Y({search:""});G(()=>m.search,e=>{y.searchText=e}),r("");const P=e=>{d.value.query(m.search)},F=e=>{console.log(e)},R=()=>{d.value.createNewRow({name:"",description:"",tags:[]})};let w=r(),h=r(!1),_=r(""),v=r([{value:"tags:",label:"tags:",isLeaf:!1},{value:"name:",label:"name:"}]);const V=async e=>{let a=await b.get("/api/test-models/_tags",{params:{q:"category:meta"}});const c=e[0];c.loading=!0,a.length>0&&(a=a.map(p=>({value:p,label:p})),c.children=a),c.loading=!1,v.value=[...v.value]},q=async e=>{if(e){let a=new RegExp(",","g");m.search+=e.toString().replace(a,"")}_.value="",h.value=!1,te(()=>{w.value.focus()})},D=e=>{m.search=="@"&&(h.value=!0)};let S=async(e,a)=>{let c=/^[a-zA-Z0-9\$][a-zA-Z0-9\d_]*$/,p=/^[\u4e00-\u9fa5_a-zA-Z0-9]+$/;if(a){if(!c.test(a)&&!p.test(a))return Promise.reject(f("component.message.hefaName"));if(n.name&&n.name==a)return Promise.resolve();{let i=await b.get(M,{params:{q:`name:${a}`,search:""}});return i.data&&i.data.length>0&&i.data[0].name==a?Promise.reject(f("component.message.depName")):Promise.resolve()}}else return Promise.reject(f("component.message.emptyName"))},g=r(),j={name:[{required:!0,validator:S,trigger:"blur"}]},n=r({name:""}),u=r(!1);const I=e=>{n.value.name=`${e.name}_clone`,n.value={...e,name:n.value.name},u.value=!0},O=()=>{l(g).validate().then(async()=>{delete n.value._id,b.post("/api/test-models",n.value).then(e=>{let a=d.value.getTableData();a.unshift(e),d.value.setTableData(a),e&&e._id&&(u.value=!1)})})},U=()=>{g.value.clearValidate()};return(e,a)=>{const c=oe,p=ce,i=pe,T=le,k=ne,z=me,A=se,Z=J;return C(),H("main",de,[x("header",_e,[t(z,null,{default:o(()=>[t(i,{span:20},{default:o(()=>[t(k,{layout:"inline",class:"search_form",model:m,onFinish:P,onFinishFailed:F,"wrapper-col":{span:24}},{default:o(()=>[t(i,{span:20},{default:o(()=>[t(c,{value:m.search,"onUpdate:value":a[0]||(a[0]=s=>m.search=s),placeholder:e.$t("awModeler.inputSearch1"),onChange:D,ref_key:"searchInput",ref:w},null,8,["value","placeholder"]),l(h)?(C(),K(p,{key:0,"load-data":V,value:l(_),"onUpdate:value":a[1]||(a[1]=s=>$(_)?_.value=s:_=s),placeholder:"Please select",options:l(v),onChange:q},null,8,["value","options"])):X("",!0)]),_:1}),t(i,{span:4},{default:o(()=>[t(T,{type:"primary","html-type":"submit"},{default:o(()=>[ee(ae(e.$t("common.searchText")),1)]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),t(i,{span:4},{default:o(()=>[t(T,{type:"primary",onClick:R},{icon:o(()=>[t(l(ue))]),_:1})]),_:1})]),_:1})]),x("div",fe,[t(l(ie),{columns:N,"fetch-obj":y,tableRef:"MBTTable",ref_key:"MBTTable",ref:d,onClone:I},null,512)]),t(Z,{visible:l(u),"onUpdate:visible":a[3]||(a[3]=s=>$(u)?u.value=s:u=s),title:e.$t("component.table.clone"),onOk:O,"ok-text":e.$t("common.okText"),"cancel-text":e.$t("common.cancelText"),onCancel:U},{default:o(()=>[t(k,{model:l(n),ref_key:"refCopy",ref:g,rules:l(j)},{default:o(()=>[t(A,{name:"name",label:e.$t("component.table.name")},{default:o(()=>[t(c,{value:l(n).name,"onUpdate:value":a[2]||(a[2]=s=>l(n).name=s)},null,8,["value"])]),_:1},8,["label"])]),_:1},8,["model","rules"])]),_:1},8,["visible","title","ok-text","cancel-text"])])}}});const Ve=re(he,[["__scopeId","data-v-ccd5d772"]]);export{Ve as default};
