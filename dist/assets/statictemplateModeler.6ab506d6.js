import{d as de,O as ce,ac as pe,a as g,c as U,r as E,L as re,M as n,N as d,b as s,S as u,V as I,Z as p,Q as M,Y as v,W as y,E as _e,ah as q,$ as h,F as x,X as z,as as me,R as ye,bP as K,au as ve,a0 as fe,ai as ke,aB as ge,aa as he}from"./index.3614183b.js";import{_ as xe}from"./index.5931ae8c.js";/* empty css              *//* empty css               */import{P as F,a as Ce,_ as be}from"./index.01976f6f.js";import{_ as Ie}from"./index.f0aa9044.js";/* empty css              */import{l as T}from"./lodash.fdab4995.js";import{_ as $e}from"./index.351a724d.js";import{E as we}from"./EditOutlined.cfe60ffa.js";import{D as L}from"./DeleteOutlined.a585300f.js";import{C as Oe}from"./CheckCircleTwoTone.8a6ca075.js";import{_ as Ve}from"./index.a4a12abb.js";const De={style:{height:"100%","overflow-x":"hidden !important"}},je={style:{"margin-left":"5px"}},Ee={style:{"margin-left":"5px"}},Te={key:0,class:"editable-cell"},Re={key:0,class:"editable-cell-input-wrapper"},Ne={key:1,class:"editable-cell-text-wrapper"},Pe={key:0},Se=v(" New eTag "),Be={key:2,class:"editable-row-operations"},Ue={key:0},Me={style:{"margin-left":"10px","font-size":"14px"}},qe={key:1},ze=["onClick"],Ke=de({__name:"statictemplateModeler",setup(Fe){const{t:A}=ce();let w=pe();const O=g([{title:"ID",dataIndex:"ID",key:"ID"},{title:"Name",dataIndex:"name",key:"name"},{title:"Type",dataIndex:"type",key:"type"},{title:"Enum",dataIndex:"enum",key:"enum"},{title:"action",dataIndex:"action",key:"action",fixed:"right",width:100}]);let a=g([{title:"ID",dataIndex:"ID",key:"ID"},{title:"Name",dataIndex:"name",key:"name"},{title:"Type",dataIndex:"type",key:"type"},{title:"Enum",dataIndex:"enum",key:"enum"},{title:"action",dataIndex:"action",key:"action",fixed:"right",width:100}]);const H=g([]);let r=g([]);const V=U(()=>{if(a&&a.value&&a.value.length)return a.value.length;if(typeof a.value>"u")return a.value=O.value,a.value.length}),Q=U(()=>r.value.length+1),W=async()=>{let e={model:{schema:[],data:[]}};Object.assign(e.model.schema,a.value),Object.assign(e.model.data,r.value),await M.put(`/api/templates/${D.value._id}`,e),ye.success(A("component.message.saveSuccess"))},_=E({}),X=()=>{let e=[];a&&a.value&&T.exports.isArray(a.value)?a.value.forEach(C=>{e.push(C)}):typeof a.value>"u"&&(a.value=O.value);let t={},i="key",$=g({title:"key",dataIndex:"key",key:"key"});e.push($.value),e.forEach(C=>{i=C.title,i=="key"?Object.assign(t,{key:`${Q.value}`}):Object.assign(t,{[i]:""})}),r&&typeof r.value>"u"&&(r.value=H.value),r.value.push(t)},Y=async e=>{r.value=r.value.filter(t=>t.key!==e),delete _[e]},Z=e=>{Object.assign(r.value.filter(t=>e===t.key)[0],_[e]),delete _[e]},G=e=>{_[e]=K(r.value.filter(t=>e===t.key)[0])},J=e=>{delete _[e]},f=E({}),ee=()=>{const e={title:`Property${V.value}`,dataIndex:`Property${V.value}`,key:`Property${V.value}`},t={title:"action",dataIndex:"action",key:"action",fixed:"right",width:100};a&&typeof a.value>"u"&&(a.value=O.value),T.exports.remove(a.value,i=>i.key=="action"),a.value.push(e),a.value.push(t)};function te(e){T.exports.remove(a.value,t=>t.key==e)}const ae=e=>{f[e]=K(a.value.filter(t=>e===t.title)[0])},R=e=>{Object.assign(a.value.filter(i=>e===i.title)[0],f[e]);let t=f[e].title;a.value.filter(i=>{t===i.title&&(Object.assign(i,{title:t}),Object.assign(i,{dataIndex:t}),Object.assign(i,{key:t}))}),delete f[e]};sessionStorage.setItem("static_"+w.params._id,w.params._id);let D=g();const ne=async e=>{let t=await M.get(`/api/templates/${e}`,{params:{q:"category:static",search:""}});D.value=t,t.model&&(D.value.model=t.model,t.model,r.value=t.model.data,t.model.schema&&(a.value=t.model.schema))};re(()=>{let e=sessionStorage.getItem("static_"+w.params._id);ne(e)});let c=E({tags:[],inputVisible:!1,inputValue:""});const N=e=>{const t=c.tags.filter(i=>i!==e);c.tags=t},P=()=>{let e=c.tags;c.inputValue&&e.indexOf(c.inputValue)===-1&&(e=[...e,c.inputValue.toUpperCase()]),Object.assign(c,{tags:e,inputVisible:!1,inputValue:""}),console.log(c.tags)};let S=g();const le=()=>{c.inputVisible=!0,ve(()=>{S.value.focus()})};return(e,t)=>{const i=fe,$=Ve,C=$e,j=ke,b=Ce,oe=ge,B=Ie,se=be,ie=xe;return n(),d("main",De,[s(C,null,{default:u(()=>[s($,{span:"21"},{default:u(()=>[I("span",je,[s(i,{danger:"",onClick:t[0]||(t[0]=o=>W())},{default:u(()=>[v(y(e.$t("common.saveText")),1)]),_:1})])]),_:1}),s($,{span:"3"},{default:u(()=>[s(i,{type:"primary",onClick:t[1]||(t[1]=o=>ee())},{default:u(()=>[v(y(e.$t("templateManager.addColumn")),1)]),_:1}),I("span",Ee,[s(i,{type:"primary",onClick:t[2]||(t[2]=o=>X())},{icon:u(()=>[s(p(F))]),_:1})])]),_:1})]),_:1}),I("div",null,[s(ie,{dataSource:p(r),columns:p(a)},{headerCell:u(({column:o})=>[o.key!=="action"?(n(),d("div",Te,[f[o.title]?(n(),d("div",Re,[s(j,{value:f[o.title].title,"onUpdate:value":k=>f[o.title].title=k,onPressEnter:k=>R(o.title)},null,8,["value","onUpdate:value","onPressEnter"]),s(p(_e),{class:"editable-cell-icon-check",onClick:k=>R(o.title)},null,8,["onClick"])])):(n(),d("div",Ne,[v(y(o.title)+" ",1),s(p(we),{class:"editable-cell-icon",onClick:k=>ae(o.title)},null,8,["onClick"]),s(p(L),{onClick:k=>te(o.key)},null,8,["onClick"])]))])):q("",!0)]),bodyCell:u(({column:o,text:k,record:m})=>[o.key!=="action"&&o.key!=="enum"?(n(),d("div",Pe,[_[m.key]?(n(),h(j,{key:0,value:_[m.key][o.dataIndex],"onUpdate:value":l=>_[m.key][o.dataIndex]=l,style:{margin:"-5px 0"}},null,8,["value","onUpdate:value"])):(n(),d(x,{key:1},[v(y(k),1)],64))])):o.key==="enum"?(n(),d(x,{key:1},[_[m.key]?(n(),d(x,{key:0},[(n(!0),d(x,null,z(p(c).tags,(l,Le)=>(n(),d(x,{key:l},[l.length>20?(n(),h(oe,{key:0,title:l},{default:u(()=>[s(b,{closable:!0,onClose:ue=>N(l)},{default:u(()=>[v(y(`${l.slice(0,20)}...`),1)]),_:2},1032,["onClose"])]),_:2},1032,["title"])):l.length==0?(n(),h(b,{key:1})):(n(),h(b,{key:2,closable:!0,onClose:ue=>N(l)},{default:u(()=>[v(y(l),1)]),_:2},1032,["onClose"]))],64))),128)),p(c).inputVisible?(n(),h(j,{key:0,ref_key:"inputRef",ref:S,value:p(c).inputValue,"onUpdate:value":t[3]||(t[3]=l=>p(c).inputValue=l),type:"text",size:"small",style:{width:"78px"},onBlur:P,onKeyup:me(P,["enter"])},null,8,["value","onKeyup"])):(n(),h(b,{key:1,style:{background:"#fff","border-style":"dashed"},onClick:le},{default:u(()=>[s(p(F)),Se]),_:1}))],64)):(n(!0),d(x,{key:1},z(m.tags,l=>(n(),h(b,{key:l,color:l==="test"?"volcano":"red"},{default:u(()=>[v(y(l.toUpperCase()),1)]),_:2},1032,["color"]))),128))],64)):o.dataIndex==="action"?(n(),d("div",Be,[_[m.key]?(n(),d("span",Ue,[s(B,{onClick:l=>Z(m.key),style:{"font-size":"16px"}},{default:u(()=>[s(p(Oe),{"two-tone-color":"#52c41a"})]),_:2},1032,["onClick"]),s(se,{title:"Sure to delete?",onConfirm:l=>Y(m.key)},{default:u(()=>[I("a",Me,[s(p(L))])]),_:2},1032,["onConfirm"]),s(B,{onClick:l=>J(m.key),style:{"margin-left":"7px"}},{default:u(()=>[v(y(e.$t("common.cancelText")),1)]),_:2},1032,["onClick"])])):(n(),d("span",qe,[I("a",{onClick:l=>G(m.key)},y(e.$t("common.editText")),9,ze)]))])):q("",!0)]),_:1},8,["dataSource","columns"])])])}}});const lt=he(Ke,[["__scopeId","data-v-379f0938"]]);export{lt as default};
