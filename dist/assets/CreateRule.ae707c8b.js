import{d as F,L as K,a as M,c as y,M as t,N as i,V as N,W as T,Z as f,am as W,F as d,X as x,$ as v,ah as g,b as h,S as D,cf as X,Y as C,R as b,a0 as Y,ab as Z,a1 as q,aa as G}from"./index.3614183b.js";/* empty css              *//* empty css              */import{_ as H}from"./index.351a724d.js";const J={class:"ant-card-body"},Q={class:"condition"},j=C("delete"),ee=C("delete"),ae=C("Add inner group"),le=C("Add filter"),te={name:"CreateRule",mixins:[]},ne=F({...te,props:["rulesData","keys","formDatas","valueData","topDatas","enableDeleteChild","autoIndex"],emits:["changeObserver","rulesChange"],setup(o,{emit:z}){const e=o;K(()=>{}),console.log(e.valueData);let p=M("AND");const U=[{value:"=",label:"="},{value:"<>",label:"<>"},{value:"IN",label:"IN"},{value:"LIKE",label:"LIKE"}],R=[{value:"=",label:"="},{value:"<",label:"<"},{value:">",label:">"},{value:"<=",label:"<="},{value:">=",label:">="},{value:"<>",label:"<>"},{value:"IN",label:"IN"}],w=y(()=>e.valueData.map((a,s)=>({name:a.name,type:a.type,values:a.values.map(n=>({value:n,label:n}))})));y(()=>e.rulesData[0].id%2==0?{backgroundColor:"#f0f0f0"}:{backgroundColor:"white"});const B=y(()=>e.rulesData[0].relation=="AND"?{backgroundColor:"#ffd591"}:{backgroundColor:"#91d5ff"}),_=()=>{z("changeObserver",e.rulesData)};function V(){let a=e.formDatas&&e.formDatas[0]&&e.formDatas[0].label;if(a){if(e.rulesData[0].conditions.length>0){let s=e.rulesData[0].conditions.length,n=e.rulesData[0].conditions[s-1];n.name&&n.operator&&n.value?e.rulesData[0].conditions.push({name:a,operator:"=",value:void 0,selectvalues:p.value}):b.warning("Please complete condition editing first")}else e.rulesData[0].conditions.push({name:a,operator:void 0,value:void 0,selectvalues:p.value});u(e.rulesData)}else b.warning("Please get the condition data first!")}function L(){let a=e.formDatas&&e.formDatas[0]&&e.formDatas[0].label;if(e.rulesData[0].relation)if(a){let s="AND";e.rulesData[0].children.push({relation:s,id:e.rulesData[0].id+1,conditions:[{name:a,operator:void 0,value:void 0,selectvalues:p.value}],children:[]}),_()}else b.warning("Please get the condition data first!");else b.warning("Please select the conditional link keyword first")}function A(a){e.topDatas&&e.topDatas[0].children&&e.topDatas[0].children.length>0&&e.topDatas[0].children.splice(a,1),u(e.rulesData)}function P(a){e.rulesData[0].conditions.splice(a,1),e.rulesData[0].conditions.length==0&&A(a),u(e.rulesData)}function S(a){u()}function u(a){_(),z("rulesChange",e.rulesData,e.keys)}const $=a=>{a=="AND"||a=="&&"?(e.rulesData[0].relation="OR",p.value="OR",e.rulesData[0].conditions[0].selectvalues="OR"):(a=="OR"||a=="||")&&(e.rulesData[0].relation="AND",p.value="AND",e.rulesData[0].conditions[0].selectvalues="AND")};return(a,s)=>{const n=q,m=Y,I=H,E=Z("create-rule",!0);return t(),i("div",{class:X(["rules-box",[f(e).rulesData[0].id%2==0?"bgc-box":"bgc-box1"]])},[N("div",{style:W(f(B)),class:"title",onClick:s[0]||(s[0]=l=>$(f(e).rulesData[0].relation))},T(f(e).rulesData[0].relation),5),N("div",J,[(t(!0),i(d,null,x(o.rulesData[0].conditions,(l,O)=>(t(),v(I,{key:"condition"+O,class:"loop-child"},{default:D(()=>[h(n,{class:"condition",value:l.name,"onUpdate:value":r=>l.name=r,options:o.formDatas,onChange:u,size:"small",placeholder:"name"},null,8,["value","onUpdate:value","options"]),(t(!0),i(d,null,x(o.valueData,(r,k)=>(t(),i(d,{key:k},[r.name==l.name?(t(),i(d,{key:0},[r.type=="string"?(t(),v(n,{key:0,class:"condition",value:l.operator,"onUpdate:value":c=>l.operator=c,onChange:u,options:U,size:"small",placeholder:"operator"},null,8,["value","onUpdate:value"])):(t(),v(n,{key:1,class:"condition",value:l.operator,"onUpdate:value":c=>l.operator=c,onChange:u,options:R,size:"small",placeholder:"operator"},null,8,["value","onUpdate:value"]))],64)):g("",!0)],64))),128)),N("div",Q,[(t(!0),i(d,null,x(f(w),(r,k)=>(t(),i(d,{key:k},[r.name==l.name?(t(),i(d,{key:0},[l.operator=="IN"&&l.value&&r.name==l.name?(t(),v(n,{key:0,options:r.values,mode:"multiple",size:"small",value:l.value,"onUpdate:value":c=>l.value=c,onChange:u,placeholder:"value"},null,8,["options","value","onUpdate:value"])):(t(),v(n,{key:1,options:r.values,size:"small",value:l.value,"onUpdate:value":c=>l.value=c,onChange:u,placeholder:"value"},null,8,["options","value","onUpdate:value"]))],64)):g("",!0)],64))),128))]),h(m,{class:"button-select",onClick:r=>P(O),title:"delete",size:"small"},{default:D(()=>[j]),_:2},1032,["onClick"])]),_:2},1024))),128))]),o.rulesData[0].children.length>0?(t(),v(E,{key:0,style:{"margin-left":"35px"},valueData:o.valueData,formDatas:o.formDatas,topDatas:o.rulesData,rulesData:o.rulesData[0].children,enableDeleteChild:!0,onRulesChange:S,onChangeObserver:_},null,8,["valueData","formDatas","topDatas","rulesData"])):g("",!0),h(I,{class:"loop-childs"},{default:D(()=>[o.enableDeleteChild?(t(),v(m,{key:0,class:"button-select button-loop",title:"delete filter",size:"small",onClick:s[1]||(s[1]=l=>A(o.autoIndex))},{default:D(()=>[ee]),_:1})):g("",!0),h(m,{class:"button-select",title:"Add inner group",size:"small",onClick:L},{default:D(()=>[ae]),_:1}),h(m,{class:"button-select",title:"Add filter",size:"small",onClick:V},{default:D(()=>[le]),_:1})]),_:1})],2)}}});const ie=G(ne,[["__scopeId","data-v-59a76b52"]]);export{ie as C};
