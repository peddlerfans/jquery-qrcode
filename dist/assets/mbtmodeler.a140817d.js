import{b as n,a8 as Mt,bU as Bt,a as s,Q as ce,r as ae,d as Z,ac as Ve,L as Re,c as ne,w as Se,M as g,N as F,V as b,S as _,ah as U,$ as q,Y as z,W as B,F as re,X as jt,Z as l,R as et,a0 as he,aa as de,bP as Be,ar as Y,bH as $e,E as rt,ai as Pe,bV as Ue,bW as ze,bX as Vt,q as ee,v as te,au as ct,az as pt,a5 as Rt,O as dt,aB as mt,bY as Ut,bZ as tt,bN as zt,bR as at,ab as lt,bD as Lt,b_ as Nt}from"./index.3614183b.js";import{_ as Gt,T as Wt}from"./index.4642cd79.js";import{a as qt,P as Kt,_ as _t}from"./index.01976f6f.js";import{_ as Le}from"./index.89207c6a.js";/* empty css               */import{_ as Ee}from"./index.5931ae8c.js";/* empty css              */import{l as le,_ as Q}from"./lodash.fdab4995.js";import{a as Ne,b as oe,M as Jt,S as Ht,T as Qt,H as Xt,I as Yt,K as Zt}from"./keyboard.4bbb2da5.js";import{s as vt,G as pe}from"./input-select-item.b98c8f1f.js";import{_ as ea}from"./index.f0aa9044.js";import{C as ta}from"./CheckCircleTwoTone.8a6ca075.js";import"./index.67b1fa01.js";import{E as fe}from"./EditOutlined.cfe60ffa.js";import{D as xe}from"./DeleteOutlined.a585300f.js";import{h as aa}from"./http.0645eb90.js";import{_ as la}from"./index.c5cedc9d.js";import{_ as na}from"./index.vue_vue_type_script_setup_true_lang.dc6c6f55.js";import{C as sa}from"./CreateRule.ae707c8b.js";import"./useRefs.e2c20bfc.js";import"./_commonjs-dynamic-modules.30ae7933.js";/* empty css               *//* empty css               *//* empty css              */import"./index.351a724d.js";var oa={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M696 480H544V328c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v152H328c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h152v152c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V544h152c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8z"}},{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}}]},name:"plus-circle",theme:"outlined"};const ia=oa;function nt(u){for(var a=1;a<arguments.length;a++){var o=arguments[a]!=null?Object(arguments[a]):{},e=Object.keys(o);typeof Object.getOwnPropertySymbols=="function"&&(e=e.concat(Object.getOwnPropertySymbols(o).filter(function(t){return Object.getOwnPropertyDescriptor(o,t).enumerable}))),e.forEach(function(t){ua(u,t,o[t])})}return u}function ua(u,a,o){return a in u?Object.defineProperty(u,a,{value:o,enumerable:!0,configurable:!0,writable:!0}):u[a]=o,u}var Ge=function(a,o){var e=nt({},a,o.attrs);return n(Mt,nt({},e,{icon:ia}),null)};Ge.displayName="PlusCircleOutlined";Ge.inheritAttrs=!1;const st=Ge,{t:ra}=Bt.global;function ca(u){for(const e of u)e.resizable===void 0&&e.width&&!isNaN(e.width)&&(e.resizable=!0);const a=le.exports.cloneDeep(u);return[ae(u),a]}function pa(u,a){return ae(Object.assign({current:1,pageSize:20,pageSizeOptions:["10","20","50","100","200"],showSizeChanger:!0,showQuickJumper:!0,showTotal:(t,d)=>ra("component.table.pageTip",{head:d[0],tail:d[1],total:t}),onChange(t,d){this.current=t,this.pageSize=d,a&&a()}},u))}function da({table:u,columns:a,pagination:o,updateTableOptions:e}){const t=s(!1),d=s([]),[p,f]=ca(a),D=pa(o,$),T=s([]);return{selectedRowKeys:T,tableLoading:t,dataSource:d,columns:p,originColumns:f,pagination:D,updateTable:$,onTableRowSelectChange:h,toggleAll:y,tableResize:I};function $({fetchUrl:w}={}){if(w||(w=e.fetchUrl),!w)return console.warn("\u8868\u683C\u66F4\u65B0\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u53C2\u6570{fetchUrl}");T.value=[],t.value=!0,ce.get(w,{params:{page:D.current,perPage:D.pageSize}}).then(C=>{var M;if(C.hasOwnProperty("data")&&C.hasOwnProperty("total")){let A=C.data,L=C.total;Object.assign(C.data,{data:A}),Object.assign(C.data,{total:L}),d.value=(M=C.data)==null?void 0:M.data,D.total=C.total}else{let A=[];A.push(C),d.value=A,D.total=1}}).catch(C=>{console.log("err:",C)}).finally(()=>{t.value=!1})}function h(w){T.value=w}function y(w=null){!d.value||(w!==null&&w||w===null&&T.value.length<d.value.length?T.value=d.value.map(C=>C.id):T.value=[])}function I(w,C){C.width=w}}const je=(u,a)=>{let o=[];return u.forEach(e=>{let t="",d=[];switch(e.type){case"int":t="number";break;case"str":t="string";break;case"float":t="number";break;case"number":t="number";break;case"boolean":t="boolean";break;case"SUT":t="string";break}let p;if(e.hasOwnProperty("enum")&&e.enum.length>0&&t=="string")d=le.exports.split(e.enum,","),e._id&&(p={[e._id]:{type:`${t}`,"ui:hidden":!0,title:e._id}}),e.description?p={[e.description]:{type:`${t}`,title:e.description}}:e.name&&(p={[e.name]:{type:`${t}`,title:e.name}});else if(e.hasOwnProperty("enum")&&e.enum.length>0&&t=="number"){let f=le.exports.split(e.enum,","),D=f.length;for(let T=0;T<D;T++)d.push(parseInt(f[T]));e.description?p={[e.name]:{type:`${t}`,title:e.description}}:p={[e.name]:{type:`${t}`,title:e.name}}}else e.description?p={[e.name]:{type:`${t}`,title:e.description}}:p={[e.name]:{type:`${t}`,title:e.name}};Object.assign({tempobj:p},{_id:{type:"string",title:a,"ui:hidden":!0,default:a}}),o.push(p)}),o},ft=u=>u.map((a,o)=>({...a,key:o}));function ma(u){let a=[];if(le.exports.isArray(u)&&u.length>0){let o=[];Object.keys(u[0]).forEach(e=>{let t={};Object.assign(t,{title:e,dataIndex:e,key:e,width:e.length*3}),o.push(t)}),a=o}return a}async function _a(u){let a={},o=`/api/templates/${u}/preview`,e=[];return await ce.post(o).then(t=>{e=t.data,console.log(e),e.length>0&&(a=ft(e))}),a}async function ve(u){let a=[],o=`/api/templates?q=category:${u}&search=`,e=[];return await ce.get(o).then(t=>{e=t.data,e.length>0&&(a=ft(e))}),a}const va={style:{height:"100%","overflow-x":"hidden !important"}},fa={key:0},ha={key:2},ga=z("Save"),ya=z("choose template"),ba=Z({__name:"templateTable",props:{templatedetailtableData:null,tableData:null,tableColumns:null,templateCategory:null},emits:["submitTemplate","update","clear"],setup(u,{emit:a}){const o=u;let e=Ne(),t=oe();s(o.tableData),s(o.tableColumns);let d=s(o.templateCategory),p="",f=s(!1),D=s();D.value=[{title:"name",dataIndex:"name",key:"name",width:40},{title:"description",dataIndex:"description",key:"description",width:120},{title:"tags",dataIndex:"tags",key:"tags",width:100,customRender:m=>le.exports.isArray(m.value)?m.value.toString():m.value}];let T=s([{title:"name",dataIndex:"name",key:"name",width:40},{title:"description",dataIndex:"description",key:"description",width:120},{title:"tags",dataIndex:"tags",key:"tags",width:100,customRender:m=>le.exports.isArray(m.value)?m.value.toString():m.value}]);const $=s();ae({search:"",size:20,page:1,perPage:20}),ae({search:""});let{dataSource:h,columns:y,originColumns:I,tableLoading:w,pagination:C,updateTable:M,onTableRowSelectChange:A,tableResize:L}=da({table:$,columns:D.value,updateTableOptions:{fetchUrl:p}});const G=Ve();Re(()=>{if(localStorage.getItem("mbt_"+G.params._id+G.params.name),h.value,e.mbtData.dataDefinition.data){let m=e.mbtData,k="";m.dataDefinition&&m.dataDefinition.data&&m.dataDefinition.data.tableData.length>0?(h.value=m.dataDefinition.data.tableData,D.value=m.dataDefinition.data.tableColumns.filter(j=>j.title!=="key"),d.value==1&&m.dataDefinition.data.dataFrom=="static_template"?(k="dynamic",ve(k).then(j=>{if(j.length>0){let V=j;h.value=V,D.value=T.value}})):d.value==2&&m.dataDefinition.data.dataFrom=="dynamic_template"&&(k="static",ve(k).then(j=>{if(j.length>0){let V=j;h.value=V,D.value=T.value}}))):(d.value,h.value.length==0&&O())}});function x(m){m&&m._id&&m.category=="dynamic"?(f.value=!0,_a(m._id).then(k=>{let j=ma(k);D.value=j,h.value=k}).catch(()=>{et.warning("Please configure this template first")})):m&&m._id&&m.category=="static"&&(m.model?(h.value=m.model.data,D.value=m.model.schema):et.warning("Pleaes define the params in static template."))}ae({enums:[],inputVisible:!1,inputValue:""});function i(){let m={};Object.assign(m,{tableData:h.value}),Object.assign(m,{tableColumns:D.value}),a("update",m)}function r(m){let k=!1;return m.forEach(j=>{j._id?k=!1:k=!0}),k}ne(()=>{h.value,D.value}),Se(()=>h.value,m=>{let k="",j={tableData:h.value,tableColumns:D.value};(d.value=1)?k="dynamic_template":(d.value=2)&&(k="static_template"),r(h.value)&&(e.saveData(h.value,D.value,k),t.setDataDefinition(j))},{deep:!0});const S=s(!0),O=()=>{let m=d.value,k="";m==1?(k="dynamic",p="/api/templates?q=category:dynamic&search="):m==2&&(k="static",p="/api/templates?q=category:static&search="),ve(k).then(j=>{if(j.length>0){let V=j;D.value=T.value,h.value=V}}),S.value=!0,M()};return(m,k)=>{const j=he,V=qt,K=Ee;return g(),F(re,null,[b("main",va,[n(K,{ref_key:"tableRef",ref:$,class:"table",rowKey:"key",dataSource:l(h),columns:l(D),pagination:l(C),loading:l(w),scroll:{x:!0},bordered:"",onResizeColumn:l(L)},{headerCell:_(({column:N})=>[N.key==="name"?(g(),F("span",fa," Name ")):U("",!0)]),bodyCell:_(({column:N,record:v})=>[N.key==="name"?(g(),q(j,{key:0,type:"link",onClick:E=>x(v)},{default:_(()=>[z(B(v.name),1)]),_:2},1032,["onClick"])):N.key==="description"?(g(),F(re,{key:1},[z(B(v.description),1)],64)):N.key==="tags"?(g(),F("span",ha,[(g(!0),F(re,null,jt(v.tags,E=>(g(),q(V,{key:E,color:E==="loser"?"volcano":E.length>5?"geekblue":"green"},{default:_(()=>[z(B(E.toUpperCase()),1)]),_:2},1032,["color"]))),128))])):U("",!0)]),_:1},8,["dataSource","columns","pagination","loading","onResizeColumn"])]),n(j,{style:{position:"absolute",top:"-2.25rem",right:"9rem"},type:"primary",size:"small",onClick:k[0]||(k[0]=N=>i())},{default:_(()=>[ga]),_:1}),S.value?(g(),q(j,{key:0,style:{position:"absolute",top:"-2.25rem",right:"0"},type:"primary",size:"small",onClick:k[1]||(k[1]=N=>O())},{default:_(()=>[ya]),_:1})):U("",!0)],64)}}});const ka=de(ba,[["__scopeId","data-v-693f8864"]]),Ae=oe();function ot(u,a,o){let e=[];return Array.isArray(a)&&(e=a.map(d=>({value:`{{${d.title}}}`,label:d.title}))),Da(u).forEach(d=>{let p=u.properties;p[d]={title:d,type:"string",patternProperties:!1},o&&(o[d]={"ui:widget":vt,"ui:options":e})}),{schema:u,uiSchema:o}}function Da(u){let a=[];for(let o in u.properties){const e=u.properties[o];!(e.hasOwnProperty("readOnly")&&e.readOnly)&&!e["ui:hidden"]&&a.push(o)}return a}function it(u,a){const o=u.properties,e=Ae.getMetaData.detail;let t=[];for(let d in o){const p=o[d];p.type==="string"&&(t.push(d),o[d]={title:p.title,type:"string",patternProperties:!1},a[d]={"ui:widget":vt,"ui:options":wa(p.title,e)})}return Ae.setMetaData(t,"customKeys"),{schema:u,uiSchema:a}}function wa(u,a){if(!a)return[];let o=a.filter(e=>e.description===u)[0];return o?(o.enum||[]).map(e=>({label:e,value:e})):[]}function Ca(u){let a=Be(u),o=Ae.getMetaData.customKeys;for(let e of o){if(!Array.isArray(a[e])||a[e].length===0)continue;a[e].length>1&&(a[e]=u[e].pop());const t=a[e][0];a[e]=t,a[e]={type:Ae.checkMetaFormItemIsCustom(e,t)?2:1,value:t}}return a}const Sa={style:{margin:"5px",padding:"5px"}},$a={key:0},xa={key:1},Aa={class:"awtable"},Pa={key:0,href:"/#/templatemanager/meta"},Ea=z("Save"),Ta=z("Choose A Template"),Oa=Z({__name:"metainfo",props:{isFormVisible:{type:Boolean},metatemplatedetailtableData:null,schema:null,metaformProps:null,metatemplatecolumns:null},emits:["submitTemplate"],setup(u,{emit:a}){const o=u,e=oe(),t=Ne(),d={show:!1};let p=s(o.schema),f=s({});function D(x,i){const r=it(x,i);p.value=r.schema,i.value=r.uiSchema}D(p.value,f.value);let T=s(o.metaformProps);const $=s(o.isFormVisible);let h=s(o.metatemplatedetailtableData);Se(h,x=>{for(let i in x)Array.isArray(x[i])&&x[i].length>1&&(x[i]=[x[i].pop()])},{deep:!0});let y=s(o.metatemplatecolumns),I=s([]);const w=s(!1);Re(()=>{ve("meta").then(x=>{if(x.length>0){w.value=!1;let i=x;I.value=i}})});function C(){let x={};Object.assign(x,{schema:$e(p.value)}),Object.assign(x,{data:$e(Ca(h.value))}),Object.assign(x,{detail:e.getMetaData.detail}),a("submitTemplate",x)}async function M(x,i){let r={type:"object",properties:{}},S=await ce.get(`/api/templates/${x}`,{params:{q:`category:${i}`,search:""}});if(S.model){let O=S.model;e.setMetaData(O,"detail"),e.setMetaData(S._id,"_id"),console.log(e.mbtMeta);let m=O.filter(k=>k.requerd).map(k=>k.description);return Object.assign(r,{required:m}),Q.isArray(O)&&je(O,x).forEach(j=>{Object.assign(r.properties,j)}),it(r,f.value).schema}}const A=x=>{$.value=!$.value,M(x,"meta").then(i=>{D(i,f.value)})},L=()=>{$.value=!1,h.value={},p&&p.value&&(p.value.properties={})};let G=ne(()=>{p.value,h.value});return Se(()=>G.value,x=>{t.saveMeta(p.value,h.value)},{deep:!0}),(x,i)=>{const r=he,S=Ee;return g(),F(re,null,[b("div",Sa,[$.value?(g(),q(l(pe),{key:0,modelValue:l(h),"onUpdate:modelValue":i[0]||(i[0]=O=>Y(h)?h.value=O:h=O),schema:l(p),formProps:l(T),formFooter:d,uiSchema:l(f)},null,8,["modelValue","schema","formProps","uiSchema"])):U("",!0)]),$.value?U("",!0):(g(),q(S,{key:0,columns:l(y),"data-source":l(I),bordered:""},{bodyCell:_(({column:O,text:m,record:k})=>[O.key==="name"?(g(),F("div",$a,[n(r,{type:"link",onClick:j=>A(k._id)},{default:_(()=>[z(B(m),1)]),_:2},1032,["onClick"])])):U("",!0),O.key==="description"?(g(),F("div",xa,B(m),1)):U("",!0),O.key==="tags"?(g(),F(re,{key:2},[z(B(m),1)],64)):U("",!0)]),_:1},8,["columns","data-source"])),b("div",Aa,[w.value?(g(),F("a",Pa," Jump to Meta Template ")):U("",!0),n(r,{type:"primary",onClick:C},{default:_(()=>[Ea]),_:1}),$.value?(g(),q(r,{key:1,style:{"margin-right":"10px"},type:"link",onClick:L},{default:_(()=>[Ta]),_:1})):U("",!0)])],64)}}});const Fa=de(Oa,[["__scopeId","data-v-0911d657"]]),Ia=u=>(Ue("data-v-29041f24"),u=u(),ze(),u),Ma={style:{height:"100%","overflow-x":"hidden !important"}},Ba=z(" Add column "),ja={style:{"margin-left":"5px"}},Va={key:0,class:"editable-cell"},Ra={key:0,class:"editable-cell-input-wrapper"},Ua={key:1,class:"editable-cell-text-wrapper"},za={key:0},La={key:1,class:"editable-row-operations"},Na={key:0},Ga=z("cancel"),Wa={key:1},qa=["onClick"],Ka=Ia(()=>b("a",{style:{"margin-left":"5px"}},"Delete",-1)),Ja=z("Save"),Ha=Z({__name:"inputTable",props:{detailtableData:null,tableColumns:null,tableData:null},emits:["update"],setup(u,{emit:a}){const o=u;let e=s(o.tableColumns),t=s(o.tableData);const d=s([{title:"ID",dataIndex:"ID",key:"ID"},{title:"action",dataIndex:"action",key:"action",fixed:"right",width:100}]),p=s([{key:"1",ID:"1"}]),f=ne(()=>{if(e&&e.value&&e.value.length)return e.value.length;if(typeof e.value>"u")return e.value=d.value,e.value.length}),D=ne(()=>t.value.length+1);function T(){let i={};Object.assign(i,{tableData:$e(t.value)}),Object.assign(i,{tableColumns:$e(e.value)}),a("update",i)}const $=ae({});console.log(t.value);const h=()=>{let i=[];e&&e.value&&le.exports.isArray(e.value)?e.value.forEach(m=>{i.push(m)}):typeof e.value>"u"&&(e.value=d.value);let r={key:""},S="key",O=s({title:"key",dataIndex:"key",key:"key"});i.push(O.value),i.forEach(m=>{S=m.title,S=="key"?Object.assign(r,{key:`${D.value}`}):Object.assign(r,{[S]:""})}),t&&typeof t.value>"u"&&(t.value=p.value),typeof t<"u"&&typeof t.value<"u"&&(t.value.push(r),"key"in r&&($[r.key]=r))},y=i=>{t.value=t.value.filter(r=>r.key!==i),delete $[i]},I=i=>{Object.assign(t.value.filter(r=>i===r.key)[0],$[i]),delete $[i]},w=i=>{$[i]=Be(t.value.filter(r=>i===r.key)[0])},C=i=>{delete $[i]},M=ae({}),A=()=>{console.log(f.value);let i={title:`Property${f.value}`,dataIndex:`Property${f.value}`,key:`Property${f.value}`};f.value=="undefined"&&(i={title:"Property1",dataIndex:"Property1",key:"Property1"});const r={title:"action",dataIndex:"action",key:"action",fixed:"right",width:100};e&&typeof e.value>"u"&&(e.value=d.value),le.exports.remove(e.value,S=>S.key=="action"),e.value.push(i),e.value.push(r),M[i.title]={...i}};function L(i){le.exports.remove(e.value,r=>r.key==i)}const G=i=>{M[i]=Be(e.value.filter(r=>i===r.title)[0])},x=i=>{Object.assign(e.value.filter(S=>i===S.title)[0],M[i]);let r=M[i].title;e.value.filter(S=>{r===S.title&&(Object.assign(S,{title:r}),Object.assign(S,{dataIndex:r}),Object.assign(S,{key:r}))}),delete M[i]};return(i,r)=>{const S=he,O=Pe,m=ea,k=_t,j=Ee;return g(),F("main",Ma,[n(S,{type:"primary",onClick:r[0]||(r[0]=V=>A())},{default:_(()=>[Ba]),_:1}),b("span",ja,[n(S,{type:"primary",onClick:r[1]||(r[1]=V=>h())},{icon:_(()=>[n(l(Kt))]),_:1})]),b("div",null,[n(j,{dataSource:l(t),columns:l(e)},{headerCell:_(({column:V})=>[V.key!=="action"?(g(),F("div",Va,[M[V.title]?(g(),F("div",Ra,[n(O,{value:M[V.title].title,"onUpdate:value":K=>M[V.title].title=K,onPressEnter:K=>x(V.title)},null,8,["value","onUpdate:value","onPressEnter"]),n(l(rt),{class:"editable-cell-icon-check",onClick:K=>x(V.title)},null,8,["onClick"])])):(g(),F("div",Ua,[z(B(V.title)+" ",1),n(l(fe),{class:"editable-cell-icon",onClick:K=>G(V.title)},null,8,["onClick"]),n(l(xe),{onClick:K=>L(V.key)},null,8,["onClick"])]))])):U("",!0)]),bodyCell:_(({column:V,text:K,record:N})=>[V.key!=="action"?(g(),F("div",za,[$[N.key]?(g(),q(O,{key:0,value:$[N.key][V.dataIndex],"onUpdate:value":v=>$[N.key][V.dataIndex]=v,style:{margin:"-5px 0"}},null,8,["value","onUpdate:value"])):(g(),F(re,{key:1},[z(B(K),1)],64))])):V.dataIndex==="action"?(g(),F("div",La,[$[N.key]?(g(),F("span",Na,[n(m,{onClick:v=>I(N.key),style:{"font-size":"16px"}},{default:_(()=>[n(l(ta),{"two-tone-color":"#52c41a"})]),_:2},1032,["onClick"]),n(m,{onClick:v=>C(N.key),style:{"margin-left":"7px"}},{default:_(()=>[Ga]),_:2},1032,["onClick"])])):(g(),F("span",Wa,[b("a",{onClick:v=>w(N.key)},"Edit",8,qa),n(k,{title:"Sure to delete?",onConfirm:v=>y(N.key)},{default:_(()=>[Ka]),_:2},1032,["onConfirm"])]))])):U("",!0)]),_:1},8,["dataSource","columns"])]),n(S,{type:"primary",onClick:r[2]||(r[2]=V=>T())},{default:_(()=>[Ja]),_:1})])}}});const Qa=de(Ha,[["__scopeId","data-v-29041f24"]]),ut=Vt(),Xa={no_data:"\u6A21\u677F\u6CA1\u6709\u6570\u636E\uFF0C\u53EF\u53CC\u51FB\u753B\u5E03\u7A7A\u8868\u754C\u9762\uFF0C\u8FDB\u5165 Data pool \u9875\u8FDB\u884C\u7F16\u8F91",no_meta:"\u6A21\u677F\u6CA1\u6709\u8BBE\u7F6Emeta\u6570\u636E\uFF0C\u53EF\u53CC\u51FB\u753B\u5E03\u7A7A\u8868\u754C\u9762\uFF0C\u8FDB\u5165 Meta \u9875\u8FDB\u884C\u7F16\u8F91",no_templates_define:"\u6A21\u677F\u6CA1\u6709\u8BBE\u7F6E\u6A21\u677F\u5F15\u64CE\uFF0C\u53EF\u53CC\u51FB\u753B\u5E03\u7A7A\u8868\u754C\u9762\uFF0C\u8FDB\u5165 Attributes \u9875\u8FDB\u884C\u8BBE\u7F6E Output Text \u548C Output Script",not_start_end:"\u6A21\u578B\u8FDE\u63A5\u7EBF\u8FDE\u63A5\u8282\u70B9\u6709\u65AD\u70B9\uFF0C\u8BF7\u4ED4\u7EC6\u68C0\u67E5"},Ya=u=>{switch(u){case"no_data":case"no_meta":case"no_templates_define":case"not_start_end":return Xa[u]}},Za=u=>{let o=Object.keys(u).map(e=>({err:e,reason:Ya(e)}));ut.setErrList(o),ut.setVisible(!0)},el={class:"search-wrap"},tl={class:"search"},al=Z({__name:"index",props:{url:{default:""},params:{default:null}},emits:["search"],setup(u,{emit:a}){const o=u;let e=s(""),t=s(!1),d=s(),p=s(""),f=s([{value:"tags:",label:"tags:",isLeaf:!1},{value:"name:",label:"name:"}]);function D(){t.value=e.value==="@"}function T(y){ce.get(o.url,{params:o.params}).then(I=>{const w=y[0];w.loading=!0,I.length>0&&(I=I.map(C=>({value:C,label:C})),w.children=I),w.loading=!1,f.value=[...f.value]})}function $(y){if(y){let I=new RegExp(",","g");e.value+=y.toString().replace(I,"")}p.value="",t.value=!1,ct(()=>{d.value.focus()})}function h(){a("search",e.value)}return(y,I)=>{const w=Pe,C=la,M=he;return g(),F("div",el,[b("div",tl,[n(w,{value:l(e),"onUpdate:value":I[0]||(I[0]=A=>Y(e)?e.value=A:e=A),placeholder:y.$t("awModeler.inputSearch1"),onChange:D,onPressEnter:h,ref_key:"searchInput",ref:d},null,8,["value","placeholder"]),ee(n(C,{"load-data":T,value:l(p),"onUpdate:value":I[1]||(I[1]=A=>Y(p)?p.value=A:p=A),placeholder:"Please select",options:l(f),onChange:$},null,8,["value","options"]),[[te,l(t)]])]),n(M,{type:"primary",class:"save-btn",onClick:h},{default:_(()=>[z(B(y.$t("common.searchText")),1)]),_:1})])}}});const ll=de(al,[["__scopeId","data-v-65517d46"]]),nl=Z({__name:"aw-schema-table-modal",props:{show:{type:Boolean,default:!1}},emits:["clickRow","closeModal"],setup(u,{emit:a}){const o=u;let e={url:"/api/hlfs/_tags",params:{q:"category:meta"}};Se(()=>o.show,y=>{y&&ct(()=>D())});let t=s(null);const d=[{title:"name",width:40,link:"custom"},{title:"description",width:120},{title:"tags",width:100}];let p=s({search:"",page:1,perPage:10});function f(y){p.value.page=1,p.value.search=y,D()}function D(){t.value.loading=!0,aa.get("/api/hlfs",{params:p.value}).then(({data:y})=>{t.value.setTableData({tableData:y.data,pageSize:p.value.perPage,currentPage:p.value.page,total:y.total})}).finally(()=>{t.value.loading=!1})}function T(y){a("clickRow",y)}function $(y){p.value.page=y.current,p.value.perPage=y.pageSize,D()}function h(){console.log(1),a("closeModal")}return(y,I)=>{const w=pt;return g(),q(w,{visible:o.show,"onUpdate:visible":I[0]||(I[0]=C=>o.show=C),width:"60%",title:"\u9009\u62E9AW",onCancel:h,footer:null},{default:_(()=>[n(l(ll),{url:l(e).url,params:l(e).params,onSearch:f},null,8,["url","params"]),n(l(na),{ref_key:"awTable",ref:t,columns:d,tableRef:"awTable",onGo2Page:T,onPageChange:$},null,512)]),_:1},8,["visible"])}}}),ht=u=>(Ue("data-v-56175f18"),u=u(),ze(),u),sl={class:"edit-aw-wrap"},ol={class:"aw-wrap"},il={class:"title-wrap"},ul={class:"title"},rl={class:"right-btn"},cl=ht(()=>b("div",{"slot-scope":"{ schemaValue }"},null,-1)),pl={class:"title-wrap"},dl={class:"title"},ml={class:"right-btn"},_l=ht(()=>b("div",{"slot-scope":"{ schemaValue }"},null,-1)),vl=Z({__name:"mbt-modeler-aw-schema",props:{show:{type:Boolean,default:!0}},emits:["change"],setup(u,{expose:a,emit:o}){const e=s(!1),t=Rt(),d=Ve(),p={title:"AW",type:"object",description:"",properties:{_id:{type:"string","ui:hidden":!0,required:!0},name:{title:"AW Name",type:"string",readOnly:!0},description:{title:"Description",type:"string",readOnly:!0,"ui:widget":"TextAreaWidget"},template:{title:"Template",type:"string",readOnly:!0},tags:{title:"Tags",type:"string",readOnly:!0}}},f=oe(),{t:D}=dt();function T(v,E){var ge,ye;const W=v.properties.name,ie=v.properties.description,X=v.properties.template,Te=v.properties.tags;return W&&delete v.properties.name,ie&&delete v.properties.description,X&&delete v.properties.template,Te&&delete v.properties.tags,v.title=E?E.name:((ge=f.getPrimaryAw.data)==null?void 0:ge.name)||"",v.description=E?E.description:((ye=f.getPrimaryAw.data)==null?void 0:ye.description)||"",v}let $="1",h=s(p),y=s({}),I=s({}),w=s(p),C=s({}),M=s({});const A={layoutColumn:1,labelPosition:"left",labelWidth:"75px",labelSuffix:":"},L=ne(()=>!Q.isEmpty(f.getExpectedAw.schema)),G=ne(()=>Q.isEmpty(f.getPrimaryAw.schema));function x(){$="1",e.value=!0}function i(){$="2",e.value=!0}function r(v){let E="",W="",ie=localStorage.getItem("mbt_"+d.params._id+d.params.name+"_id");v==="primary"?(E=y.value._id,W=y.value.name):v==="expected"&&(E=C.value._id,W=C.value.name),t.push({name:"awupdate",params:{_id:E,name:W,awupdate:"mbtAW",mbtid:ie,mbtname:localStorage.getItem("mbt_"+d.params.name)}})}function S(){w.value=Q.cloneDeep(p),M.value={},C.value={},f.setEditingExpectedAw({editingExpectedAw:{data:null,schema:null,uiParams:null}})}function O(v){e.value=!1,$==="1"?(h.value=Q.cloneDeep(p),y.value={name:v.name,description:v.description,tags:"",template:v.template,_id:v._id},Q.isArray(v.tags)&&Q.forEach(v.tags,function(E){y.value.tags+=E+" "}),Q.isArray(v.params)&&v.params.length>0&&je(v.params).forEach(W=>{Object.assign(h.value.properties,W)}),m("primary"),h.value=T(h.value,v),f.setEditingPrimaryAw(h.value,"schema"),f.setEditingPrimaryAw(y.value,"data"),f.setEditingPrimaryAw(I.value,"uiParams")):$==="2"&&(w.value=Q.cloneDeep(p),f.setExpectedTableRow(v),C.value={name:v.name,description:v.description,tags:"",template:v.template,_id:v._id},Q.isArray(v.tags)&&Q.forEach(v.tags,function(E,W){C.value.tags+=E+" "}),Q.isArray(v.params)&&je(v.params).forEach(W=>{Object.assign(w.value.properties,W)}),m("expected"),w.value=T(w.value,v),f.setEditingExpectedAw(w.value,"schema"),f.setEditingExpectedAw(C.value,"data"),f.setEditingPrimaryAw(M.value,"uiParams")),o("change")}function m(v){let E={};v==="primary"?(E=ot(h.value,f.getDataPoolTableColumns,I.value),h.value=E.schema,I.value=E.uiSchema):v==="expected"&&(E=ot(w.value,f.getDataPoolTableColumns,M.value),w.value=E.schema,M.value=E.uiSchema)}function k(){h.value=p,y.value={},I.value={}}function j(){w.value=p,C.value={},M.value={}}function V(){k(),j()}function K(){G||f.setEditingPrimaryAw(y.value,"data"),L&&f.setEditingExpectedAw(C.value,"data"),o("change")}function N(){f.getPrimaryAw.schema?(h.value=f.getPrimaryAw.schema,h.value=T(h.value),y.value=f.getPrimaryAw.data||{},I.value=f.getPrimaryAw.uiParams||{}):k(),f.getPrimaryAw.schema&&f.getExpectedAw.schema?(w.value=f.getExpectedAw.schema,w.value=T(w.value),C.value=f.getExpectedAw.data||{},M.value=f.getExpectedAw.uiParams||{}):j()}return a({initSchema:V,handleData:N}),(v,E)=>{const W=mt,ie=Le;return g(),F("div",sl,[b("div",ol,[b("div",il,[b("div",ul,B(v.$t("MBTStore.primary")),1),b("div",rl,[n(W,{placement:"top"},{title:_(()=>[b("span",null,B(l(D)("common.chooseAw")),1)]),default:_(()=>[n(l(st),{onClick:x,class:"icon--primary-btn",style:{"margin-right":"8px"}})]),_:1}),n(W,{placement:"top"},{title:_(()=>[b("span",null,B(l(D)("common.updateAw")),1)]),default:_(()=>[n(l(fe),{onClick:E[0]||(E[0]=X=>r("primary")),class:"icon--primary-btn",style:{"margin-right":"8px"}})]),_:1}),n(W,{placement:"top"},{title:_(()=>[b("span",null,B(v.$t("MBTStore.deleteAW")),1)]),default:_(()=>[ee(n(l(xe),{onClick:S,class:"icon--primary-btn",style:{"margin-right":"8px"}},null,512),[[te,l(L)]])]),_:1})])]),ee(n(l(pe),{modelValue:l(y),"onUpdate:modelValue":E[1]||(E[1]=X=>Y(y)?y.value=X:y=X),schema:l(h),formProps:A,uiSchema:l(I),onChange:K},{default:_(()=>[cl]),_:1},8,["modelValue","schema","uiSchema"]),[[te,!l(G)]]),n(ie),b("div",null,[b("div",pl,[b("div",dl,B(v.$t("MBTStore.expected")),1),b("div",ml,[n(W,{placement:"top"},{title:_(()=>[b("span",null,B(l(D)("common.chooseAw")),1)]),default:_(()=>[n(l(st),{onClick:i,class:"icon--primary-btn",style:{"margin-right":"8px"}})]),_:1}),n(W,{placement:"top"},{title:_(()=>[b("span",null,B(v.$t("MBTStore.updateAw")),1)]),default:_(()=>[n(l(fe),{onClick:E[2]||(E[2]=X=>r("primary")),class:"icon--primary-btn",style:{"margin-right":"8px"}})]),_:1}),n(W,{placement:"top"},{title:_(()=>[b("span",null,B(v.$t("MBTStore.deleteAW")),1)]),default:_(()=>[ee(n(l(xe),{onClick:S,class:"icon--primary-btn",style:{"margin-right":"8px"}},null,512),[[te,l(L)]])]),_:1})])]),ee(n(l(pe),{modelValue:l(C),"onUpdate:modelValue":E[3]||(E[3]=X=>Y(C)?C.value=X:C=X),schema:l(w),formProps:A,uiSchema:l(M),onChange:K},{default:_(()=>[_l]),_:1},8,["modelValue","schema","uiSchema"]),[[te,l(L)]]),n(ie)])]),n(nl,{onClickRow:O,show:e.value,onCloseModal:E[4]||(E[4]=X=>e.value=!1)},null,8,["show"])])}}});const fl=de(vl,[["__scopeId","data-v-56175f18"]]),hl={class:"edit-link-warp"},gl={class:"title"},yl={key:0,"slot-scope":"{ linkSchemaValue }"},bl=Z({__name:"mbt-modeler-link-schema",emits:["change"],setup(u,{expose:a,emit:o}){let e=s(!1);const t=1,d=oe();let p=ne(()=>d.getDataPoolTableColumns.map(A=>({value:A.title,label:A.title}))),D=ne(()=>d.getDataPoolTableData.length>0?T(d.getDataPoolTableData):[]);function T(A){let G=Object.keys(A[0]).map(x=>({name:x,type:"",values:[]}));return A.forEach((x,i)=>{let r=Object.keys(A[0]);r&&G.forEach((S,O)=>{S.name==r[O]&&(S.type=typeof x[r[O]],S.values.push(x[r[O]])),S.values=[...new Set(S.values)]})}),G}const h=s([{relation:"AND",id:1,conditions:[{name:"name",operator:"=",value:void 0,selectvalues:"AND"}],children:[]}]);let y=s({}),I=s({description:"Configuration for Link",type:"object",properties:{_id:{type:"string","ui:hidden":!0,required:!0},label:{title:"Label",type:"string",default:""},isCondition:{type:"boolean",default:!1,"ui:hidden":!0}}});function w(A,L){h.value=A}function C(){d.setLinkData(y,"linkSchemaValue"),d.setLinkData(h,"rulesData"),o("change")}function M(A){e.value=A}return a({setShowDrawer:M}),(A,L)=>{const G=sa;return g(),F("div",hl,[b("div",gl,B(A.$t("MBTStore.configLink")),1),n(l(pe),{modelValue:l(y),"onUpdate:modelValue":L[0]||(L[0]=x=>Y(y)?y.value=x:y=x),schema:l(I),onChange:C},{default:_(()=>[l(e)?(g(),F("div",yl,[l(d).getDataPoolTableData.length>0?(g(),q(G,{key:0,keys:t,formDatas:l(p),valueData:l(D),rulesData:h.value,onRulesChange:w},null,8,["formDatas","valueData","rulesData"])):U("",!0)])):U("",!0)]),_:1},8,["modelValue","schema"])])}}});const kl=de(bl,[["__scopeId","data-v-2e61f03e"]]),Dl={class:"mbt-modeler-grounp-schema-wrap"},wl=b("div",{"slot-scope":"{ DataGroup }"},null,-1),Cl=Z({__name:"mbt-modeler-group-schema",emits:["change"],setup(u,{expose:a,emit:o}){const e=oe();let t=s({description:"",loopCount:""}),d=s({});function p(){d.value=e.getGroupData.schema,t.value=e.getGroupData.data}function f(){e.setGroupData(d.value,"schema"),e.setGroupData(t.value,"data"),o("change")}return a({setData:p}),(D,T)=>(g(),F("div",Dl,[n(l(pe),{schema:l(d),modelValue:l(t),"onUpdate:modelValue":T[0]||(T[0]=$=>Y(t)?t.value=$:t=$),onChange:f},{default:_(()=>[wl]),_:1},8,["schema","modelValue"])]))}}),Sl={class:"mbt-modeler-section-schema-wrap"},$l=b("div",{"slot-scope":"{ DataSection }"},null,-1),xl=Z({__name:"mbt-modeler-section-schema",emits:["change"],setup(u,{expose:a,emit:o}){const e=oe();let t=s({description:""}),d=s({});function p(){const D=e.getSectionData;t.value=D.section,d.value=D.schema}function f(){e.setSectionData(t.value,"section"),o("change")}return a({setData:p}),(D,T)=>(g(),F("div",Sl,[n(l(pe),{schema:l(d),modelValue:l(t),"onUpdate:modelValue":T[0]||(T[0]=$=>Y(t)?t.value=$:t=$),onChange:f},{default:_(()=>[$l]),_:1},8,["schema","modelValue"])]))}}),Al=u=>(Ue("data-v-2f2134e8"),u=u(),ze(),u),Pl={class:"mbt-modeler-right-modal-wrap"},El={class:"desc-wrap"},Tl=Al(()=>b("div",{class:"title"},"\u63CF\u8FF0\uFF1A",-1)),Ol=Z({__name:"mbt-modeler-right-modal",emits:["change"],setup(u,{expose:a,emit:o}){const e=oe();let t=s(""),d=s(!1),p=s(!1),f=s(!1),D=s(!1),T=s(),$=s(),h=s(),y=s();function I(){t.value="",d.value=!1,p.value=!1,f.value=!1,D.value=!1}function w(){const r=e.getShowData.getPropertiesSchema();e.setEditingPrimaryAw(r.step),e.setEditingExpectedAw(r.expectation),d.value=!0,T.value.handleData()}function C(){const i=e.getShowData,r=i.attributes.source.id,S=i.attributes.target.id,O=i.graph.getCell(r),m=i.graph.getCell(S),k=O.attributes.type==="itea.mbt.test.MBTAW"&&m.attributes.type==="itea.mbt.test.MBTParallelGateway";h.value.setShowDrawer(k),p.value=k}function M(){var S,O;const i=e.getShowData,r=(O=(S=i==null?void 0:i.attributes)==null?void 0:S.prop)==null?void 0:O.custom;e.setGroupData({schema:i.getInspectorSchema().schema,data:(r==null?void 0:r.data)||{}}),$.value.setData(),f.value=!0}function A(){const r=e.getShowData.getInspectorSchema().schema;e.setSectionData(r,"schema"),y.value.setData(),D.value=!0}function L(){var r;const i=e.getShowData;return((r=i==null?void 0:i.attributes)==null?void 0:r.type)||""}function G(){var O,m;I();const i=e.getShowData,r=L(),S=(m=(O=i.attributes.prop)==null?void 0:O.custom)==null?void 0:m.description;switch(S&&(t.value=S,e.setDescription(S)),r){case"itea.mbt.test.MBTAW":{w();break}case"itea.mbt.test.MBTLink":case"itea.mbt.test.link":{C();break}case"itea.mbt.test.MBTGroup":{M();break}case"itea.mbt.test.MBTSection":{A();break}}}function x(){const i=t.value;e.setDescription(i),o("change",L())}return a({handleShowData:G}),(i,r)=>{const S=Pe,O=Le;return g(),F("div",Pl,[b("div",El,[Tl,n(S,{value:l(t),"onUpdate:value":r[0]||(r[0]=m=>Y(t)?t.value=m:t=m),onChange:x},null,8,["value"])]),n(O),ee(n(fl,{ref_key:"AwDom",ref:T,show:l(d),onChange:x},null,8,["show"]),[[te,l(d)]]),ee(n(kl,{onChange:x,ref_key:"linkDom",ref:h},null,512),[[te,l(p)]]),ee(n(Cl,{ref_key:"groupDom",ref:$,onChange:x},null,512),[[te,l(f)]]),ee(n(xl,{ref_key:"sectionDom",ref:y,onChange:x},null,512),[[te,l(D)]])])}}});const Fl=de(Ol,[["__scopeId","data-v-2f2134e8"]]),Il={class:"app-header"},Ml={class:"app-title"},Bl=b("div",{class:"toolbar-container"},null,-1),jl={class:"choose-template"},Vl=z("Choose Template"),Rl={class:"app-body"},Ul={ref:"stencils",class:"stencil-container"},zl=b("div",{class:"paper-container"},null,-1),Ll={class:"AwtabInspector"},Nl={class:"tab_ul"},Gl={key:0},Wl={key:1},ql=b("div",{style:{clear:"both"}},null,-1),Kl={class:"dataStyle"},Jl=b("div",{class:"navigator-container"},null,-1),Hl={key:0},Ql={key:1},Xl={key:2},Yl={key:3},Zl={key:4},en=z("previewDetails"),tn={class:"infoPanel card-container"},an={style:{padding:"5px"},class:"attrconfig"},ln=z("Dynamic Template"),nn=z("Static Template"),sn=z("Input directly"),on=z("Add "),un={key:0,class:"editable-cell"},rn={key:0,class:"editable-cell-input-wrapper"},cn={key:1,class:"editable-cell-text-wrapper"},pn={key:1,class:"editable-row-operations"},dn={key:0},mn={key:1},_n={name:"Account"},Un=Z({..._n,setup(u){const a=Ne(),o=oe();dt();const e=Ve();let t,d=s(),p=s(!1);const f=s("2"),D=s(!1);let T=s(!1),$=s(),h=s(!1),y=s(!1),I=s(!1),w=s(!1),C=s({});const M=s(1),A=s(1);let L=s([]),G=s([]),x=s([]),i=s(),r=s([]),S=s([]);const O=ne(()=>k.value.length+1),m=ae({}),k=s([]),j=[{title:"alias",dataIndex:"alias",width:"20%"},{title:"class",dataIndex:"class"},{title:"resourcetype",dataIndex:"resourcetype"},{title:"operation",dataIndex:"operation"}];let V=s({type:"object",properties:{}});const K={layoutColumn:2,labelPosition:"left",labelWidth:"75px",labelSuffix:":  "},N=ae([{title:"name",dataIndex:"name",key:"name",width:180},{title:"description",dataIndex:"description",key:"description",width:180},{title:"tag",dataIndex:"tag",key:"tag"}]);let v=s({_id:"",name:"",description:"",codegen_text:"",codegen_script:""}),E=s([]);const W=s({type:"object",properties:{name:{title:"MBT Name",type:"string",readOnly:!0},description:{title:"Description",type:"string"},codegen_text:{title:"Output Text",type:"string",anyOf:E.value},codegen_script:{title:"Output Script",type:"string",anyOf:E.value}}}),ie=()=>{p.value=!0},X=c=>{M.value=c},Te=c=>{console.log(c)},ge=c=>{},ye=c=>{},gt=c=>{},yt=()=>{const c={key:`${O.value}`,alias:`Resource ${O.value}`,class:`Class. ${O.value}`,resourcetype:`resource type. ${O.value}`};k.value.push(c)},Oe=c=>{Object.assign(k.value.filter(P=>c===P.key)[0],m[c]),delete m[c]},We=c=>{m[c]=le.exports.cloneDeep(k.value.filter(P=>c===P.key)[0])},qe=c=>{delete m[c]},bt=c=>{k.value=k.value.filter(P=>P.key!==c)};function kt(c){}const Ke=()=>{a.saveattr(v.value),k.value.length>0&&a.saveResources(k.value),p.value=!1};function Dt(c){var P;(P=a.changeTemplate)!=null&&P._id&&(v.value={...a.changeTemplate}),a.showMetaSchema&&(V.value=ne(()=>a.showMetaSchema).value,D.value=!0),a.showMetaData&&(C.value=a.showMetaData),c.dataDefinition.resources.length>0&&(k.value=c.dataDefinition.resources),c&&c.dataDefinition&&c.dataDefinition.data&&c.dataDefinition.data.tableData&&(c.dataDefinition.data.dataFrom=="dynamic_template"?(A.value=1,M.value=1,x.value=c.dataDefinition.data.tableData,i.value=c.dataDefinition.data.tableColumns):c.dataDefinition.data.dataFrom=="static_template"?(A.value=2,M.value=2,L.value=c.dataDefinition.data.tableData,G.value=c.dataDefinition.data.tableColumns):(A.value=3,M.value=3,r.value=c.dataDefinition.data.tableData,S.value=c.dataDefinition.data.tableColumns))}let be=null;Re(async()=>{e.params._id&&localStorage.setItem("mbt_"+e.params._id+e.params.name+"_id",JSON.stringify(e.params._id)),ve("codegen").then(c=>{c&&Q.isArray(c)&&c.forEach(P=>{E.value.push({title:P.name,const:P._id})})}).catch(c=>{console.log(c)}),be=JSON.parse(localStorage.getItem("mbt_"+e.params._id+e.params.name+"_id")),await a.getMbtmodel(be),a.mbtData._id&&(Dt(a.mbtData),o.setAllData(a.mbtData)),t=new Jt(d.value,new Ht,new Qt,new Xt,new Yt,new Zt),t.startRappid(),a.mbtData&&a.mbtData.modelDefinition&&a.mbtData.modelDefinition.cellsinfo&&a.mbtData.modelDefinition.cellsinfo.cells&&t.graph.fromJSON(JSON.parse(JSON.stringify(a.getcells))),a.mbtData&&a.mbtData.modelDefinition&&a.mbtData.modelDefinition.hasOwnProperty("paperscale")&&t.paper.scale(a.mbtData.modelDefinition.paperscale),t.graph.on("add",function(c){o.resetEditingExpectedAw(),o.setData(c),c&&c.hasOwnProperty("id")&&(w.value=!0,$.value.handleShowData())}),t.paper.on("cell:pointerdown",c=>{o.setData(c.model),$.value.handleShowData(),w.value=!0}),t.paper.on("blank:pointerdown",(c,P,J)=>{w.value=!1,t.selection.collection.reset([]),t.paperScroller.startPanning(c),t.paper.removeTools()})});const wt=()=>{a.setGraph(t.paper.model.toJSON()),be&&ce.put(`${at}/${be}`,a.getAlldata).then(()=>"\u4FDD\u5B58\u6210\u529F").catch(()=>"\u4FDD\u5B58\u5931\u8D25")},Fe=s(!1);let ke=s([]);const Ie=s([]);let me=s("");const Ct=!0;let Je=ae({mode:""}),He=s();async function St(){ce.get(`${at}/${e.params._id}/codegen`,{params:Je}).then(c=>{c&&c.results&&c.results.length>0&&(He.value=c.outputLang,Object.keys(c.results[0].json).forEach(P=>{let J={title:P,dataIndex:P,key:P,width:50};ke.value.push(J)}),ke.value.push({title:"action",dataIndex:"action",key:"action"}),Ie.value=c.results.map(P=>(P.script&&Object.assign(P.json,{script:P.script}),P.json)),Fe.value=!0)}).catch(c=>{const P=c.response.data;Za(P)})}const $t=async c=>{Je.mode="all",await St()},xt=c=>{me.value=c.script},At=()=>{Ie.value=[],ke.value=[]};function Pt(c){var P,J,De,_e;switch(c){case"itea.mbt.test.MBTAW":{(P=o.getShowData)==null||P.setPropertiesData();break}case"itea.mbt.test.MBTLink":case"itea.mbt.test.link":{(J=o.getShowData)==null||J.setPropertiesData();break}case"itea.mbt.test.MBTGroup":{(De=o.getShowData)==null||De.setPropertiesData();break}case"itea.mbt.test.MBTSection":{(_e=o.getShowData)==null||_e.setPropertiesData();break}}}return(c,P)=>{const J=he,De=Ut,_e=Ee,Et=lt("VAceEditor"),Qe=pt,we=Gt,Me=Lt,Tt=Nt,Xe=ka,Ot=Pe,Ce=mt,Ye=Le,Ft=lt("close-circle-outlined"),Ze=_t,It=Wt;return g(),F(re,null,[b("main",{class:"joint-app joint-theme-modern",ref_key:"apps",ref:d},[b("div",Il,[b("div",Ml,[n(De,null,{default:_(()=>[b("span",null,[n(J,{onClick:wt,type:"primary",size:"small",style:{"margin-right":"5px"}},{default:_(()=>[z(B(c.$t("common.saveText")),1)]),_:1})]),b("span",null,[n(J,{type:"primary",size:"small",onClick:P[0]||(P[0]=R=>$t(l(e))),style:{"margin-right":"5px"}},{default:_(()=>[z(B(c.$t("layout.multipleTab.preview")),1)]),_:1})]),b("span",null,[n(J,{danger:"",size:"small"},{default:_(()=>[z(B(c.$t("layout.multipleTab.reload")),1)]),_:1})])]),_:1})]),Bl,b("div",jl,[n(J,{type:"primary",onClick:ie},{default:_(()=>[Vl]),_:1})])]),b("div",Rl,[b("div",Ul,null,512),zl,ee(b("div",Ll,[b("ul",Nl,[!l(T)&&!l(h)&&!l(I)&&!l(y)?(g(),F("li",Gl,"\u6837\u5F0F\u4FEE\u6539")):U("",!0),l(T)||l(h)||l(I)||l(y)?(g(),F("li",Wl,"\u6570\u636E\u7F16\u8F91")):U("",!0),ql]),b("div",Kl,[n(Fl,{ref_key:"rightSchemaModal",ref:$,onChange:Pt},null,512)])],512),[[te,l(w)]]),Jl])],512),n(Qe,{visible:Fe.value,"onUpdate:visible":P[2]||(P[2]=R=>Fe.value=R),title:"Preview Modal",onOk:Ke,footer:null,keyboard:!0,"mask-closable":!0,width:"1280",class:"previewModel",onCancel:At},{default:_(()=>[n(_e,{columns:l(ke),"data-source":Ie.value,pagination:{pageSize:5},bordered:"",rowKey:R=>R.id,class:"previewclass"},{bodyCell:_(({column:R,record:ue})=>[R.key=="can_be_automated"?(g(),F("p",Hl,B(ue.can_be_automated),1)):U("",!0),R.key=="is_implemented_automated"?(g(),F("p",Ql,B(ue.is_implemented_automated),1)):U("",!0),R.key=="is_in_project"?(g(),F("p",Xl,B(ue.is_in_project),1)):U("",!0),R.key=="test_steps"?(g(),F("pre",Yl,B(ue.test_steps),1)):U("",!0),R.key=="expected_results"?(g(),F("pre",Zl,B(ue.expected_results),1)):U("",!0),R.key=="action"?(g(),q(J,{key:5,type:"link",onClick:H=>xt(ue)},{default:_(()=>[en]),_:2},1032,["onClick"])):U("",!0)]),_:1},8,["columns","data-source","rowKey"]),l(me)?(g(),q(Et,{key:0,value:l(me),"onUpdate:value":P[1]||(P[1]=R=>Y(me)?me.value=R:me=R),class:"ace-result",wrap:Ct,readonly:!0,lang:l(He),theme:"sqlserver",options:{useWorker:!0}},null,8,["value","lang"])):U("",!0)]),_:1},8,["visible"]),n(Qe,{visible:l(p),"onUpdate:visible":P[7]||(P[7]=R=>Y(p)?p.value=R:p=R),title:"Please select a template first",onOk:Ke,width:1e3,"ok-text":"save"},{default:_(()=>[b("div",tn,[n(It,{activeKey:f.value,"onUpdate:activeKey":P[6]||(P[6]=R=>f.value=R),type:"card"},{default:_(()=>[n(we,{key:"1",tab:"Attributes","force-render":"",style:{height:"550px"}},{default:_(()=>[b("div",an,[n(l(pe),{modelValue:l(v),"onUpdate:modelValue":P[3]||(P[3]=R=>Y(v)?v.value=R:v=R),schema:W.value,formFooter:{show:!1}},null,8,["modelValue","schema"])])]),_:1}),n(we,{key:"2",tab:"Meta",style:{height:"550px",position:"relative"}},{default:_(()=>[n(Fa,{isFormVisible:D.value,metatemplatedetailtableData:l(C),schema:l(V),metaformProps:K,metatemplatecolumns:N},null,8,["isFormVisible","metatemplatedetailtableData","schema","metatemplatecolumns"])]),_:1}),n(we,{key:"3",tab:"Data Pool",style:{height:"550px",position:"relative"}},{default:_(()=>[n(Tt,{value:A.value,"onUpdate:value":P[4]||(P[4]=R=>A.value=R),onChange:P[5]||(P[5]=R=>X(A.value))},{default:_(()=>[n(Me,{value:1},{default:_(()=>[ln]),_:1}),n(Me,{value:2},{default:_(()=>[nn]),_:1}),n(Me,{value:3},{default:_(()=>[sn]),_:1})]),_:1},8,["value"]),(g(),q(tt,null,[A.value===1?(g(),q(Xe,{key:0,tableColumns:l(i),templateCategory:M.value,tableData:l(x),onUpdate:Te,onClear:ge},null,8,["tableColumns","templateCategory","tableData"])):U("",!0)],1024)),(g(),q(tt,null,[A.value===2?(g(),q(Xe,{key:0,tableColumns:l(G),templateCategory:M.value,tableData:l(L),onUpdate:ye},null,8,["tableColumns","templateCategory","tableData"])):U("",!0)],1024)),A.value===3?(g(),q(Qa,{key:0,tableColumns:l(S),tableData:l(r),onUpdate:gt},null,8,["tableColumns","tableData"])):U("",!0)]),_:1}),n(we,{key:"4",tab:"Resources",style:{height:"550px"}},{default:_(()=>[n(J,{class:"editable-add-btn",style:{"margin-bottom":"8px"},onClick:yt},{default:_(()=>[on]),_:1}),n(_e,{bordered:"","data-source":k.value,columns:j},{bodyCell:_(({column:R,text:ue,record:H})=>[["alias","class","resourcetype"].includes(R.dataIndex)?(g(),F("div",un,[m[H.key]?(g(),F("div",rn,[n(Ot,{value:m[H.key][R.dataIndex],"onUpdate:value":se=>m[H.key][R.dataIndex]=se,onPressEnter:se=>Oe(H.key)},null,8,["value","onUpdate:value","onPressEnter"]),n(l(rt),{class:"editable-cell-icon-check",onClick:se=>Oe(H.key)},null,8,["onClick"])])):(g(),F("div",cn,[z(B(ue||" ")+" ",1),n(l(fe),{class:"editable-cell-icon",onClick:se=>We(H.key)},null,8,["onClick"])]))])):R.dataIndex==="operation"?(g(),F("div",pn,[m[H.key]?(g(),F("span",dn,[n(Ce,{placement:"bottom"},{title:_(()=>[b("span",null,B(c.$t("common.saveText")),1)]),default:_(()=>[n(l(zt),{onClick:se=>Oe(H.key),class:"icon--success-btn"},null,8,["onClick"])]),_:2},1024),n(Ye,{type:"vertical"}),n(Ze,{title:c.$t("component.message.sureCancel"),onConfirm:se=>qe(H.key)},{default:_(()=>[n(Ce,{placement:"bottom"},{title:_(()=>[b("span",null,B(c.$t("common.cancelText")),1)]),default:_(()=>[n(Ft,{onClick:se=>qe(H.key),class:"icon--err-btn"},null,8,["onClick"])]),_:2},1024)]),_:2},1032,["title","onConfirm"])])):(g(),F("span",mn,[n(Ce,{placement:"bottom"},{title:_(()=>[b("span",null,B(c.$t("common.editText")),1)]),default:_(()=>[n(l(fe),{onClick:se=>We(H.key),class:"icon--primary-btn"},null,8,["onClick"])]),_:2},1024)])),n(Ye,{type:"vertical"}),b("span",null,[k.value.length?(g(),q(Ze,{key:0,title:"Sure to delete?",onConfirm:se=>bt(H.key)},{default:_(()=>[n(Ce,{placement:"bottom"},{title:_(()=>[b("span",null,B(c.$t("common.delText")),1)]),default:_(()=>[n(l(xe),{class:"icon--primary-btn"})]),_:1})]),_:2},1032,["onConfirm"])):U("",!0)])])):U("",!0)]),_:1},8,["data-source"]),n(J,{type:"primary",onClick:kt},{default:_(()=>[z(B(c.$t("common.saveText")),1)]),_:1})]),_:1})]),_:1},8,["activeKey"])])]),_:1},8,["visible"])],64)}}});export{Un as default};
