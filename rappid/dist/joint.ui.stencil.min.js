/*! JointJS+ v3.6.3 - HTML5 Diagramming Framework

Copyright (c) 2022 client IO

 2022-12-09 


This Source Code Form is subject to the terms of the JointJS+ License
, v. 2.0. If a copy of the JointJS+ License was not distributed with this
file, You can obtain one at http://jointjs.com/license/rappid_v2.txt
 or from the JointJS+ archive as was distributed by client IO. See the LICENSE file.*/


this.joint=this.joint||{},function(G,h,_){"use strict";h=h&&Object.prototype.hasOwnProperty.call(h,"default")?h.default:h;var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function N(t,e){return t(e={exports:{}},e.exports),e.exports}function k(t){return t&&t.Math==Math&&t}function c(t){try{return!!t()}catch(t){return!0}}function F(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}function B(t){return st?ht(t):function(){return ut.apply(t,arguments)}}function s(t){return ft(pt(t),8,-1)}function a(t){if("Function"===s(t))return B(t)}function $(t){if(mt(t))throw yt("Can't call method on "+t);return t}function z(t){return vt($(t))}function n(t,e){return arguments.length<2?(n=y[t],u(n)?n:void 0):y[t]&&y[t][e];var n}function V(t){return Gt($(t))}function X(t){return"Symbol("+(void 0===t?"":t)+")_"+Bt(++kt+Ft,36)}function e(t){var e;return x($t,t)&&(St||"string"==typeof $t[t])||(e="Symbol."+t,St&&x(zt,t)?$t[t]=zt[t]:$t[t]=(Pt&&Vt?Vt:Xt)(e)),$t[t]}function Y(t){return t=Ut(t,"string"),Ct(t)?t:t+""}function W(t){return fe[t]||(fe[t]=X(t))}function m(t,e,n,i){var r=(i=i||{}).enumerable,o=void 0!==i.name?i.name:e;if(u(n)&&be(n,o,i),i.global)r?t[e]=n:It(e,n);else{try{i.unsafe?t[e]&&(r=!0):delete t[e]}catch(t){}r?t[e]=n:S.f(t,e,{value:n,enumerable:!1,configurable:!i.nonConfigurable,writable:!i.nonWritable})}return t}function U(t){return De(t.length)}function H(a){return function(t,e,n){var i,r=z(t),o=U(r),s=function(t,e){t=Se(t);return t<0?Pe(t+e,0):Te(t,e)}(n,o);if(a&&e!=e){for(;s<o;)if((i=r[s++])!=i)return!0}else for(;s<o;s++)if((a||s in r)&&r[s]===e)return a||s||0;return!a&&-1}}function q(t,e){var n,i=z(t),r=0,o=[];for(n in i)!x(de,n)&&x(i,n)&&Oe(o,n);for(;e.length>r;)!x(i,n=e[r++])||~_e(o,n)||Oe(o,n);return o}function K(t,e){return(t=ke[Ne(t)])==Be||t!=Fe&&(u(e)?c(e):!!e)}function i(t,e){var n,i,r,o=t.target,s=t.global,a=t.stat,c=s?y:a?y[o]||It(o,{}):(y[o]||{}).prototype;if(c)for(n in e){if(i=e[n],r=t.dontCallGetSet?(r=ze(c,n))&&r.value:c[n],!$e(s?n:o+(a?".":"#")+n,t.forced)&&void 0!==r){if(typeof i==typeof r)continue;for(var l=i,u=r,h=v=g=d=f=p=void 0,p=Me(u),f=S.f,d=Qt.f,g=0;g<p.length;g++){var v=p[g];x(l,v)||h&&x(h,v)||f(l,v,d(u,v))}}(t.sham||r&&r.sham)&&ce(i,"sham",!0),m(c,n,i,t)}}function Z(t,e){return w(t),void 0===e?t:st?He(t,e):function(){return t.apply(e,arguments)}}function J(){}function Q(t){if(!u(t))return!1;try{return en(J,tn,t),!0}catch(t){return!1}}function tt(t){if(!u(t))return!1;switch(Qe(t)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return on||!!rn(nn,pe(t))}catch(t){return!0}}function et(t,e){return new(ln(t))(0===e?0:e)}function r(p){var f=1==p,d=2==p,g=3==p,v=4==p,m=6==p,y=7==p,b=5==p||m;return function(t,e,n,i){for(var r,o,s=V(t),a=vt(s),c=Z(e,n),l=U(a),u=0,e=i||et,h=f?e(t,l):d||y?e(t,0):void 0;u<l;u++)if((b||u in a)&&(o=c(r=a[u],u,s),p))if(f)h[u]=o;else if(o)switch(p){case 3:return!0;case 5:return r;case 6:return u;case 2:un(h,r)}else switch(p){case 4:return!1;case 7:un(h,r)}return m?-1:g||v?v:h}}function nt(t,e){var n=[][t];return!!n&&c(function(){n.call(null,e||function(){return 1},1)})}var it,rt,o,ot,y=k("object"==typeof globalThis&&globalThis)||k("object"==typeof window&&window)||k("object"==typeof self&&self)||k("object"==typeof t&&t)||function(){return this}()||Function("return this")(),l=!c(function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}),st=!c(function(){var t=function(){}.bind();return"function"!=typeof t||t.hasOwnProperty("prototype")}),at=Function.prototype.call,b=st?at.bind(at):function(){return at.apply(at,arguments)},t={}.propertyIsEnumerable,ct=Object.getOwnPropertyDescriptor,lt={f:ct&&!t.call({1:2},1)?function(t){t=ct(this,t);return!!t&&t.enumerable}:t},t=Function.prototype,ut=t.call,ht=st&&t.bind.bind(ut,ut),pt=B({}.toString),ft=B("".slice),dt=Object,gt=a("".split),vt=c(function(){return!dt("z").propertyIsEnumerable(0)})?function(t){return"String"==s(t)?gt(t,""):dt(t)}:dt,mt=function(t){return null==t},yt=TypeError,t="object"==typeof document&&document.all,t={all:t,IS_HTMLDDA:void 0===t&&void 0!==t},bt=t.all,u=t.IS_HTMLDDA?function(t){return"function"==typeof t||t===bt}:function(t){return"function"==typeof t},wt=t.all,p=t.IS_HTMLDDA?function(t){return"object"==typeof t?null!==t:u(t)||t===wt}:function(t){return"object"==typeof t?null!==t:u(t)},xt=a({}.isPrototypeOf),t=n("navigator","userAgent")||"",f=y.process,d=y.Deno,f=f&&f.versions||d&&d.version,d=f&&f.v8,Et=v=!(v=d?0<(g=d.split("."))[0]&&g[0]<4?1:+(g[0]+g[1]):v)&&t&&(!(g=t.match(/Edge\/(\d+)/))||74<=g[1])&&(g=t.match(/Chrome\/(\d+)/))?+g[1]:v,St=!!Object.getOwnPropertySymbols&&!c(function(){var t=Symbol();return!String(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&Et&&Et<41}),Pt=St&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,Tt=Object,Ct=Pt?function(t){return"symbol"==typeof t}:function(t){var e=n("Symbol");return u(e)&&xt(e.prototype,Tt(t))},Dt=String,_t=function(t){try{return Dt(t)}catch(t){return"Object"}},Ot=TypeError,w=function(t){if(u(t))return t;throw Ot(_t(t)+" is not a function")},Lt=function(t,e){t=t[e];return mt(t)?void 0:w(t)},At=TypeError,jt=function(t,e){var n,i;if("string"===e&&u(n=t.toString)&&!p(i=b(n,t)))return i;if(u(n=t.valueOf)&&!p(i=b(n,t)))return i;if("string"!==e&&u(n=t.toString)&&!p(i=b(n,t)))return i;throw At("Can't convert object to primitive value")},Rt=Object.defineProperty,It=function(e,n){try{Rt(y,e,{value:n,configurable:!0,writable:!0})}catch(t){y[e]=n}return n},f="__core-js_shared__",Mt=y[f]||It(f,{}),d=N(function(t){(t.exports=function(t,e){return Mt[t]||(Mt[t]=void 0!==e?e:{})})("versions",[]).push({version:"3.25.5",mode:"global",copyright:"© 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.25.5/LICENSE",source:"https://github.com/zloirock/core-js"})}),Gt=Object,Nt=a({}.hasOwnProperty),x=Object.hasOwn||function(t,e){return Nt(V(t),e)},kt=0,Ft=Math.random(),Bt=a(1..toString),$t=d("wks"),zt=y.Symbol,Vt=zt&&zt.for,Xt=Pt?zt:zt&&zt.withoutSetter||X,Yt=TypeError,Wt=e("toPrimitive"),Ut=function(t,e){if(!p(t)||Ct(t))return t;var n=Lt(t,Wt);if(n){if(n=b(n,t,e=void 0===e?"default":e),!p(n)||Ct(n))return n;throw Yt("Can't convert object to primitive value")}return jt(t,e=void 0===e?"number":e)},Ht=y.document,qt=p(Ht)&&p(Ht.createElement),Kt=function(t){return qt?Ht.createElement(t):{}},Zt=!l&&!c(function(){return 7!=Object.defineProperty(Kt("div"),"a",{get:function(){return 7}}).a}),Jt=Object.getOwnPropertyDescriptor,Qt={f:l?Jt:function(t,e){if(t=z(t),e=Y(e),Zt)try{return Jt(t,e)}catch(t){}if(x(t,e))return F(!b(lt.f,t,e),t[e])}},g=l&&c(function(){return 42!=Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype}),te=String,ee=TypeError,E=function(t){if(p(t))return t;throw ee(te(t)+" is not an object")},ne=TypeError,ie=Object.defineProperty,re=Object.getOwnPropertyDescriptor,oe="enumerable",se="configurable",ae="writable",S={f:l?g?function(t,e,n){var i;return E(t),e=Y(e),E(n),"function"==typeof t&&"prototype"===e&&"value"in n&&ae in n&&!n[ae]&&((i=re(t,e))&&i[ae]&&(t[e]=n.value,n={configurable:(se in n?n:i)[se],enumerable:(oe in n?n:i)[oe],writable:!1})),ie(t,e,n)}:ie:function(t,e,n){if(E(t),e=Y(e),E(n),Zt)try{return ie(t,e,n)}catch(t){}if("get"in n||"set"in n)throw ne("Accessors not supported");return"value"in n&&(t[e]=n.value),t}},ce=l?function(t,e,n){return S.f(t,e,F(1,n))}:function(t,e,n){return t[e]=n,t},v=Function.prototype,f=l&&Object.getOwnPropertyDescriptor,le=x(v,"name"),ue={EXISTS:le,PROPER:le&&"something"===function(){}.name,CONFIGURABLE:le&&(!l||f(v,"name").configurable)},he=a(Function.toString),pe=(u(Mt.inspectSource)||(Mt.inspectSource=function(t){return he(t)}),Mt.inspectSource),le=y.WeakMap,f=u(le)&&/native code/.test(String(le)),fe=d("keys"),de={},ge="Object already initialized",ve=y.TypeError,v=y.WeakMap,me=f||Mt.state?((o=Mt.state||(Mt.state=new v)).get=o.get,o.has=o.has,o.set=o.set,it=function(t,e){if(o.has(t))throw ve(ge);return e.facade=t,o.set(t,e),e},rt=function(t){return o.get(t)||{}},function(t){return o.has(t)}):(ot=W("state"),de[ot]=!0,it=function(t,e){if(x(t,ot))throw ve(ge);return e.facade=t,ce(t,ot,e),e},rt=function(t){return x(t,ot)?t[ot]:{}},function(t){return x(t,ot)}),ye={set:it,get:rt,has:me,enforce:function(t){return me(t)?rt(t):it(t,{})},getterFor:function(e){return function(t){if(p(t)&&(t=rt(t)).type===e)return t;throw ve("Incompatible receiver, "+e+" required")}}},be=N(function(t){var i=ue.CONFIGURABLE,r=ye.enforce,e=ye.get,o=Object.defineProperty,s=l&&!c(function(){return 8!==o(function(){},"length",{value:8}).length}),a=String(String).split("String"),t=t.exports=function(t,e,n){"Symbol("===String(e).slice(0,7)&&(e="["+String(e).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),n&&n.getter&&(e="get "+e),n&&n.setter&&(e="set "+e),(!x(t,"name")||i&&t.name!==e)&&(l?o(t,"name",{value:e,configurable:!0}):t.name=e),s&&n&&x(n,"arity")&&t.length!==n.arity&&o(t,"length",{value:n.arity});try{n&&x(n,"constructor")&&n.constructor?l&&o(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch(t){}n=r(t);return x(n,"source")||(n.source=a.join("string"==typeof e?e:"")),t};Function.prototype.toString=t(function(){return u(this)&&e(this).source||pe(this)},"toString")}),we=Math.ceil,xe=Math.floor,Ee=Math.trunc||function(t){t=+t;return(0<t?xe:we)(t)},Se=function(t){t=+t;return t!=t||0==t?0:Ee(t)},Pe=Math.max,Te=Math.min,Ce=Math.min,De=function(t){return 0<t?Ce(Se(t),9007199254740991):0},le={includes:H(!0),indexOf:H(!1)},_e=le.indexOf,Oe=a([].push),Le=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],Ae=Le.concat("length","prototype"),je={f:Object.getOwnPropertyNames||function(t){return q(t,Ae)}},Re={f:Object.getOwnPropertySymbols},Ie=a([].concat),Me=n("Reflect","ownKeys")||function(t){var e=je.f(E(t)),n=Re.f;return n?Ie(e,n(t)):e},Ge=/#|\.prototype\./,Ne=K.normalize=function(t){return String(t).replace(Ge,".").toLowerCase()},ke=K.data={},Fe=K.NATIVE="N",Be=K.POLYFILL="P",$e=K,ze=Qt.f,Ve=a([].slice),Xe=Function,Ye=a([].concat),We=a([].join),Ue={},f=st?Xe.bind:function(s){var a=w(this),t=a.prototype,c=Ve(arguments,1),l=function(){var t=Ye(c,Ve(arguments));if(this instanceof l){var e=a,n=t.length,i=t;if(!x(Ue,n)){for(var r=[],o=0;o<n;o++)r[o]="a["+o+"]";Ue[n]=Xe("C,a","return new C("+We(r,",")+")")}return Ue[n](e,i)}return a.apply(s,t)};return p(t)&&(l.prototype=t),l},He=(i({target:"Function",proto:!0,forced:Function.bind!==f},{bind:f}),a(a.bind)),qe=Array.isArray||function(t){return"Array"==s(t)},v={},f=(v[e("toStringTag")]="z","[object z]"===String(v)),Ke=e("toStringTag"),Ze=Object,Je="Arguments"==s(function(){return arguments}()),Qe=f?s:function(t){var e;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(e=function(t,e){try{return t[e]}catch(t){}}(t=Ze(t),Ke))?e:Je?s(t):"Object"==(e=s(t))&&u(t.callee)?"Arguments":e},tn=[],en=n("Reflect","construct"),nn=/^\s*(?:class|function)\b/,rn=a(nn.exec),on=!nn.exec(J),sn=(tt.sham=!0,!en||c(function(){var t;return Q(Q.call)||!Q(Object)||!Q(function(){t=!0})||t})?tt:Q),an=e("species"),cn=Array,ln=function(t){var e;return qe(t)&&(e=t.constructor,(sn(e)&&(e===cn||qe(e.prototype))||p(e)&&null===(e=e[an]))&&(e=void 0)),void 0===e?cn:e},un=a([].push),v={forEach:r(0),map:r(1),filter:r(2),some:r(3),every:r(4),find:r(5),findIndex:r(6),filterReject:r(7)},hn=v.forEach,pn=nt("forEach")?[].forEach:function(t){return hn(this,t,1<arguments.length?arguments[1]:void 0)};i({target:"Array",proto:!0,forced:[].forEach!=pn},{forEach:pn});function fn(e){if(e&&e.forEach!==pn)try{ce(e,"forEach",pn)}catch(t){e.forEach=pn}}f||m(Object.prototype,"toString",f?{}.toString:function(){return"[object "+Qe(this)+"]"},{unsafe:!0});var dn,gn={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},f=Kt("span").classList,f=f&&f.constructor&&f.constructor.prototype,f=f===Object.prototype?void 0:f;for(dn in gn)gn[dn]&&fn(y[dn]&&y[dn].prototype);fn(f);function vn(t){if("Symbol"===Qe(t))throw TypeError("Cannot convert a Symbol value to a string");return jn(t)}function mn(){var t=E(this),e="";return t.hasIndices&&(e+="d"),t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.dotAll&&(e+="s"),t.unicode&&(e+="u"),t.unicodeSets&&(e+="v"),t.sticky&&(e+="y"),e}function yn(){}function bn(t){t.write(Fn("")),t.close();var e=t.parentWindow.Object;return t=null,e}function wn(t,e){var n,t=E(t).constructor;if(void 0===t||mt(n=E(t)[di]))return e;if(sn(t=n))return t;throw fi(_t(t)+" is not a constructor")}function xn(t,e){if(t<e)throw yi("Not enough arguments");return t}var En,Sn,Pn,P,Tn,Cn,Dn,_n=Object.keys||function(t){return q(t,Le)},f=(i({target:"Object",stat:!0,forced:c(function(){_n(1)})},{keys:function(t){return _n(V(t))}}),ue.EXISTS),T=S.f,C=Function.prototype,On=a(C.toString),Ln=/function\b(?:\s|\/\*[\S\s]*?\*\/|\/\/[^\n\r]*[\n\r]+)*([^\s(/]*)/,An=a(Ln.exec),jn=(l&&!f&&T(C,"name",{configurable:!0,get:function(){try{return An(Ln,On(this))[1]}catch(t){return""}}}),String),Rn=y.RegExp,f=c(function(){var t=Rn("a","y");return t.lastIndex=2,null!=t.exec("abcd")}),T=f||c(function(){return!Rn("a","y").sticky}),C={BROKEN_CARET:f||c(function(){var t=Rn("^r","gy");return t.lastIndex=2,null!=t.exec("str")}),MISSED_STICKY:T,UNSUPPORTED_Y:f},In={f:l&&!g?Object.defineProperties:function(t,e){E(t);for(var n,i=z(e),r=_n(e),o=r.length,s=0;s<o;)S.f(t,n=r[s++],i[n]);return t}},Mn=n("document","documentElement"),Gn="prototype",Nn="script",kn=W("IE_PROTO"),Fn=function(t){return"<"+Nn+">"+t+"</"+Nn+">"},Bn=function(){try{En=new ActiveXObject("htmlfile")}catch(t){}Bn="undefined"==typeof document||document.domain&&En?bn(En):(t=Kt("iframe"),e="java"+Nn+":",t.style.display="none",Mn.appendChild(t),t.src=String(e),(e=t.contentWindow.document).open(),e.write(Fn("document.F=Object")),e.close(),e.F);for(var t,e,n=Le.length;n--;)delete Bn[Gn][Le[n]];return Bn()},$n=(de[kn]=!0,Object.create||function(t,e){var n;return null!==t?(yn[Gn]=E(t),n=new yn,yn[Gn]=null,n[kn]=t):n=Bn(),void 0===e?n:In.f(n,e)}),zn=y.RegExp,T=c(function(){var t=zn(".","s");return!t.dotAll||!t.exec("\n")||"s"!==t.flags}),Vn=y.RegExp,f=c(function(){var t=Vn("(?<a>b)","g");return"b"!==t.exec("b").groups.a||"bc"!=="b".replace(t,"$<a>c")}),Xn=ye.get,Yn=d("native-string-replace",String.prototype.replace),Wn=RegExp.prototype.exec,Un=Wn,Hn=a("".charAt),qn=a("".indexOf),Kn=a("".replace),Zn=a("".slice),Jn=(g=/b*/g,b(Wn,d=/a/,"a"),b(Wn,g,"a"),0!==d.lastIndex||0!==g.lastIndex),Qn=C.BROKEN_CARET,ti=void 0!==/()??/.exec("")[1],ei=Un=Jn||ti||Qn||T||f?function(t){var e,n,i,r,o,s,a=this,c=Xn(a),t=vn(t),l=c.raw;if(l)return l.lastIndex=a.lastIndex,h=b(Un,l,t),a.lastIndex=l.lastIndex,h;var u=c.groups,l=Qn&&a.sticky,h=b(mn,a),c=a.source,p=0,f=t;if(l&&(h=Kn(h,"y",""),-1===qn(h,"g")&&(h+="g"),f=Zn(t,a.lastIndex),0<a.lastIndex&&(!a.multiline||a.multiline&&"\n"!==Hn(t,a.lastIndex-1))&&(c="(?: "+c+")",f=" "+f,p++),e=new RegExp("^(?:"+c+")",h)),ti&&(e=new RegExp("^"+c+"$(?!\\s)",h)),Jn&&(n=a.lastIndex),i=b(Wn,l?e:a,f),l?i?(i.input=Zn(i.input,p),i[0]=Zn(i[0],p),i.index=a.lastIndex,a.lastIndex+=i[0].length):a.lastIndex=0:Jn&&i&&(a.lastIndex=a.global?i.index+i[0].length:n),ti&&i&&1<i.length&&b(Yn,i[0],e,function(){for(r=1;r<arguments.length-2;r++)void 0===arguments[r]&&(i[r]=void 0)}),i&&u)for(i.groups=o=$n(null),r=0;r<u.length;r++)o[(s=u[r])[0]]=i[s[1]];return i}:Un,ni=(i({target:"RegExp",proto:!0,forced:/./.exec!==ei},{exec:ei}),e("species")),ii=RegExp.prototype,ri=Object.is||function(t,e){return t===e?0!==t||1/t==1/e:t!=t&&e!=e},oi=TypeError,T=(d=function(i,r,o){return[function(t){var e=$(this),n=mt(t)?void 0:Lt(t,i);return n?b(n,t,e):new RegExp(t)[i](vn(e))},function(t){var e=E(this),t=vn(t),n=o(r,e,t);return n.done?n.value:(n=e.lastIndex,ri(n,0)||(e.lastIndex=0),t=function(t,e){var n=t.exec;if(u(n))return null!==(n=b(n,t,e))&&E(n),n;if("RegExp"===s(t))return b(ei,t,e);throw oi("RegExp#exec called on incompatible receiver")}(e,t),ri(e.lastIndex,n)||(e.lastIndex=n),null===t?-1:t.index)}]},P=e(Sn="search"),Tn=!c(function(){var t={};return t[P]=function(){return 7},7!=""[Sn](t)}),C=Tn&&!c(function(){var t=!1,e=/a/;return"split"===Sn&&((e={constructor:{}}).constructor[ni]=function(){return e},e.flags="",e[P]=/./[P]),e.exec=function(){return t=!0,null},e[P](""),!t}),Tn&&C&&!D||(Pn=a(/./[P]),C=d(P,""[Sn],function(t,e,n,i,r){var t=a(t),o=e.exec;return o===ei||o===ii.exec?Tn&&!r?{done:!0,value:Pn(e,n,i)}:{done:!0,value:t(n,e,i)}:{done:!1}}),m(String.prototype,Sn,C[0]),m(ii,P,C[1])),hi&&ce(ii[P],"sham",!0),S.f),f=e("unscopables"),D=Array.prototype,si=(null==D[f]&&T(D,f,{configurable:!0,value:$n(null)}),v.find),d="find",ai=!0,O=(d in[]&&Array(1)[d](function(){ai=!1}),i({target:"Array",proto:!0,forced:ai},{find:function(t){return si(this,t,1<arguments.length?arguments[1]:void 0)}}),i({target:"Array",stat:D[f][d]=!0},{isArray:qe}),"process"==s(y.process)),ci=String,li=TypeError,ui=Object.setPrototypeOf||("__proto__"in{}?function(){var n,i=!1,t={};try{(n=a(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))(t,[]),i=t instanceof Array}catch(t){}return function(t,e){return E(t),function(t){if("object"==typeof t||u(t))return;throw li("Can't set "+ci(t)+" as a prototype")}(e),i?n(t,e):t.__proto__=e,t}}():void 0),C=S.f,hi=e("toStringTag"),T=e("species"),pi=TypeError,fi=TypeError,di=e("species"),D=Function.prototype,gi=D.apply,vi=D.call,mi="object"==typeof Reflect&&Reflect.apply||(st?vi.bind(gi):function(){return vi.apply(gi,arguments)}),yi=TypeError,f=/(?:ipad|iphone|ipod).*applewebkit/i.test(t),d=y.setImmediate,D=y.clearImmediate,bi=y.process,wi=y.Dispatch,xi=y.Function,L=y.MessageChannel,Ei=y.String,Si=0,Pi={},Ti="onreadystatechange";try{Cn=y.location}catch(t){}function Ci(t){return function(){zi(t)}}function Di(t){zi(t.data)}function _i(t){y.postMessage(Ei(t),Cn.protocol+"//"+Cn.host)}function Oi(){this.head=null,this.tail=null}function Li(t){var n,i;this.promise=new t(function(t,e){if(void 0!==n||void 0!==i)throw Qi("Bad Promise constructor");n=t,i=e}),this.resolve=w(n),this.reject=w(i)}function Ai(t,e){var n,i,r,o,s=e.value,a=e.state==vr,c=a?t.ok:t.fail,l=t.resolve,u=t.reject,h=t.domain;try{c?(a||(e.rejection===br&&(o=e,b(er,y,function(){var t=o.facade;O?ur.emit("rejectionHandled",t):Er(gr,t,o.value)})),e.rejection=yr),!0===c?n=s:(h&&h.enter(),n=c(s),h&&(h.exit(),r=!0)),n===t.promise?u(cr("Promise-chain cycle")):(i=wr(n))?b(i,n,l,u):l(n)):u(s)}catch(t){h&&!r&&h.exit(),u(t)}}var ji,Ri,Ii,Mi,Gi,Ni,ki,Fi,Bi,$i,zi=function(t){var e;x(Pi,t)&&(e=Pi[t],delete Pi[t],e())},L=(d&&D||(d=function(t){xn(arguments.length,1);var e=u(t)?t:xi(t),n=Ve(arguments,1);return Pi[++Si]=function(){mi(e,void 0,n)},Dn(Si),Si},D=function(t){delete Pi[t]},O?Dn=function(t){bi.nextTick(Ci(t))}:wi&&wi.now?Dn=function(t){wi.now(Ci(t))}:L&&!f?(A=(L=new L).port2,L.port1.onmessage=Di,Dn=Z(A.postMessage,A)):y.addEventListener&&u(y.postMessage)&&!y.importScripts&&Cn&&"file:"!==Cn.protocol&&!c(_i)?(Dn=_i,y.addEventListener("message",Di,!1)):Dn=Ti in Kt("script")?function(t){Mn.appendChild(Kt("script"))[Ti]=function(){Mn.removeChild(this),zi(t)}}:function(t){setTimeout(Ci(t),0)}),{set:d,clear:D}),A=/ipad|iphone|ipod/i.test(t)&&void 0!==y.Pebble,d=/web0s(?!.*chrome)/i.test(t),D=Qt.f,Vi=L.set,j=y.MutationObserver||y.WebKitMutationObserver,R=y.document,Xi=y.process,I=y.Promise,D=D(y,"queueMicrotask"),D=D&&D.value,Yi=(D||(ji=function(){var t,e;for(O&&(t=Xi.domain)&&t.exit();Ri;){e=Ri.fn,Ri=Ri.next;try{e()}catch(t){throw Ri?Mi():Ii=void 0,t}}Ii=void 0,t&&t.enter()},Mi=f||O||d||!j||!R?!A&&I&&I.resolve?((f=I.resolve(void 0)).constructor=I,ki=Z(f.then,f),function(){ki(ji)}):O?function(){Xi.nextTick(ji)}:(Vi=Z(Vi,y),function(){Vi(ji)}):(Gi=!0,Ni=R.createTextNode(""),new j(ji).observe(Ni,{characterData:!0}),function(){Ni.data=Gi=!Gi})),D||function(t){t={fn:t,next:void 0};Ii&&(Ii.next=t),Ri||(Ri=t,Mi()),Ii=t}),Wi=function(t){try{return{error:!1,value:t()}}catch(t){return{error:!0,value:t}}},Ui=(Oi.prototype={add:function(t){t={item:t,next:null};this.head?this.tail.next=t:this.head=t,this.tail=t},get:function(){var t=this.head;if(t)return this.head=t.next,this.tail===t&&(this.tail=null),t.item}},Oi),M=y.Promise,Hi="object"==typeof Deno&&Deno&&"object"==typeof Deno.version,qi=!Hi&&!O&&"object"==typeof window&&"object"==typeof document,Ki=(M&&M.prototype,e("species")),Zi=!1,Ji=u(y.PromiseRejectionEvent),d={CONSTRUCTOR:$e("Promise",function(){var t=pe(M),e=t!==String(M);if(!e&&66===Et)return!0;if(!Et||Et<51||!/native code/.test(t)){var t=new M(function(t){t(1)}),n=function(t){t(function(){},function(){})};if((t.constructor={})[Ki]=n,!(Zi=t.then(function(){})instanceof n))return!0}return!e&&(qi||Hi)&&!Ji}),REJECTION_EVENT:Ji,SUBCLASSING:Zi},Qi=TypeError,tr={f:function(t){return new Li(t)}},er=L.set,nr="Promise",A=d.CONSTRUCTOR,ir=d.REJECTION_EVENT,I=d.SUBCLASSING,rr=ye.getterFor(nr),or=ye.set,f=M&&M.prototype,sr=M,ar=f,cr=y.TypeError,lr=y.document,ur=y.process,hr=tr.f,pr=hr,fr=!!(lr&&lr.createEvent&&y.dispatchEvent),dr="unhandledrejection",gr="rejectionhandled",vr=1,mr=2,yr=1,br=2,wr=function(t){var e;return!(!p(t)||!u(e=t.then))&&e},xr=function(n,r){n.notified||(n.notified=!0,Yi(function(){for(var t,i,e=n.reactions;t=e.get();)Ai(t,n);n.notified=!1,r&&!n.rejection&&(i=n,b(er,y,function(){var t=i.facade,e=i.value,n=Sr(i);if(n&&(n=Wi(function(){O?ur.emit("unhandledRejection",e,t):Er(dr,t,e)}),i.rejection=O||Sr(i)?br:yr,n.error))throw n.value}))}))},Er=function(t,e,n){var i;fr?((i=lr.createEvent("Event")).promise=e,i.reason=n,i.initEvent(t,!1,!0),y.dispatchEvent(i)):i={promise:e,reason:n},!ir&&(e=y["on"+t])?e(i):t===dr&&function(t,e){var n=y.console;n&&n.error&&(1==arguments.length?n.error(t):n.error(t,e))}("Unhandled promise rejection",n)},Sr=function(t){return t.rejection!==yr&&!t.parent},Pr=function(e,n,i){return function(t){e(n,t,i)}},Tr=function(t,e,n){t.done||(t.done=!0,(t=n?n:t).value=e,t.state=mr,xr(t,!0))},Cr=function(n,t,e){if(!n.done){n.done=!0,e&&(n=e);try{if(n.facade===t)throw cr("Promise can't be resolved itself");var i=wr(t);i?Yi(function(){var e={done:!1};try{b(i,t,Pr(Cr,e,n),Pr(Tr,e,n))}catch(t){Tr(e,t,n)}}):(n.value=t,n.state=vr,xr(n,!1))}catch(t){Tr({done:!1},t,n)}}};if(A&&(ar=(sr=function(t){!function(t,e){if(xt(e,t))return;throw pi("Incorrect invocation")}(this,ar),w(t),b(Fi,this);var e=rr(this);try{t(Pr(Cr,e),Pr(Tr,e))}catch(t){Tr(e,t)}}).prototype,(Fi=function(t){or(this,{type:nr,done:!1,notified:!1,parent:!1,reactions:new Ui,rejection:!1,state:0,value:void 0})}).prototype=m(ar,"then",function(t,e){var n=rr(this),i=hr(wn(this,sr));return n.parent=!0,i.ok=!u(t)||t,i.fail=u(e)&&e,i.domain=O?ur.domain:void 0,0==n.state?n.reactions.add(i):Yi(function(){Ai(i,n)}),i.promise}),Bi=function(){var t=new Fi,e=rr(t);this.promise=t,this.resolve=Pr(Cr,e),this.reject=Pr(Tr,e)},tr.f=hr=function(t){return t===sr||void 0===t?new Bi:pr(t)},u(M)&&f!==Object.prototype)){$i=f.then,I||m(f,"then",function(t,e){var n=this;return new sr(function(t,e){b($i,n,t,e)}).then(t,e)},{unsafe:!0});try{delete f.constructor}catch(t){}ui&&ui(f,ar)}i({global:!0,constructor:!0,wrap:!0,forced:A},{Promise:sr}),j=!(R=nr),(D=(D=sr)&&!j?D.prototype:D)&&!x(D,hi)&&C(D,hi,{configurable:!0,value:R}),L=n(L=nr),I=S.f,l&&L&&!L[T]&&I(L,T,{configurable:!0,get:function(){return this}});function Dr(t,e,n){var i,r;E(t);try{if(!(i=Lt(t,"return"))){if("throw"===e)throw n;return}i=b(i,t)}catch(t){r=!0,i=t}if("throw"===e)throw n;if(r)throw i;E(i)}function _r(t,e){this.stopped=t,this.result=e}function Or(t,e,n){function i(t){return o&&Dr(o,"normal",t),new _r(!0,t)}function r(t){return p?(E(t),g?v(t[0],t[1],i):v(t[0],t[1])):g?v(t,i):v(t)}var o,s,a,c,l,u,h=n&&n.that,p=!(!n||!n.AS_ENTRIES),f=!(!n||!n.IS_RECORD),d=!(!n||!n.IS_ITERATOR),g=!(!n||!n.INTERRUPTED),v=Z(e,h);if(f)o=t.iterator;else if(d)o=t;else{if(!(n=Ir(t)))throw Gr(_t(t)+" is not iterable");if(void 0!==(e=n)&&(Lr.Array===e||jr[Ar]===e)){for(s=0,a=U(t);s<a;s++)if((c=r(t[s]))&&xt(Nr,c))return;return}o=function(t,e){e=arguments.length<2?Ir(t):e;if(w(e))return E(b(e,t));throw Mr(_t(t)+" is not iterable")}(t,n)}for(l=(f?t:o).next;!(u=b(l,o)).done;){try{c=r(u.value)}catch(t){Dr(o,"throw",t)}if("object"==typeof c&&c&&xt(Nr,c))return}}var Lr={},Ar=e("iterator"),jr=Array.prototype,Rr=e("iterator"),Ir=function(t){if(!mt(t))return Lt(t,Rr)||Lt(t,"@@iterator")||Lr[Qe(t)]},Mr=TypeError,Gr=TypeError,Nr=_r.prototype,kr=e("iterator"),Fr=!1;try{var Br=0,$r={next:function(){return{done:!!Br++}},return:function(){Fr=!0}};$r[kr]=function(){return this},Array.from($r,function(){throw 2})}catch(t){}f=d.CONSTRUCTOR||!function(t,e){if(!e&&!Fr)return!1;var n=!1;try{var i={};i[kr]=function(){return{next:function(){return{done:n=!0}}}},t(i)}catch(t){}return n}(function(t){M.all(t).then(void 0,function(){})}),i({target:"Promise",stat:!0,forced:f},{all:function(t){var a=this,e=tr.f(a),c=e.resolve,l=e.reject,n=Wi(function(){var i=w(a.resolve),r=[],o=0,s=1;Or(t,function(t){var e=o++,n=!1;s++,b(i,a,t).then(function(t){n||(n=!0,r[e]=t,--s||c(r))},l)}),--s||c(r)});return n.error&&l(n.value),e.promise}}),A=d.CONSTRUCTOR,j=M&&M.prototype;i({target:"Promise",proto:!0,forced:A,real:!0},{catch:function(t){return this.then(void 0,t)}}),u(M)&&(C=n("Promise").prototype.catch,j.catch!==C&&m(j,"catch",C,{unsafe:!0})),i({target:"Promise",stat:!0,forced:f},{race:function(t){var n=this,i=tr.f(n),r=i.reject,e=Wi(function(){var e=w(n.resolve);Or(t,function(t){b(e,n,t).then(i.resolve,r)})});return e.error&&r(e.value),i.promise}});i({target:"Promise",stat:!0,forced:d.CONSTRUCTOR},{reject:function(t){var e=tr.f(this);return b(e.reject,void 0,t),e.promise}});function zr(e){return function(t){t=vn($(t));return 1&e&&(t=Wr(t,Ur,"")),t=2&e?Wr(t,Hr,""):t}}function Vr(l){return function(t,e,n,i){w(e);var r=V(t),o=vt(r),s=U(r),a=l?s-1:0,c=l?-1:1;if(n<2)for(;;){if(a in o){i=o[a],a+=c;break}if(a+=c,l?a<0:s<=a)throw to("Reduce of empty array with no initial value")}for(;l?0<=a:a<s;a+=c)a in o&&(i=e(i,o[a],a,r));return i}}function Xr(e){return 51<=Et||!c(function(){var t=[];return(t.constructor={})[no]=function(){return{foo:1}},1!==t[e](Boolean).foo})}function Yr(o){return fo?function(t,e){var n=2<xn(arguments.length,1),i=u(t)?t:go(t),r=n?Ve(arguments,2):void 0;return o(n?function(){mi(i,this,r)}:i,e)}:o}var D=d.CONSTRUCTOR,hi=(n("Promise"),i({target:"Promise",stat:!0,forced:D},{resolve:function(t){return t=t,E(e=this),p(t)&&t.constructor===e?t:((0,(e=tr.f(e)).resolve)(t),e.promise);var e}}),"\t\n\v\f\r                　\u2028\u2029\ufeff"),Wr=a("".replace),R="["+hi+"]",Ur=RegExp("^"+R+R+"*"),Hr=RegExp(R+R+"*$"),I={start:zr(1),end:zr(2),trim:zr(3)},qr=I.trim,Kr=y.parseInt,L=y.Symbol,Zr=L&&L.iterator,Jr=/^[+-]?0x/i,Qr=a(Jr.exec),T=8!==Kr(hi+"08")||22!==Kr(hi+"0x16")||Zr&&!c(function(){Kr(Object(Zr))})?function(t,e){t=qr(vn(t));return Kr(t,e>>>0||(Qr(Jr,t)?16:10))}:Kr,to=(i({global:!0,forced:parseInt!=T},{parseInt:T}),TypeError),eo={left:Vr(!1),right:Vr(!0)}.left,no=(i({target:"Array",proto:!0,forced:!nt("reduce")||!O&&79<Et&&Et<83},{reduce:function(t){var e=arguments.length;return eo(this,t,e,1<e?arguments[1]:void 0)}}),e("species")),io=v.filter,ro=(i({target:"Array",proto:!0,forced:!Xr("filter")},{filter:function(t){return io(this,t,1<arguments.length?arguments[1]:void 0)}}),v.some),$r=(i({target:"Array",proto:!0,forced:!nt("some")},{some:function(t){return ro(this,t,1<arguments.length?arguments[1]:void 0)}}),Date.prototype),oo="Invalid Date",A="toString",so=a($r[A]),ao=a($r.getTime),co=(String(new Date(NaN))!=oo&&m($r,A,function(){var t=ao(this);return t==t?so(this):oo}),RegExp.prototype),j=ue.PROPER,C="toString",lo=RegExp.prototype[C],f=c(function(){return"/a/b"!=lo.call({source:"a",flags:"b"})}),d=j&&lo.name!=C,uo=((f||d)&&m(RegExp.prototype,C,function(){var t,e=E(this);return"/"+vn(e.source)+"/"+vn(void 0!==(t=(e=e).flags)||"flags"in co||x(e,"flags")||!xt(co,e)?t:b(mn,e))},{unsafe:!0}),le.indexOf),ho=a([].indexOf),po=!!ho&&1/ho([1],1,-0)<0,D=nt("indexOf"),fo=(i({target:"Array",proto:!0,forced:po||!D},{indexOf:function(t){var e=1<arguments.length?arguments[1]:void 0;return po?ho(this,t,e)||0:uo(this,t,e)}}),/MSIE .\./.test(t)),go=y.Function,R={setTimeout:Yr(y.setTimeout),setInterval:Yr(y.setInterval)},L=R.setInterval,T=(i({global:!0,bind:!0,forced:y.setInterval!==L},{setInterval:L}),R.setTimeout),vo=(i({global:!0,bind:!0,forced:y.setTimeout!==T},{setTimeout:T}),I.trim),mo=a("".charAt),yo=y.parseFloat,$r=y.Symbol,bo=$r&&$r.iterator,A=1/yo(hi+"-0")!=-1/0||bo&&!c(function(){yo(Object(bo))})?function(t){var t=vo(vn(t)),e=yo(t);return 0===e&&"-"==mo(t,0)?-0:e}:yo,wo=(i({global:!0,forced:parseFloat!=A},{parseFloat:A}),a(1..valueOf)),j=je.f,xo=Qt.f,Eo=S.f,So=I.trim,f="Number",Po=y[f],To=Po.prototype,Co=y.TypeError,Do=a("".slice),_o=a("".charCodeAt),Oo=function(t){var e,n,i,r,o,s,a,c=Ut(t,"number");if(Ct(c))throw Co("Cannot convert a Symbol value to a number");if("string"==typeof c&&2<c.length)if(c=So(c),43===(t=_o(c,0))||45===t){if(88===(e=_o(c,2))||120===e)return NaN}else if(48===t){switch(_o(c,1)){case 66:case 98:n=2,i=49;break;case 79:case 111:n=8,i=55;break;default:return+c}for(o=(r=Do(c,2)).length,s=0;s<o;s++)if((a=_o(r,s))<48||i<a)return NaN;return parseInt(r,n)}return+c};if($e(f,!Po(" 0o1")||!Po("0b1")||Po("+0x1"))){for(var Lo,Ao=function(t){var e,n,i,t=arguments.length<1?0:Po(function(t){t=Ut(t,"number");return"bigint"==typeof t?t:Oo(t)}(t)),r=this;return xt(To,r)&&c(function(){wo(r)})?(e=Object(t),n=r,i=Ao,ui&&u(n=n.constructor)&&n!==i&&p(n=n.prototype)&&n!==i.prototype&&ui(e,n),e):t},jo=l?j(Po):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,isFinite,isInteger,isNaN,isSafeInteger,parseFloat,parseInt,fromString,range".split(","),Ro=0;jo.length>Ro;Ro++)x(Po,Lo=jo[Ro])&&!x(Ao,Lo)&&Eo(Ao,Lo,xo(Po,Lo));(Ao.prototype=To).constructor=Ao,m(y,f,Ao,{constructor:!0})}function Io(t,e){this.options=_.util.assign({friction:.92},e),this._isDragging=!1,this._dragLastX=0,this._dragLastY=0,this._dragDeltaX=0,this._dragDeltaY=0,this._dragLastDeltaX=0,this._dragLastDeltaY=0,this._velocityX=0,this._velocityY=0,this._requestAnimationFrameId=-1,this.onInertiaMove=t}Io.prototype.approxZero=function(t){return Math.abs(t)<.5},Io.prototype.updateVelocity=function(){var t=this._velocityX,e=this._velocityY,n=this._isDragging,i=this.options,r=this.onInertiaMove;!n&&this.approxZero(t)&&this.approxZero(e)||(this._requestAnimationFrameId=_.util.nextFrame(this.updateVelocity.bind(this)),n?(this._dragLastDeltaX=this._dragDeltaX,this._dragLastDeltaY=this._dragDeltaY,this._dragDeltaX=this._dragLastX,this._dragDeltaY=this._dragLastY,this._velocityX=this._dragDeltaX-this._dragLastDeltaX,this._velocityY=this._dragDeltaY-this._dragLastDeltaY):(n=t,t=e,e=i.friction,this._velocityX*=e,this._velocityY*=e,this._dragLastX+=n,this._dragLastY+=t,"function"==typeof r&&r(n,t)))},Io.prototype.handleDragStart=function(t){this._isDragging=!0,this._dragLastX=t.clientX,this._dragLastY=t.clientY,this._velocityX=0,this._velocityY=0,_.util.cancelFrame(this._requestAnimationFrameId),this.updateVelocity()},Io.prototype.handleDragMove=function(t){this._dragLastX=t.clientX,this._dragLastY=t.clientY};var Mo=_.mvc.View.extend({className:"paper-scroller",events:{scroll:"onScroll"},options:{paper:void 0,padding:function(){var t,e=this.getClientSize(),n=Math.max(this.options.minVisiblePaperSize,1)||1;return(t={}).left=t.right=Math.max(e.width-n,0),t.top=t.bottom=Math.max(e.height-n,0),t},scrollWhileDragging:!(Io.prototype.handleDragEnd=function(t){this._isDragging=!1}),minVisiblePaperSize:50,autoResizePaper:!1,baseWidth:void 0,baseHeight:void 0,contentOptions:void 0,cursor:"default",inertia:!1,borderless:!1},_padding:{left:0,top:0},init:function(){var t=this,e=(_.util.bindAll(this,"startPanning","stopPanning","pan","onBackgroundEvent"),this.options),n=this.el,i=e.paper,r=e.autoResizePaper,o=e.scrollWhileDragging,s=e.cursor,a=e.inertia,c=i.scale();this._sx=c.sx,this._sy=c.sy,void 0===e.baseWidth&&(e.baseWidth=i.options.width),void 0===e.baseHeight&&(e.baseHeight=i.options.height),this.$background=h("<div/>").addClass("paper-scroller-background").css({width:i.options.width,height:i.options.height}).append(i.el).appendTo(n),this.listenTo(i,"scale",this.onScale).listenTo(i,"resize",this.onResize).listenTo(i,"beforeprint beforeexport",this.storeScrollPosition).listenTo(i,"afterprint afterexport",this.restoreScrollPosition),r&&this.listenTo(i,"render:done",this.onPaperRenderDone),o&&(this.listenTo(i,"cell:pointermove",this.onCellPointermove),this.listenTo(i,"cell:pointerup",this.onCellPointerup)),this.debouncedStoreCenter=_.util.debounce(function(){return t.storeCenter()}),this.storeCenter(i.options.width/2,i.options.height/2),this.delegateBackgroundEvents(),this.setCursor(s),a&&(this.inertia=new Io(function(t,e){var n=this.el;n.scrollTop-=e,n.scrollLeft-=t}.bind(this),a))},onCellPointermove:function(t,e,n,i){var r=this.options.scrollWhileDragging;r&&this.scrollWhileDragging(e,n,i,r)},onCellPointerup:function(t,e){this.stopScrollWhileDragging(e)},scrollWhileDragging:function(t,e,n){var i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:{},r=this.el,o=i.interval,o=void 0===o?25:o,s=i.padding,s=void 0===s?-20:s,i=i.scrollingFunction,i=void 0===i?function(t){return t<20?5:20}:i,a=this.eventData(t).scrollId,c=new _.g.Point(e,n),s=_.util.normalizeSides(s),l=s.top,u=s.left,h=s.right,s=s.bottom,u=this.getVisibleArea().moveAndExpand({x:-u,y:-l,width:u+h,height:l+s});u.containsPoint(c)?(clearInterval(a),this.eventData(t,{scrollId:null})):(h=u.pointNearestToPoint(c).distance(c),l=i.call(this,h,t),s=u.x,c=u.y,i=u.width,h=u.height,this.eventData(t,{scrollX:e<s?-1:s+i<e?1:0,scrollY:n<c?-1:c+h<n?1:0,scrollPerTick:l,container:r}),a||(u=this.eventData(t),a=setInterval(function(t){var e=t.scrollPerTick,n=t.scrollX,i=t.scrollY,t=t.container;t.scrollLeft+=e*n,t.scrollTop+=e*i},o,u),u.scrollId=a))},stopScrollWhileDragging:function(t){t=this.eventData(t).scrollId;t&&clearInterval(t)},onPaperRenderDone:function(t){t.priority<2&&this.adjustPaper()},lock:function(){return this.$el.css("overflow","hidden"),this},unlock:function(){return this.$el.css("overflow","scroll"),this},setCursor:function(t){return"grab"===t?this.$el.css("cursor",""):this.$el.css("cursor",t),this.$el.attr("data-cursor",t),this.options.cursor=t,this},delegateBackgroundEvents:function(i){i=i||_.util.result(this.options.paper,"events");var t=this.paperEvents=Object.keys(i||{}).reduce(function(t,e){var n=i[e];-1===e.indexOf(" ")&&(t[e]=_.util.isFunction(n)?n:this.options.paper[n]);return t}.bind(this),{});return Object.keys(t).forEach(function(t){this.delegate(t,{guarded:!1},this.onBackgroundEvent)},this),this},onBackgroundEvent:function(t){this.$background.is(t.target)&&(t=this.paperEvents[t.type],_.util.isFunction(t)&&t.apply(this.options.paper,arguments))},onScroll:function(t){this.trigger("scroll",t),this.debouncedStoreCenter()},onResize:function(){this.restoreCenter()},onScale:function(t,e,n,i){this.adjustScale(t,e),this._sx=t,this._sy=e,(n||i)&&this.center(n,i);t=this.options,e=t.contentOptions,n=t.borderless;"function"!=typeof e&&!n||this.adjustPaper()},storeScrollPosition:function(){this._scrollLeftBeforePrint=this.el.scrollLeft,this._scrollTopBeforePrint=this.el.scrollTop},restoreScrollPosition:function(){this.el.scrollLeft=this._scrollLeftBeforePrint,this.el.scrollTop=this._scrollTopBeforePrint,this._scrollLeftBeforePrint=null,this._scrollTopBeforePrint=null},beforePaperManipulation:function(){(_.env.test("msie")||_.env.test("msedge"))&&this.$el.css("visibility","hidden")},afterPaperManipulation:function(){(_.env.test("msie")||_.env.test("msedge"))&&this.$el.css("visibility","visible")},clientToLocalPoint:function(t,e){var n=this.options.paper.matrix();return t=(t+=this.getLTRScrollLeft()-this._padding.left-n.e)/n.a,e=(e+=this.el.scrollTop-this._padding.top-n.f)/n.d,new _.g.Point(t,e)},localToBackgroundPoint:function(t,e){var t=new _.g.Point(t,e),e=this.options.paper.matrix(),n=this._padding;return _.V.transformPoint(t,e).offset(n.left,n.top)},getPadding:function(){var t=this.options.padding;return _.util.isFunction(t)&&(t=t.call(this,this)),_.util.normalizeSides(t)},computeRequiredPadding:function(t){var e=this.options.paper.scale(),n=e.sx,e=e.sy,i=this.getCenter(),r=i.x,i=i.y,n=(r*=n,i*=e,t.x),e=t.y,o=n+t.width,t=e+t.height,s=this.getClientSize(),a=s.width/2,s=s.height/2,c=this.getPadding(),l=c.left,u=c.right,h=c.top,c=c.bottom;return{left:Math.max(a-l-r+n,0)+l,right:Math.max(a-u+r-o,0)+u,top:Math.max(s-h-i+e,0)+h,bottom:Math.max(s-c+i-t,0)+c}},addPadding:function(){var t,e,n,i,r=this.options,o=r.borderless,r=r.paper,s=(o?t=e=n=i=0:(s=(o=r.scale()).sx,o=o.sy,a=r.getArea(),a=this.computeRequiredPadding(a.scale(s,o,{x:0,y:0})),t=Math.round(a.left),e=Math.round(a.right),n=Math.round(a.top),i=Math.round(a.bottom)),this._padding={left:t,top:n,bottom:i,right:e},r.getComputedSize()),o=s.width,a=s.height;return this.$background.css({width:t+o+e,height:n+a+i}),r.$el.css({left:t,top:n}),this},storeCenter:function(t,e){t=_.util.isNumber(t)?new _.g.Point(t,e):this.computeCenter();this._center=t},restoreCenter:function(){var t=this._center;t&&this.center(t.x,t.y)},getCenter:function(){return this._center||(this._center=this.options.paper.getArea().center()),this._center},computeCenter:function(){var t=this.getClientSize(),e=t.width,t=t.height;return this.clientToLocalPoint(e/2,t/2)},adjustPaper:function(){var t,e,n,i,r=this.options,o=r.paper,s=r.borderless,r=r.contentOptions,r=("function"==typeof r&&(r=r.call(this,this)),_.util.assign({gridWidth:this.options.baseWidth,gridHeight:this.options.baseHeight,allowNewOrigin:"negative"},r));return s?(s=o.getFitToContentArea(this.transformContentOptions(r)),i=(t=o.scale()).sx,t=t.sy,s.x*=i,s.y*=t,s.width*=i,s.height*=t,t=(i=this.computeRequiredPadding(s)).left,e=i.right,n=i.top,i=i.bottom,s.moveAndExpand({x:-t,y:-n,width:t+e,height:n+i}),o.setOrigin(-s.x,-s.y),o.setDimensions(s.width,s.height)):o.fitToContent(this.transformContentOptions(r)),this},adjustScale:function(t,e){var n=this.options.paper,i=n.options,t=t/this._sx,e=e/this._sy;n.setOrigin(i.origin.x*t,i.origin.y*e),n.setDimensions(i.width*t,i.height*e)},transformContentOptions:function(t){var e=this._sx,n=this._sy;return t.gridWidth&&(t.gridWidth*=e),t.gridHeight&&(t.gridHeight*=n),t.minWidth&&(t.minWidth*=e),t.minHeight&&(t.minHeight*=n),_.util.isObject(t.padding)?t.padding={left:(t.padding.left||0)*e,right:(t.padding.right||0)*e,top:(t.padding.top||0)*n,bottom:(t.padding.bottom||0)*n}:_.util.isNumber(t.padding)&&(t.padding=t.padding*e),t},center:function(t,e,n){var i,r=this.options.paper,o=r.matrix(),s=o.a,a=o.d,c=o.e,o=o.f,l=_.util.isNumber(t),u=_.util.isNumber(e);return l||u?(i=n,l||(t=this.getVisibleArea().center().x),u||(e=this.getVisibleArea().center().y),t*=s,e*=a):(i=t,t=(-c+(n=r.getComputedSize()).width)/2,e=(-o+n.height)/2),this.storeCenter(t/s,e/a),this.addPadding(),this.scroll(t,e,i),this},centerContent:function(t){return this.positionContent("center",t)},centerElement:function(t,e){return this.checkElement(t,"centerElement"),this.positionElement(t,"center",e)},positionContent:function(t,e){var n=this.options.paper.getContentArea(e);return this.positionRect(n,t,e)},positionElement:function(t,e,n){this.checkElement(t,"positionElement");t=t.getBBox();return this.positionRect(t,e,n)},positionRect:function(t,e,n){var i;switch(e){case"center":return i=t.center(),this.positionPoint(i,"50%","50%",n);case"top":return i=t.topMiddle(),this.positionPoint(i,"50%",0,n);case"top-right":return i=t.topRight(),this.positionPoint(i,"100%",0,n);case"right":return i=t.rightMiddle(),this.positionPoint(i,"100%","50%",n);case"bottom-right":return i=t.bottomRight(),this.positionPoint(i,"100%","100%",n);case"bottom":return i=t.bottomMiddle(),this.positionPoint(i,"50%","100%",n);case"bottom-left":return i=t.bottomLeft(),this.positionPoint(i,0,"100%",n);case"left":return i=t.leftMiddle(),this.positionPoint(i,0,"50%",n);case"top-left":return i=t.topLeft(),this.positionPoint(i,0,0,n);default:throw new Error("Provided positionName ('"+e+"') was not recognized.")}},positionPoint:function(t,e,n,i){var r=_.util.normalizeSides((i=i||{}).padding),o=new _.g.Rect(this.getClientSize()),r=o.clone().moveAndExpand({x:r.left,y:r.top,width:-r.right-r.left,height:-r.top-r.bottom}),s=_.util.isPercentage(e),s=(e=parseFloat(e),(e=s?e/100*Math.max(0,r.width):e)<0&&(e=r.width+e),_.util.isPercentage(n)),s=(n=parseFloat(n),(n=s?n/100*Math.max(0,r.height):n)<0&&(n=r.height+n),r.origin().offset(e,n)),r=o.center().difference(s),e=this.zoom(),n=r.scale(1/e,1/e),o=t.clone().offset(n);return this.center(o.x,o.y,i)},scroll:function(t,e,n){var i,r=this.options.paper.matrix(),o=this.getClientSize(),s={};_.util.isNumber(t)&&(i=o.width/2,s.scrollLeft=this.getScrollLeftFromLTR(t-i+r.e+(this._padding.left||0))),_.util.isNumber(e)&&(t=o.height/2,s.scrollTop=e-t+r.f+(this._padding.top||0)),n&&n.animation?this.$el.animate(s,n.animation):this.$el.prop(s)},scrollToContent:function(t){var e=this.options.paper.getContentArea(t).center(),n=this._sx,i=this._sy;return e.x*=n,e.y*=i,this.scroll(e.x,e.y,t)},scrollToElement:function(t,e){this.checkElement(t,"scrollToElement");var t=t.getBBox().center(),n=this._sx,i=this._sy;return t.x*=n,t.y*=i,this.scroll(t.x,t.y,e)},zoom:function(t){var e,n,i,r,o,s,a=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return void 0===t?this._sx:(e=this.computeCenter(),i=t=t,a.absolute||(n=1e12,t=(s=function(t,e){return(t*n+e*n)/n})(this._sx,t),i=s(this._sy,i)),a.grid&&(t=Math.round(t/a.grid)*a.grid,i=Math.round(i/a.grid)*a.grid),a.max&&(t=Math.min(a.max,t),i=Math.min(a.max,i)),a.min&&(t=Math.max(a.min,t),i=Math.max(a.min,i)),s=void 0===a.ox||void 0===a.oy?(o=e.x,e.y):(s=t/this._sx,r=i/this._sy,o=a.ox-(a.ox-e.x)/s,a.oy-(a.oy-e.y)/r),this.beforePaperManipulation(),this.options.paper.scale(t,i),this.center(o,s),this.afterPaperManipulation(),this)},zoomToRect:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=(t=new _.g.Rect(t),this.options.paper),i=_.util.assign({},n.options.origin),i=(e.fittingBBox=e.fittingBBox||_.util.assign({},new _.g.Point(i),{width:this.$el.width(),height:this.$el.height()}),e.contentArea=t,this.beforePaperManipulation(),n.scaleContentToFit(e),t.center());return this.adjustPaper(),this.center(i.x,i.y),this.afterPaperManipulation(),this},zoomToFit:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=this.options.paper.getContentArea(t);return this.zoomToRect(e,t),this},transitionClassName:"transition-in-progress",transitionEventName:"transitionend.paper-scroller-transition",transitionToPoint:function(t,e,n){_.util.isObject(t)&&(n=e,e=t.y,t=t.x),n=n||{};var i,r,o=this._sx,s=Math.max(n.scale||o,1e-6),a=new _.g.Point(t,e),c=this.computeCenter();return o===s?i="translate("+(i=c.difference(a).scale(o,o).round()).x+"px,"+i.y+"px)":(r=s/(o-s)*a.distance(c),c=c.clone().move(a,r),i="scale("+s/o+")",r=(a=this.localToBackgroundPoint(c).round()).x+"px "+a.y+"px"),this.$el.addClass(this.transitionClassName),this.$background.off(this.transitionEventName).on(this.transitionEventName,function(t){var e=this.paperScroller,n=(e.syncTransition(this.scale,{x:this.x,y:this.y}),this.onTransitionEnd);_.util.isFunction(n)&&n.call(e,t)}.bind({paperScroller:this,scale:s,x:t,y:e,onTransitionEnd:n.onTransitionEnd})).css({transition:"transform",transitionDuration:n.duration||"1s",transitionDelay:n.delay,transitionTimingFunction:n.timingFunction,transformOrigin:r,transform:i}),this},syncTransition:function(t,e){return this.beforePaperManipulation(),this.options.paper.scale(t),this.removeTransition().center(e.x,e.y),this.afterPaperManipulation(),this},removeTransition:function(){return this.$el.removeClass(this.transitionClassName),this.$background.off(this.transitionEventName).css({transition:"",transitionDuration:"",transitionDelay:"",transitionTimingFunction:"",transform:"",transformOrigin:""}),this},transitionToRect:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=(t=new _.g.Rect(t),e.maxScale||1/0),i=e.minScale||Number.MIN_VALUE,r=e.scaleGrid||null,o=e.visibility||1,s=e.center?new _.g.Point(e.center):t.center(),a=this.getClientSize(),c=a.width*o,a=a.height*o,o=new _.g.Rect({x:s.x-c/2,y:s.y-a/2,width:c,height:a}).maxRectUniformScaleToFit(t,s),o=Math.min(o,n);return r&&(o=Math.floor(o/r)*r),o=Math.max(i,o),this.transitionToPoint(s,_.util.defaults({scale:o},e)),this},startPanning:function(t){t=_.util.normalizeEvent(t),this._clientX=t.clientX,this._clientY=t.clientY,this.trigger("pan:start",t),this.delegatePanning(),this.options.inertia&&this.inertia.handleDragStart(t)},pan:function(t){var e=(t=_.util.normalizeEvent(t)).clientX-this._clientX,n=t.clientY-this._clientY;this.el.scrollTop-=n,this.el.scrollLeft-=e,this._clientX=t.clientX,this._clientY=t.clientY,this.options.inertia&&this.inertia.handleDragMove(t)},stopPanning:function(t){this.undelegatePanning(),t=t&&_.util.normalizeEvent(t),this.trigger("pan:stop",t),this.options.inertia&&this.inertia.handleDragEnd(t)},delegatePanning:function(){this.$el.addClass("is-panning"),h(document.body).on({"mousemove.panning touchmove.panning":this.pan,"mouseup.panning touchend.panning":this.stopPanning}),h(window).on("mouseup.panning",this.stopPanning)},undelegatePanning:function(){this.$el.removeClass("is-panning"),h(document.body).off(".panning"),h(window).off(".panning")},getClientSize:function(){var t=this.el;return{width:t.clientWidth,height:t.clientHeight}},getVisibleArea:function(){var t=this.options.paper.matrix(),e=this.getClientSize(),e={x:this.getLTRScrollLeft(),y:this.el.scrollTop||0,width:e.width,height:e.height},e=_.V.transformRect(e,t.inverse());return e.x-=(this._padding.left||0)/this._sx,e.y-=(this._padding.top||0)/this._sy,new _.g.Rect(e)},isElementVisible:function(t,e){this.checkElement(t,"isElementVisible");e=(e=e||{}).strict?"containsRect":"intersect";return!!this.getVisibleArea()[e](t.getBBox())},isPointVisible:function(t){return this.getVisibleArea().containsPoint(t)},checkElement:function(t,e){if(!(t&&t instanceof _.dia.Element))throw new TypeError("ui.PaperScroller."+e+"() accepts instance of dia.Element only")},onRemove:function(){this.undelegatePanning()},isRTLDirection:function(){return"rtl"===getComputedStyle(this.el).direction},getLTRScrollLeft:function(){var t,e=this.el;return this.isRTLDirection()?(t=e.scrollLeft,e.scrollWidth-e.clientWidth+t):e.scrollLeft},getScrollLeftFromLTR:function(t){var e;return this.isRTLDirection()?t-((e=this.el).scrollWidth-e.clientWidth):t}}),Go=(_.env.addTest("msie",function(){var t=window.navigator.userAgent;return-1!==t.indexOf("MSIE")||-1!==t.indexOf("Trident")}),_.env.addTest("msedge",function(){return/Edge\/\d+/.test(window.navigator.userAgent)}),v.map);function No(t,e,n){var i,r=e.size,e=e.position;r&&(i=r.width,r=r.height,t.resize(i,r,n)),e&&(i=e.x,r=e.y,t.position(i,r,n))}i({target:"Array",proto:!0,forced:!Xr("map")},{map:function(t){return Go(this,t,1<arguments.length?arguments[1]:void 0)}});var ko={layout:function(t,f){var d=t instanceof _.dia.Graph?t:(new _.dia.Graph).resetCells(t,{dry:!0,sort:!1}),e=(t=null,f=f||{},d.getElements()),g=f.columns||1,n=Math.ceil(e.length/g),v=f.dx||0,m=f.dy||0,t=void 0===f.centre||!1!==f.centre,y=t?"middle":f.verticalAlign,b=t?"middle":f.horizontalAlign,w=!!f.resizeToFit,t=f.marginX||0,i=f.marginY||0,x=f.columnGap||0,E=f.rowGap||0,S=f.setAttributes,P=("function"!=typeof S&&(S=No),[]),r=f.columnWidth;if("compact"===r)for(var o=0;o<g;o++){var s=this._elementsAtColumn(e,o,g);P.push(this._maxDim(s,"width")+v)}else{r&&!_.util.isString(r)||(r=this._maxDim(e,"width")+v);for(var a=0;a<g;a++)P.push(r)}var T=this._accumulate(P,t).map(function(t,e){return t+(e-.5)*x}),C=[],c=f.rowHeight;if("compact"===c)for(var l=0;l<n;l++){var u=this._elementsAtRow(e,l,g);C.push(this._maxDim(u,"height")+m)}else{c&&!_.util.isString(c)||(c=this._maxDim(e,"height")+m);for(var h=0;h<n;h++)C.push(c)}var D=this._accumulate(C,i).map(function(t,e){return t+(e-.5)*E}),t=(d.startBatch("layout"),e.forEach(function(t,e){var n,i,r,o,s=e%g,e=Math.floor(e/g),a=P[s],c=C[e],l=0,u=0,h=t.get("size"),p={};switch(w&&(n=a-2*v,i=c-2*m,r=h.height*(h.width?n/h.width:1),o=h.width*(h.height?i/h.height:1),c<r?n=o:i=r,p.size=h={width:n,height:i}),y){case"top":break;case"bottom":u=c-h.height;break;case"middle":u=(c-h.height)/2}switch(b){case"left":break;case"right":l=a-h.width;break;case"middle":l=(a-h.width)/2}p.position={x:T[s]+v+l+x/2,y:D[e]+m+u+E/2},S.call(d,t,p,f)}),d.stopBatch("layout"),0<g&&(T[0]+=x/2,T[g]-=x/2),0<n?(D[0]+=E/2,D[n]-=E/2):0===D.length&&(D=[i,i]),new _.g.Rect(t,i,T[g]-T[0],D[n]-D[0]));return{rowHeights:C,columnWidths:P,gridY:D,gridX:T,bbox:t}},_maxDim:function(t,n){return t.reduce(function(t,e){return Math.max(e.get("size")[n],t)},0)},_elementsAtRow:function(t,e,n){for(var i=[],r=n*e,o=Math.min(r+n,t.length);r<o;r++)i.push(t[r]);return i},_elementsAtColumn:function(t,e,n){for(var i=[],r=e,o=t.length;r<o;r+=n)i.push(t[r]);return i},_accumulate:function(t,e){return 0===t.length?[]:t.reduce(function(t,e,n){return t.push(t[n]+e),t},[e||0])}},Fo={options:function(){return{columnWidth:this.options.width/2-10,columns:2,rowHeight:80,resizeToFit:!0,dy:10,dx:10}},layoutGroup:function(t,e){var n=this.options.layout;if(e=e||{},!ko)throw new Error("joint.ui.Stencil: joint.layout.GridLayout is not available.");ko.layout(t,_.util.assign({},n,e.layout))}},d=_.mvc.View.extend({className:"stencil",events:{"click .btn-expand":"openGroups","click .btn-collapse":"closeGroups","click .groups-toggle > .group-label":"openGroups","click .group > .group-label":"onGroupLabelClick","touchstart .group > .group-label":"onGroupLabelClick","input .search":"onSearch","focusin .search":"pointerFocusIn","focusout .search":"pointerFocusOut"},documentEvents:{mousemove:"onDrag",touchmove:"onDrag",mouseup:"onDragEnd",touchend:"onDragEnd",touchcancel:"onDragEnd"},options:{width:200,height:800,label:"Stencil",groups:null,groupsToggleButtons:!1,dropAnimation:!1,search:null,layout:null,snaplines:null,scaleClones:!1,usePaperGrid:!1,dragStartClone:function(t){return t.clone()},dragEndClone:function(t){return t.clone()},canDrag:null,layoutGroup:null,paperOptions:null,paperDragOptions:null,paperPadding:10,contentOptions:null,container:null},DEFAULT_GROUP:"__default__",init:function(){this.setPaper(this.options.paperScroller||this.options.paper),this.graphs={},this.papers={},this.$groups={},this.onSearch=_.util.debounce(this.onSearch,200),this.delegateEvents(),this.initializeLayout()},initializeLayout:function(){var t=this.options.layout;t&&(_.util.isFunction(t)?this.layoutGroup=t:(this.layoutGroup=Fo.layoutGroup.bind(this),this.options.layout=_.util.isObject(t)?t:{},_.util.defaults(this.options.layout,Fo.options.call(this))))},setPaper:function(t){var e=this.options;if(t instanceof _.dia.Paper)e.paperScroller=null,e.paper=t,e.graph=t.model;else{if(!("function"==typeof Mo&&t instanceof Mo))throw new Error("Stencil: paper required");e.paperScroller=t,e.paper=t.options.paper,e.graph=t.options.paper.model}},freeze:function(e){var n=this.papers;Object.keys(n).forEach(function(t){n[t].freeze(e)})},unfreeze:function(e){var n=this.papers;Object.keys(n).forEach(function(t){n[t].unfreeze(e)})},renderContent:function(){return h("<div/>").addClass("content")},renderPaperDrag:function(){return h("<div/>").addClass("stencil-paper-drag")},renderSearch:function(){return h("<div/>").addClass("search-wrap").append(h("<input/>",{type:"search",placeholder:"search"}).addClass("search"))},renderToggleAll:function(){return[h("<div/>").addClass("groups-toggle").append(h("<label/>").addClass("group-label").html(this.options.label)).append(h("<button/>",{text:"+"}).addClass("btn btn-expand")).append(h("<button/>",{text:"-"}).addClass("btn btn-collapse"))]},renderElementsContainer:function(){return h("<div/>").addClass("elements")},renderGroup:function(t){t=t||{};var e=h("<div/>").addClass("group").attr("data-name",t.name).toggleClass("closed",!!t.closed),t=h("<h3/>").addClass("group-label").html(t.label||t.name),n=this.renderElementsContainer();return e.append(t,n)},render:function(){this.dispose();var r,o=this.options,t=(this.$content=this.renderContent(),this.$paperDrag=this.renderPaperDrag(),this.$el.empty().append(this.$paperDrag,this.$content),o.search&&this.$el.addClass("searchable").prepend(this.renderSearch()),o.groupsToggleButtons&&this.$el.addClass("collapsible").prepend(this.renderToggleAll()),this.el.dataset.textNoMatchesFound="No matches found",Object.keys(o.groups||{})),e=0<t.length;if(o.paperOptions&&!_.util.isFunction(o.paperOptions)&&o.paperOptions.model)throw new Error("ui.Stencil: the `paperOptions` has to be a function if there is the property `model` defined.");e?_.util.sortBy(t,function(t){return this[t].index}.bind(o.groups)).forEach(function(t){var e=this.options.groups[t],n=this.$groups[t]=this.renderGroup({name:t,label:e.label,closed:e.closed}).appendTo(this.$content);if(e.paperOptions&&e.paperOptions.model)throw new Error("ui.Stencil: the `model` property is not allowed in the `paperOptions` for the groups.");var i=(r=_.util.result(o,"paperOptions")||{}).model||new _.dia.Graph,n=(i.set("group",t),_.util.assign({},r,e.paperOptions,{el:n.find(".elements"),model:i,width:e.width||o.width,height:e.height||o.height,interactive:!1,preventDefaultBlankAction:!1})),i=new _.dia.Paper(n);this.graphs[t]=n.model,this.papers[t]=i},this):(e=this.renderElementsContainer().appendTo(this.$content),r=_.util.result(o,"paperOptions")||{},t=new _.dia.Paper(_.util.assign({},r,{el:e,model:r.model||new _.dia.Graph,width:o.width,height:o.height,interactive:!1,preventDefaultBlankAction:!1})),this.graphs[this.DEFAULT_GROUP]=t.model,this.papers[this.DEFAULT_GROUP]=t),r=_.util.result(o,"paperOptions")||{};e=_.util.result(o,"paperDragOptions")||{},t=this._graphDrag=e.model||r.model||new _.dia.Graph;return this._paperDrag=new _.dia.Paper(_.util.assign({},e,{el:this.$paperDrag,width:1,height:1,model:t,sorting:_.dia.Paper.sorting.NONE})),this.startListening(),this},paperEvents:{"cell:pointerdown":"onDragStart"},startListening:function(){var t,i=this,r=(this.stopListening(),this.paperEvents),o=this.papers;for(t in r)(function(e){var n=r[e];if(!(n="function"!=typeof n?i[n]:n))return;_.util.forIn(o,function(t){i.listenTo(t,e,n)})})(t)},load:function(n,t){Array.isArray(n)?this.loadGroup(n,t):_.util.isObject(n)&&_.util.forIn(this.options.groups,function(t,e){n[e]&&this.loadGroup(n[e],e)}.bind(this))},loadGroup:function(t,e){var n=this.options,i=this.getGraph(e),t=(i.resetCells(t),n.height);e&&(t=this.getGroup(e).height),this.isLayoutEnabled()&&this.layoutGroup(i,this.getGroup(e)),t||this.fitPaperToContent(this.getPaper(e))},isLayoutEnabled:function(){return Boolean(this.options.layout)},getGraph:function(t){var e=this.graphs[t||this.DEFAULT_GROUP];if(e)return e;throw new Error("Stencil: group "+t+" does not exist.")},getPaper:function(t){return this.papers[t||this.DEFAULT_GROUP]},hasSnaplinesEnabled:function(){var t=this.options.snaplines;return Boolean(t)&&!t.isDisabled()},preparePaperForDragging:function(t,e,n){var i=this._paperDrag,r=this._graphDrag,o=this.options,s=o.snaplines,a=o.usePaperGrid,c=o.scaleClones,l=o.paper,u=o.container,o=(this.stopListening(r),i.$el.stop(!0,!0),i.$el.addClass("dragging").appendTo(u||document.body),o.dragStartClone(t.model).position(0,0)),t=(r.resetCells([o]),5),c=(s&&(t+=s.options.distance),s||a||c?(s=(r=l.scale()).sx,a=r.sy,i.scale(s,a),t*=Math.max(s,a)):i.scale(1,1),i.fitToContent({padding:t,allowNewOrigin:"any"}),o.findView(i)),l=c.getBBox({useModelGeometry:!0}),r=l.origin().difference(c.getBBox().origin()),s=this.setPaperDragOffset(e,n,{cloneGeometryBBox:l,cloneViewDeltaOrigin:r,paperDragPadding:t}),a=h(u).offset();return a&&(s.left-=a.left,s.top-=a.top),{clone:o,cloneView:c,cloneBBox:o.getBBox(),cloneGeometryBBox:l,cloneViewDeltaOrigin:r,paperDragPadding:t,paperDragInitialOffset:s}},removePaperAfterDragging:function(){var t=this._paperDrag;this._graphDrag.resetCells([]),this.$el.append(t.$el).removeClass("dragging"),t.$el.removeClass("dragging")},setPaperDragOffset:function(t,e,n){var i=n.cloneViewDeltaOrigin,r=n.cloneGeometryBBox,n=n.paperDragPadding,o=document,s=o.body,o=o.documentElement,s=s.scrollTop||o.scrollTop,o=t-i.x-r.width/2-n,t=e-i.y-r.height/2-n+s;return this._paperDrag.$el.offset({left:o,top:t}),{left:o,top:t}},onCloneSnapped:function(t,e,n){var i,r,o,s=this._dragging;s&&(r=n.snapped,i=n.tx,n=n.ty,r?(r=s.cloneBBox,o=s.cloneView,t.position(r.x+i,r.y+n,{silent:!0}),o.translate(),t.set("position",e,{silent:!0}),s.snapOffset={x:i,y:n}):s.snapOffset=null)},_dragging:null,onDragStart:function(t,e){var n,i,r,o=this.options,s=this._graphDrag,a=o.canDrag,c=o.snaplines,o=(o.usePaperGrid,t.model.graph.attributes.group);"function"==typeof a&&!a.call(this,t,e,void 0===o?null:o)||(this.$el.addClass("dragging"),a=e.clientX,o=e.clientY,n=(t=this.preparePaperForDragging(t,a,o)).cloneView,i=t.clone,this._dragging=t,r=this.getCloneArea(n,e,!1),_.util.assign(t,{clientX:a,clientY:o,validDropTarget:!1,cloneArea:r}),i.position(r.x,r.y,{silent:!0}),this.hasSnaplinesEnabled()&&(c.captureCursorOffset(n,e,r.x,r.y),this.listenTo(s,"change:position",this.onCloneSnapped.bind(this))),this.delegateDocumentEvents(null,e.data),this.trigger("element:dragstart",n,e,r.clone(),!1),n.stopListening(),this.isDragCanceled()&&(this.notifyDragEnd(n,e,r,!1),this._dragging=null))},onDrag:function(t){var e,n,i,r,o,s,a,c,l,u,h=this._dragging,p=this.options;h&&(t.preventDefault(),e=_.util.normalizeEvent(t),this.isDragCanceled()?(n=h.cloneView,r=h.validDropTarget,i=h.cloneArea,this.notifyDragEnd(n,e,i,r),this._dragging=null):(i=(n=h.cloneView).model,r=p.paper,o=p.snaplines,p=p.usePaperGrid,s=this.insideValidArea({x:e.clientX,y:e.clientY}),a=(c=(p=this.getCloneArea(n,e,s&&p)).center()).x,c=c.y,u=(l=r.localToClientPoint(a,c)).x,l=l.y,_.util.assign(h,{clientX:u,clientY:l,validDropTarget:s,cloneArea:p}),this.setPaperDragOffset(u,l,h),i.position(0,0,{silent:!0}),n.translate(),i.position(p.x,p.y,{stencil:this.cid}),this.hasSnaplinesEnabled()&&(s?o.snapWhileMoving(n,e,p.x,p.y):o.hide()),r.options.embeddingMode&&(n.eventData(e,{paper:r}),u=h.cloneViewEventData=n.eventData(e),s?n.processEmbedding(u,t,a,c):n.clearEmbedding(u)),n.startListening(),this.trigger("element:drag",n,e,p.clone(),s),n.stopListening(),this.isDragCanceled()&&(this.notifyDragEnd(n,e,p,s),this._dragging=null)))},onDragEnd:function(t){var e,n,i,r,o,s,a,c,l=this._dragging,u=this.options;l&&(t=_.util.normalizeEvent(t),a=l.clone,e=l.clientX,n=l.clientY,i=l.validDropTarget,r=l.cloneArea,o=l.cloneView,s=l.cloneBBox,l=l.snapOffset,c=s.x,s=s.y,l&&(c+=l.x,s+=l.y),a.position(c,s,{silent:!0}),this.notifyDragEnd(o,t,r,i),this.isDragCanceled()||(a=u.paper.clientToLocalPoint(e,n),c=!l,i?this.onDrop(o,t,a,c):this.onDropInvalid(o,t,a,c)),this._dragging=null)},notifyDragEnd:function(t,e,n,i){t.startListening(),this.trigger("element:dragend",t,e,n.clone(),i),t.stopListening(),this.undelegateDocumentEvents()},onDrop:function(t,e,n,i){var r=this.options,o=r.paper,s=r.graph,a=o.options.embeddingMode,c=t.model,r=(s.startBatch("stencil-drag"),r.dragEndClone(c));this.drop(r,n,i),a&&(t.eventData(e,{model:r,paper:o,initialParentId:_.util.uuid(),whenNotAllowed:"remove"}),t.finalizeEmbedding(t.eventData(e))),s.getCell(r)?(this.trigger("element:drop",r.findView(o),e,n.x,n.y),this.removePaperAfterDragging(c)):this.onDropInvalid(t,e,n,i),s.stopBatch("stencil-drag")},onDropInvalid:function(t,e,n,i){t=t.model,t=this.options.dragEndClone(t);this.trigger("drop:invalid",e,t,n.x,n.y),this.cancelDrag()},cancelDrag:function(){var t,e,n,i,r,o=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.options).dropAnimation,s=this._dragging,a=this.options,c=this._paperDrag;s&&(t=s.clone,r=s.cloneView,e=s.cloneViewEventData,n=s.paperDragInitialOffset,i=a.paper,a=a.snaplines,i.options.embeddingMode&&e&&r.clearEmbedding(e),this.hasSnaplinesEnabled()&&a.hide(),s.canceled=!0,o?(i=o.duration,r=o.easing,c.$el.animate(n,void 0===i?150:i,void 0===r?"swing":r,this.removePaperAfterDragging.bind(this,t))):this.removePaperAfterDragging(t))},isDragCanceled:function(){var t=this._dragging;return!!t&&Boolean(t.canceled)},drop:function(t,e,n){var i=this.options,r=i.paper,i=i.graph,o=t.getBBox(),e=new _.g.Point({x:e.x+o.x-o.width/2,y:e.y+o.y-o.height/2});n&&e.snapToGrid(r.options.gridSize),t.unset("z"),t.position(e.x,e.y),i.addCell(t,{stencil:this.cid})},insideValidArea:function(t){var e=this.options,n=e.paper,e=e.paperScroller,i=this.getDropArea(this.$el);return!(!(e=e?e.options.autoResizePaper?this.getDropArea(e.$el):(e=this.getDropArea(e.$el),this.getDropArea(n.$el).intersect(e)):this.getDropArea(n.$el))||!e.containsPoint(t)||i.containsPoint(t))},getDropArea:function(t){var t=h(t),e=t.offset(),n=e.left,e=e.top,i=document,r=i.body,i=i.documentElement,o=r.scrollTop||i.scrollTop,r=r.scrollLeft||i.scrollLeft,i=parseInt(t.css("border-left-width"),10),s=parseInt(t.css("border-top-width"),10);return new _.g.Rect({x:n+i-r,y:e+s-o,width:t.innerWidth(),height:t.innerHeight()})},getCloneArea:function(t,e,n){var i=this.options.paper,t=t.model,r=e.clientX,e=e.clientY,r=i.clientToLocalPoint(r,e),e=r.x,r=r.y,t=t.size(),o=t.width,t=t.height,e=e-o/2,r=r-t/2;return n&&(e=(n=i.snapToGrid(i.localToClientPoint(e,r))).x,r=n.y),new _.g.Rect(e,r,o,t)},filter:function(a){var c=this,l=1<arguments.length&&void 0!==arguments[1]?arguments[1]:this.options.search,t=Object.keys(this.papers).reduce(function(t,e){var n=c.papers[e],i=e===c.DEFAULT_GROUP?null:e,r=n.model.getCells().filter(function(t){var e=!1,e=_.util.isFunction(l)?l.call(c,t,a,i,c):c.isCellMatched(t,a,l,a.toLowerCase()!==a),t=n.findViewByModel(t);return t&&t.vel.toggleClass("unmatched",!e),e}),o=!_.util.isEmpty(r),s=c.options,s=((_.util.result(s,"paperOptions")||{}).model||new _.dia.Graph).resetCells(r);return c.trigger("filter",s,e,a),c.isLayoutEnabled()&&c.layoutGroup(s,c.getGroup(e)),c.$groups[e]&&c.$groups[e].toggleClass("unmatched",!o),c.fitPaperToContent(n),t||o},!1);this.$el.toggleClass("not-found",!t)},isCellMatched:function(n,i,r,o){return!i||Object.keys(r).some(function(t){var e=r[t];return("*"==t||n.get("type")==t)&&e.some(function(t){t=_.util.getByPath(n.attributes,t,"/");return null!=t&&(t=t.toString(),0<=(t=o?t:t.toLowerCase()).indexOf(i))})})},fitPaperToContent:function(t){var e=this.options,n=t.getComputedSize().width,n=_.util.assign({minWidth:n,padding:e.paperPadding},e.contentOptions);t.fitToContent(n)},getGroup:function(t){return this.options.groups&&this.options.groups[t]||{}},onSearch:function(t){t=t.target.value;this.$el.toggleClass("stencil-filtered",0<t.length),this.filter(t,this.options.search)},pointerFocusIn:function(){this.$el.addClass("is-focused")},pointerFocusOut:function(){this.$el.removeClass("is-focused")},onGroupLabelClick:function(t){if("touchstart"===t.type)this._groupLabelClicked=!0;else if(this._groupLabelClicked&&"click"===t.type)return void(this._groupLabelClicked=!1);t=h(t.target).closest(".group");this.toggleGroup(t.data("name"))},toggleGroup:function(t){this.isGroupOpen(t)?this.closeGroup(t):this.openGroup(t)},closeGroup:function(t){var e=this.$groups[t];e&&this.isGroupOpen(t)&&(this.trigger("group:close",t),e.addClass("closed"))},openGroup:function(t){var e=this.$groups[t];e&&!this.isGroupOpen(t)&&(this.trigger("group:open",t),e.removeClass("closed"))},isGroupOpen:function(t){t=this.$groups[t];return!!t&&!t.hasClass("closed")},closeGroups:function(){Object.keys(this.$groups).forEach(function(t){this.closeGroup(t)},this)},openGroups:function(){Object.keys(this.$groups).forEach(function(t){this.openGroup(t)},this)},onRemove:function(){this.dispose()},dispose:function(){_.util.invoke(this.papers,"remove"),this.papers={},this._paperDrag&&(this._paperDrag.remove(),this._paperDrag=null),this.undelegateDocumentEvents()}});G.Stencil=d}(this.joint.ui=this.joint.ui||{},$,joint);