/*! JointJS+ v3.6.3 - HTML5 Diagramming Framework

Copyright (c) 2022 client IO

 2022-12-09 


This Source Code Form is subject to the terms of the JointJS+ License
, v. 2.0. If a copy of the JointJS+ License was not distributed with this
file, You can obtain one at http://jointjs.com/license/rappid_v2.txt
 or from the JointJS+ archive as was distributed by client IO. See the LICENSE file.*/


this.joint=this.joint||{},function(e,a,R,y){"use strict";a=a&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a;var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function D(e,t){return e(t={exports:{}},t.exports),t.exports}function _(e){return e&&e.Math==Math&&e}function l(e){try{return!!e()}catch(e){return!0}}function N(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}function X(e){return le?he(e):function(){return fe.apply(e,arguments)}}function r(e){if("Function"===d(e))return X(e)}function z(e){if(xe(e))throw be("Can't call method on "+e);return e}function Y(e){return ve(z(e))}function i(e,t){return arguments.length<2?(i=v[e],f(i)?i:void 0):v[e]&&v[e][t];var i}function G(e){return Re(z(e))}function B(e){return"Symbol("+(void 0===e?"":e)+")_"+Xe(++_e+Ne,36)}function n(e){var t;return k(ze,e)&&(Ee||"string"==typeof ze[e])||(t="Symbol."+e,Ee&&k(Ye,e)?ze[e]=Ye[e]:ze[e]=(Pe&&Ge?Ge:Be)(t)),ze[e]}function $(e){return e=He(e,"string"),Me(e)?e:e+""}function U(e){return ft[e]||(ft[e]=B(e))}function H(e,t,i,n){var r=(n=n||{}).enumerable,a=void 0!==n.name?n.name:t;if(f(i)&&vt(i,a,n),n.global)r?e[t]=i:Fe(t,i);else{try{n.unsafe?e[t]&&(r=!0):delete e[t]}catch(e){}r?e[t]=i:P.f(e,t,{value:i,enumerable:!1,configurable:!n.nonConfigurable,writable:!n.nonWritable})}return e}function K(e,t){return(e=kt(e))<0?wt(e+t,0):Et(e,t)}function W(e){return Lt(e.length)}function q(o){return function(e,t,i){var n,r=Y(e),a=W(r),s=K(i,a);if(o&&t!=t){for(;s<a;)if((n=r[s++])!=n)return!0}else for(;s<a;s++)if((o||s in r)&&r[s]===t)return o||s||0;return!o&&-1}}function J(e,t){var i,n=Y(e),r=0,a=[];for(i in n)!k(ht,i)&&k(n,i)&&Ot(a,i);for(;t.length>r;)!k(n,i=t[r++])||~Mt(a,i)||Ot(a,i);return a}function Z(e,t){return(e=Dt[Rt(e)])==Nt||e!=_t&&(f(t)?l(t):!!t)}function s(e,t){var i,n,r,a=e.target,s=e.global,o=e.stat,l=s?v:o?v[a]||Fe(a,{}):(v[a]||{}).prototype;if(l)for(i in t){if(n=t[i],r=e.dontCallGetSet?(r=zt(l,i))&&r.value:l[i],!Xt(s?i:a+(o?".":"#")+i,e.forced)&&void 0!==r){if(typeof n==typeof r)continue;for(var c=n,u=r,d=m=p=g=h=f=void 0,f=It(u),h=P.f,g=Qe.f,p=0;p<f.length;p++){var m=f[p];k(c,m)||d&&k(d,m)||h(c,m,g(u,m))}}(e.sham||r&&r.sham)&&lt(n,"sham",!0),H(l,i,n,e)}}function Q(e,t){var i=[][e];return!!i&&l(function(){i.call(null,t||function(){return 1},1)})}function ee(e,t){return b(e),void 0===t?e:le?Gt(e,t):function(){return e.apply(t,arguments)}}function te(){}function ie(e){if(!f(e))return!1;try{return qt(te,Wt,e),!0}catch(e){return!1}}function ne(e){if(!f(e))return!1;switch(Kt(e)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return Qt||!!Zt(Jt,dt(e))}catch(e){return!0}}function re(e,t){return new(ni(e))(0===t?0:t)}function o(f){var h=1==f,g=2==f,p=3==f,m=4==f,y=6==f,v=7==f,x=5==f||y;return function(e,t,i,n){for(var r,a,s=G(e),o=ve(s),l=ee(t,i),c=W(o),u=0,t=n||re,d=h?t(e,c):g||v?t(e,0):void 0;u<c;u++)if((x||u in o)&&(a=l(r=o[u],u,s),f))if(h)d[u]=a;else if(a)switch(f){case 3:return!0;case 5:return r;case 6:return u;case 2:ri(d,r)}else switch(f){case 4:return!1;case 7:ri(d,r)}return y?-1:p||m?m:d}}var ae,se,c,oe,v=_("object"==typeof globalThis&&globalThis)||_("object"==typeof window&&window)||_("object"==typeof self&&self)||_("object"==typeof t&&t)||function(){return this}()||Function("return this")(),u=!l(function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}),le=!l(function(){var e=function(){}.bind();return"function"!=typeof e||e.hasOwnProperty("prototype")}),ce=Function.prototype.call,x=le?ce.bind(ce):function(){return ce.apply(ce,arguments)},t={}.propertyIsEnumerable,ue=Object.getOwnPropertyDescriptor,de={f:ue&&!t.call({1:2},1)?function(e){e=ue(this,e);return!!e&&e.enumerable}:t},t=Function.prototype,fe=t.call,he=le&&t.bind.bind(fe,fe),ge=X({}.toString),pe=X("".slice),d=function(e){return pe(ge(e),8,-1)},me=Object,ye=r("".split),ve=l(function(){return!me("z").propertyIsEnumerable(0)})?function(e){return"String"==d(e)?ye(e,""):me(e)}:me,xe=function(e){return null==e},be=TypeError,t="object"==typeof document&&document.all,t={all:t,IS_HTMLDDA:void 0===t&&void 0!==t},Se=t.all,f=t.IS_HTMLDDA?function(e){return"function"==typeof e||e===Se}:function(e){return"function"==typeof e},ke=t.all,h=t.IS_HTMLDDA?function(e){return"object"==typeof e?null!==e:f(e)||e===ke}:function(e){return"object"==typeof e?null!==e:f(e)},we=r({}.isPrototypeOf),t=i("navigator","userAgent")||"",g=v.process,p=v.Deno,g=g&&g.versions||p&&p.version,p=g&&g.v8,m=L=!(L=p?0<(w=p.split("."))[0]&&w[0]<4?1:+(w[0]+w[1]):L)&&t&&(!(w=t.match(/Edge\/(\d+)/))||74<=w[1])&&(w=t.match(/Chrome\/(\d+)/))?+w[1]:L,Ee=!!Object.getOwnPropertySymbols&&!l(function(){var e=Symbol();return!String(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&m&&m<41}),Pe=Ee&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,Le=Object,Me=Pe?function(e){return"symbol"==typeof e}:function(e){var t=i("Symbol");return f(t)&&we(t.prototype,Le(e))},Oe=String,Ae=function(e){try{return Oe(e)}catch(e){return"Object"}},Ce=TypeError,b=function(e){if(f(e))return e;throw Ce(Ae(e)+" is not a function")},je=function(e,t){e=e[t];return xe(e)?void 0:b(e)},Te=TypeError,Ve=function(e,t){var i,n;if("string"===t&&f(i=e.toString)&&!h(n=x(i,e)))return n;if(f(i=e.valueOf)&&!h(n=x(i,e)))return n;if("string"!==t&&f(i=e.toString)&&!h(n=x(i,e)))return n;throw Te("Can't convert object to primitive value")},Ie=Object.defineProperty,Fe=function(t,i){try{Ie(v,t,{value:i,configurable:!0,writable:!0})}catch(e){v[t]=i}return i},g="__core-js_shared__",S=v[g]||Fe(g,{}),p=D(function(e){(e.exports=function(e,t){return S[e]||(S[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.25.5",mode:"global",copyright:"© 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.25.5/LICENSE",source:"https://github.com/zloirock/core-js"})}),Re=Object,De=r({}.hasOwnProperty),k=Object.hasOwn||function(e,t){return De(G(e),t)},_e=0,Ne=Math.random(),Xe=r(1..toString),ze=p("wks"),Ye=v.Symbol,Ge=Ye&&Ye.for,Be=Pe?Ye:Ye&&Ye.withoutSetter||B,$e=TypeError,Ue=n("toPrimitive"),He=function(e,t){if(!h(e)||Me(e))return e;var i=je(e,Ue);if(i){if(i=x(i,e,t=void 0===t?"default":t),!h(i)||Me(i))return i;throw $e("Can't convert object to primitive value")}return Ve(e,t=void 0===t?"number":t)},Ke=v.document,We=h(Ke)&&h(Ke.createElement),qe=function(e){return We?Ke.createElement(e):{}},Je=!u&&!l(function(){return 7!=Object.defineProperty(qe("div"),"a",{get:function(){return 7}}).a}),Ze=Object.getOwnPropertyDescriptor,Qe={f:u?Ze:function(e,t){if(e=Y(e),t=$(t),Je)try{return Ze(e,t)}catch(e){}if(k(e,t))return N(!x(de.f,e,t),e[t])}},w=u&&l(function(){return 42!=Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype}),et=String,tt=TypeError,E=function(e){if(h(e))return e;throw tt(et(e)+" is not an object")},it=TypeError,nt=Object.defineProperty,rt=Object.getOwnPropertyDescriptor,at="enumerable",st="configurable",ot="writable",P={f:u?w?function(e,t,i){var n;return E(e),t=$(t),E(i),"function"==typeof e&&"prototype"===t&&"value"in i&&ot in i&&!i[ot]&&((n=rt(e,t))&&n[ot]&&(e[t]=i.value,i={configurable:(st in i?i:n)[st],enumerable:(at in i?i:n)[at],writable:!1})),nt(e,t,i)}:nt:function(e,t,i){if(E(e),t=$(t),E(i),Je)try{return nt(e,t,i)}catch(e){}if("get"in i||"set"in i)throw it("Accessors not supported");return"value"in i&&(e[t]=i.value),e}},lt=u?function(e,t,i){return P.f(e,t,N(1,i))}:function(e,t,i){return e[t]=i,e},L=Function.prototype,g=u&&Object.getOwnPropertyDescriptor,M=k(L,"name"),ct={EXISTS:M,PROPER:M&&"something"===function(){}.name,CONFIGURABLE:M&&(!u||g(L,"name").configurable)},ut=r(Function.toString),dt=(f(S.inspectSource)||(S.inspectSource=function(e){return ut(e)}),S.inspectSource),M=v.WeakMap,g=f(M)&&/native code/.test(String(M)),ft=p("keys"),ht={},gt="Object already initialized",pt=v.TypeError,L=v.WeakMap,mt=g||S.state?((c=S.state||(S.state=new L)).get=c.get,c.has=c.has,c.set=c.set,ae=function(e,t){if(c.has(e))throw pt(gt);return t.facade=e,c.set(e,t),t},se=function(e){return c.get(e)||{}},function(e){return c.has(e)}):(oe=U("state"),ht[oe]=!0,ae=function(e,t){if(k(e,oe))throw pt(gt);return t.facade=e,lt(e,oe,t),t},se=function(e){return k(e,oe)?e[oe]:{}},function(e){return k(e,oe)}),yt={set:ae,get:se,has:mt,enforce:function(e){return mt(e)?se(e):ae(e,{})},getterFor:function(t){return function(e){if(h(e)&&(e=se(e)).type===t)return e;throw pt("Incompatible receiver, "+t+" required")}}},vt=D(function(e){var n=ct.CONFIGURABLE,r=yt.enforce,t=yt.get,a=Object.defineProperty,s=u&&!l(function(){return 8!==a(function(){},"length",{value:8}).length}),o=String(String).split("String"),e=e.exports=function(e,t,i){"Symbol("===String(t).slice(0,7)&&(t="["+String(t).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),i&&i.getter&&(t="get "+t),i&&i.setter&&(t="set "+t),(!k(e,"name")||n&&e.name!==t)&&(u?a(e,"name",{value:t,configurable:!0}):e.name=t),s&&i&&k(i,"arity")&&e.length!==i.arity&&a(e,"length",{value:i.arity});try{i&&k(i,"constructor")&&i.constructor?u&&a(e,"prototype",{writable:!1}):e.prototype&&(e.prototype=void 0)}catch(e){}i=r(e);return k(i,"source")||(i.source=o.join("string"==typeof t?t:"")),e};Function.prototype.toString=e(function(){return f(this)&&t(this).source||dt(this)},"toString")}),xt=Math.ceil,bt=Math.floor,St=Math.trunc||function(e){e=+e;return(0<e?bt:xt)(e)},kt=function(e){e=+e;return e!=e||0==e?0:St(e)},wt=Math.max,Et=Math.min,Pt=Math.min,Lt=function(e){return 0<e?Pt(kt(e),9007199254740991):0},M={includes:q(!0),indexOf:q(!1)},Mt=M.indexOf,Ot=r([].push),At=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],Ct=At.concat("length","prototype"),jt={f:Object.getOwnPropertyNames||function(e){return J(e,Ct)}},Tt={f:Object.getOwnPropertySymbols},Vt=r([].concat),It=i("Reflect","ownKeys")||function(e){var t=jt.f(E(e)),i=Tt.f;return i?Vt(t,i(e)):t},Ft=/#|\.prototype\./,Rt=Z.normalize=function(e){return String(e).replace(Ft,".").toLowerCase()},Dt=Z.data={},_t=Z.NATIVE="N",Nt=Z.POLYFILL="P",Xt=Z,zt=Qe.f,Yt=r([].join),p=ve!=Object,g=Q("join",","),Gt=(s({target:"Array",proto:!0,forced:p||!g},{join:function(e){return Yt(Y(this),void 0===e?",":e)}}),r(r.bind)),Bt=Array.isArray||function(e){return"Array"==d(e)},L={},p=(L[n("toStringTag")]="z","[object z]"===String(L)),$t=n("toStringTag"),Ut=Object,Ht="Arguments"==d(function(){return arguments}()),Kt=p?d:function(e){var t;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(t=function(e,t){try{return e[t]}catch(e){}}(e=Ut(e),$t))?t:Ht?d(e):"Object"==(t=d(e))&&f(e.callee)?"Arguments":t},Wt=[],qt=i("Reflect","construct"),Jt=/^\s*(?:class|function)\b/,Zt=r(Jt.exec),Qt=!Jt.exec(te),ei=(ne.sham=!0,!qt||l(function(){var e;return ie(ie.call)||!ie(Object)||!ie(function(){e=!0})||e})?ne:ie),ti=n("species"),ii=Array,ni=function(e){var t;return Bt(e)&&(t=e.constructor,(ei(t)&&(t===ii||Bt(t.prototype))||h(t)&&null===(t=t[ti]))&&(t=void 0)),void 0===t?ii:t},ri=r([].push),g={forEach:o(0),map:o(1),filter:o(2),some:o(3),every:o(4),find:o(5),findIndex:o(6),filterReject:o(7)},ai=g.forEach,si=Q("forEach")?[].forEach:function(e){return ai(this,e,1<arguments.length?arguments[1]:void 0)};s({target:"Array",proto:!0,forced:[].forEach!=si},{forEach:si});function oi(){}function li(e){e.write(bi("")),e.close();var t=e.parentWindow.Object;return e=null,t}function ci(e){wi[ki][e]=!0}function ui(e,t){var i,e=E(e).constructor;if(void 0===e||xe(i=E(e)[ji]))return t;if(ei(e=i))return e;throw Ci(Ae(e)+" is not a constructor")}p||H(Object.prototype,"toString",p?{}.toString:function(){return"[object "+Kt(this)+"]"},{unsafe:!0});var di,fi,hi,gi=Object.keys||function(e){return J(e,At)},pi={f:u&&!w?Object.defineProperties:function(e,t){E(e);for(var i,n=Y(t),r=gi(t),a=r.length,s=0;s<a;)P.f(e,i=r[s++],n[i]);return e}},mi=i("document","documentElement"),yi="prototype",vi="script",xi=U("IE_PROTO"),bi=function(e){return"<"+vi+">"+e+"</"+vi+">"},Si=function(){try{di=new ActiveXObject("htmlfile")}catch(e){}Si="undefined"==typeof document||document.domain&&di?li(di):(e=qe("iframe"),t="java"+vi+":",e.style.display="none",mi.appendChild(e),e.src=String(t),(t=e.contentWindow.document).open(),t.write(bi("document.F=Object")),t.close(),t.F);for(var e,t,i=At.length;i--;)delete Si[yi][At[i]];return Si()},L=(ht[xi]=!0,Object.create||function(e,t){var i;return null!==e?(oi[yi]=E(e),i=new oi,oi[yi]=null,i[xi]=e):i=Si(),void 0===t?i:pi.f(i,t)}),p=P.f,ki=n("unscopables"),wi=Array.prototype,Ei=(null==wi[ki]&&p(wi,ki,{configurable:!0,value:L(null)}),g.findIndex),w="findIndex",Pi=!0,O=(w in[]&&Array(1)[w](function(){Pi=!1}),s({target:"Array",proto:!0,forced:Pi},{findIndex:function(e){return Ei(this,e,1<arguments.length?arguments[1]:void 0)}}),ci(w),"process"==d(v.process)),Li=String,Mi=TypeError,Oi=Object.setPrototypeOf||("__proto__"in{}?function(){var i,n=!1,e={};try{(i=r(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))(e,[]),n=e instanceof Array}catch(e){}return function(e,t){return E(e),function(e){if("object"==typeof e||f(e))return;throw Mi("Can't set "+Li(e)+" as a prototype")}(t),n?i(e,t):e.__proto__=t,e}}():void 0),p=P.f,L=n("toStringTag"),w=n("species"),Ai=TypeError,Ci=TypeError,ji=n("species"),A=Function.prototype,Ti=A.apply,Vi=A.call,Ii="object"==typeof Reflect&&Reflect.apply||(le?Vi.bind(Ti):function(){return Vi.apply(Ti,arguments)}),Fi=r([].slice),Ri=TypeError,A=/(?:ipad|iphone|ipod).*applewebkit/i.test(t),C=v.setImmediate,j=v.clearImmediate,Di=v.process,_i=v.Dispatch,Ni=v.Function,T=v.MessageChannel,Xi=v.String,zi=0,Yi={},Gi="onreadystatechange";try{fi=v.location}catch(e){}function Bi(e){return function(){on(e)}}function $i(e){on(e.data)}function Ui(e){v.postMessage(Xi(e),fi.protocol+"//"+fi.host)}function Hi(){this.head=null,this.tail=null}function Ki(e){var i,n;this.promise=new e(function(e,t){if(void 0!==i||void 0!==n)throw xn("Bad Promise constructor");i=e,n=t}),this.resolve=b(i),this.reject=b(n)}function Wi(e,t){var i,n,r,a,s=t.value,o=t.state==Rn,l=o?e.ok:e.fail,c=e.resolve,u=e.reject,d=e.domain;try{l?(o||(t.rejection===Nn&&(a=t,x(Sn,v,function(){var e=a.facade;O?Cn.emit("rejectionHandled",e):Yn(Fn,e,a.value)})),t.rejection=_n),!0===l?i=s:(d&&d.enter(),i=l(s),d&&(d.exit(),r=!0)),i===e.promise?u(On("Promise-chain cycle")):(n=Xn(i))?x(n,i,c,u):c(i)):u(s)}catch(e){d&&!r&&d.exit(),u(e)}}var qi,Ji,Zi,Qi,en,tn,nn,rn,an,sn,on=function(e){var t;k(Yi,e)&&(t=Yi[e],delete Yi[e],t())},T=(C&&j||(C=function(e){var t=arguments.length,i=1;if(t<i)throw Ri("Not enough arguments");var n=f(e)?e:Ni(e),r=Fi(arguments,1);return Yi[++zi]=function(){Ii(n,void 0,r)},hi(zi),zi},j=function(e){delete Yi[e]},O?hi=function(e){Di.nextTick(Bi(e))}:_i&&_i.now?hi=function(e){_i.now(Bi(e))}:T&&!A?(V=(T=new T).port2,T.port1.onmessage=$i,hi=ee(V.postMessage,V)):v.addEventListener&&f(v.postMessage)&&!v.importScripts&&fi&&"file:"!==fi.protocol&&!l(Ui)?(hi=Ui,v.addEventListener("message",$i,!1)):hi=Gi in qe("script")?function(e){mi.appendChild(qe("script"))[Gi]=function(){mi.removeChild(this),on(e)}}:function(e){setTimeout(Bi(e),0)}),{set:C,clear:j}),V=/ipad|iphone|ipod/i.test(t)&&void 0!==v.Pebble,C=/web0s(?!.*chrome)/i.test(t),j=Qe.f,ln=T.set,t=v.MutationObserver||v.WebKitMutationObserver,cn=v.document,un=v.process,I=v.Promise,j=j(v,"queueMicrotask"),j=j&&j.value,dn=(j||(qi=function(){var e,t;for(O&&(e=un.domain)&&e.exit();Ji;){t=Ji.fn,Ji=Ji.next;try{t()}catch(e){throw Ji?Qi():Zi=void 0,e}}Zi=void 0,e&&e.enter()},Qi=A||O||C||!t||!cn?!V&&I&&I.resolve?((A=I.resolve(void 0)).constructor=I,nn=ee(A.then,A),function(){nn(qi)}):O?function(){un.nextTick(qi)}:(ln=ee(ln,v),function(){ln(qi)}):(en=!0,tn=cn.createTextNode(""),new t(qi).observe(tn,{characterData:!0}),function(){tn.data=en=!en})),j||function(e){e={fn:e,next:void 0};Zi&&(Zi.next=e),Ji||(Ji=e,Qi()),Zi=e}),fn=function(e){try{return{error:!1,value:e()}}catch(e){return{error:!0,value:e}}},hn=(Hi.prototype={add:function(e){e={item:e,next:null};this.head?this.tail.next=e:this.head=e,this.tail=e},get:function(){var e=this.head;if(e)return this.head=e.next,this.tail===e&&(this.tail=null),e.item}},Hi),F=v.Promise,gn="object"==typeof Deno&&Deno&&"object"==typeof Deno.version,pn=!gn&&!O&&"object"==typeof window&&"object"==typeof document,mn=(F&&F.prototype,n("species")),yn=!1,vn=f(v.PromiseRejectionEvent),C={CONSTRUCTOR:Xt("Promise",function(){var e=dt(F),t=e!==String(F);if(!t&&66===m)return!0;if(!m||m<51||!/native code/.test(e)){var e=new F(function(e){e(1)}),i=function(e){e(function(){},function(){})};if((e.constructor={})[mn]=i,!(yn=e.then(function(){})instanceof i))return!0}return!t&&(pn||gn)&&!vn}),REJECTION_EVENT:vn,SUBCLASSING:yn},xn=TypeError,bn={f:function(e){return new Ki(e)}},Sn=T.set,kn="Promise",V=C.CONSTRUCTOR,wn=C.REJECTION_EVENT,I=C.SUBCLASSING,En=yt.getterFor(kn),Pn=yt.set,A=F&&F.prototype,Ln=F,Mn=A,On=v.TypeError,An=v.document,Cn=v.process,jn=bn.f,Tn=jn,Vn=!!(An&&An.createEvent&&v.dispatchEvent),In="unhandledrejection",Fn="rejectionhandled",Rn=1,Dn=2,_n=1,Nn=2,Xn=function(e){var t;return!(!h(e)||!f(t=e.then))&&t},zn=function(i,r){i.notified||(i.notified=!0,dn(function(){for(var e,n,t=i.reactions;e=t.get();)Wi(e,i);i.notified=!1,r&&!i.rejection&&(n=i,x(Sn,v,function(){var e=n.facade,t=n.value,i=Gn(n);if(i&&(i=fn(function(){O?Cn.emit("unhandledRejection",t,e):Yn(In,e,t)}),n.rejection=O||Gn(n)?Nn:_n,i.error))throw i.value}))}))},Yn=function(e,t,i){var n;Vn?((n=An.createEvent("Event")).promise=t,n.reason=i,n.initEvent(e,!1,!0),v.dispatchEvent(n)):n={promise:t,reason:i},!wn&&(t=v["on"+e])?t(n):e===In&&function(e,t){var i=v.console;i&&i.error&&(1==arguments.length?i.error(e):i.error(e,t))}("Unhandled promise rejection",i)},Gn=function(e){return e.rejection!==_n&&!e.parent},Bn=function(t,i,n){return function(e){t(i,e,n)}},$n=function(e,t,i){e.done||(e.done=!0,(e=i?i:e).value=t,e.state=Dn,zn(e,!0))},Un=function(i,e,t){if(!i.done){i.done=!0,t&&(i=t);try{if(i.facade===e)throw On("Promise can't be resolved itself");var n=Xn(e);n?dn(function(){var t={done:!1};try{x(n,e,Bn(Un,t,i),Bn($n,t,i))}catch(e){$n(t,e,i)}}):(i.value=e,i.state=Rn,zn(i,!1))}catch(e){$n({done:!1},e,i)}}};if(V&&(Mn=(Ln=function(e){!function(e,t){if(we(t,e))return;throw Ai("Incorrect invocation")}(this,Mn),b(e),x(rn,this);var t=En(this);try{e(Bn(Un,t),Bn($n,t))}catch(e){$n(t,e)}}).prototype,(rn=function(e){Pn(this,{type:kn,done:!1,notified:!1,parent:!1,reactions:new hn,rejection:!1,state:0,value:void 0})}).prototype=H(Mn,"then",function(e,t){var i=En(this),n=jn(ui(this,Ln));return i.parent=!0,n.ok=!f(e)||e,n.fail=f(t)&&t,n.domain=O?Cn.domain:void 0,0==i.state?i.reactions.add(n):dn(function(){Wi(n,i)}),n.promise}),an=function(){var e=new rn,t=En(e);this.promise=e,this.resolve=Bn(Un,t),this.reject=Bn($n,t)},bn.f=jn=function(e){return e===Ln||void 0===e?new an:Tn(e)},f(F)&&A!==Object.prototype)){sn=A.then,I||H(A,"then",function(e,t){var i=this;return new Ln(function(e,t){x(sn,i,e,t)}).then(e,t)},{unsafe:!0});try{delete A.constructor}catch(e){}Oi&&Oi(A,Mn)}s({global:!0,constructor:!0,wrap:!0,forced:V},{Promise:Ln}),t=!(cn=kn),(j=(j=Ln)&&!t?j.prototype:j)&&!k(j,L)&&p(j,L,{configurable:!0,value:cn}),T=i(T=kn),I=P.f,u&&T&&!T[w]&&I(T,w,{configurable:!0,get:function(){return this}});function Hn(e,t,i){var n,r;E(e);try{if(!(n=je(e,"return"))){if("throw"===t)throw i;return}n=x(n,e)}catch(e){r=!0,n=e}if("throw"===t)throw i;if(r)throw n;E(n)}function Kn(e,t){this.stopped=e,this.result=t}function Wn(e,t,i){function n(e){return a&&Hn(a,"normal",e),new Kn(!0,e)}function r(e){return f?(E(e),p?m(e[0],e[1],n):m(e[0],e[1])):p?m(e,n):m(e)}var a,s,o,l,c,u,d=i&&i.that,f=!(!i||!i.AS_ENTRIES),h=!(!i||!i.IS_RECORD),g=!(!i||!i.IS_ITERATOR),p=!(!i||!i.INTERRUPTED),m=ee(t,d);if(h)a=e.iterator;else if(g)a=e;else{if(!(i=er(e)))throw ir(Ae(e)+" is not iterable");if(void 0!==(t=i)&&(qn.Array===t||Zn[Jn]===t)){for(s=0,o=W(e);s<o;s++)if((l=r(e[s]))&&we(nr,l))return;return}a=function(e,t){t=arguments.length<2?er(e):t;if(b(t))return E(x(t,e));throw tr(Ae(e)+" is not iterable")}(e,i)}for(c=(h?e:a).next;!(u=x(c,a)).done;){try{l=r(u.value)}catch(e){Hn(a,"throw",e)}if("object"==typeof l&&l&&we(nr,l))return}}var qn={},Jn=n("iterator"),Zn=Array.prototype,Qn=n("iterator"),er=function(e){if(!xe(e))return je(e,Qn)||je(e,"@@iterator")||qn[Kt(e)]},tr=TypeError,ir=TypeError,nr=Kn.prototype,rr=n("iterator"),ar=!1;try{var sr=0,or={next:function(){return{done:!!sr++}},return:function(){ar=!0}};or[rr]=function(){return this},Array.from(or,function(){throw 2})}catch(e){}A=C.CONSTRUCTOR||!function(e,t){if(!t&&!ar)return!1;var i=!1;try{var n={};n[rr]=function(){return{next:function(){return{done:i=!0}}}},e(n)}catch(e){}return i}(function(e){F.all(e).then(void 0,function(){})}),s({target:"Promise",stat:!0,forced:A},{all:function(e){var o=this,t=bn.f(o),l=t.resolve,c=t.reject,i=fn(function(){var n=b(o.resolve),r=[],a=0,s=1;Wn(e,function(e){var t=a++,i=!1;s++,x(n,o,e).then(function(e){i||(i=!0,r[t]=e,--s||l(r))},c)}),--s||l(r)});return i.error&&c(i.value),t.promise}}),V=C.CONSTRUCTOR,t=F&&F.prototype;s({target:"Promise",proto:!0,forced:V,real:!0},{catch:function(e){return this.then(void 0,e)}}),f(F)&&(p=i("Promise").prototype.catch,t.catch!==p&&H(t,"catch",p,{unsafe:!0})),s({target:"Promise",stat:!0,forced:A},{race:function(e){var i=this,n=bn.f(i),r=n.reject,t=fn(function(){var t=b(i.resolve);Wn(e,function(e){x(t,i,e).then(n.resolve,r)})});return t.error&&r(t.value),n.promise}});s({target:"Promise",stat:!0,forced:C.CONSTRUCTOR},{reject:function(e){var t=bn.f(this);return x(t.reject,void 0,e),t.promise}});function lr(e){if("Symbol"===Kt(e))throw TypeError("Cannot convert a Symbol value to a string");return pr(e)}function cr(t){return function(e){e=lr(z(e));return 1&t&&(e=mr(e,yr,"")),e=2&t?mr(e,vr,""):e}}var j=C.CONSTRUCTOR,L=(i("Promise"),s({target:"Promise",stat:!0,forced:j},{resolve:function(e){return e=e,E(t=this),h(e)&&e.constructor===t?e:((0,(t=bn.f(t)).resolve)(e),t.promise);var t}}),ct.EXISTS),cn=P.f,I=Function.prototype,ur=r(I.toString),dr=/function\b(?:\s|\/\*[\S\s]*?\*\/|\/\/[^\n\r]*[\n\r]+)*([^\s(/]*)/,fr=r(dr.exec),hr=(u&&!L&&cn(I,"name",{configurable:!0,get:function(){try{return fr(dr,ur(this))[1]}catch(e){return""}}}),v.isFinite),gr=(s({target:"Number",stat:!0},{isFinite:Number.isFinite||function(e){return"number"==typeof e&&hr(e)}}),r(1..valueOf)),pr=String,T="\t\n\v\f\r                　\u2028\u2029\ufeff",mr=r("".replace),or="["+T+"]",yr=RegExp("^"+or+or+"*"),vr=RegExp(or+or+"*$"),V={start:cr(1),end:cr(2),trim:cr(3)},t=jt.f,xr=Qe.f,br=P.f,Sr=V.trim,p="Number",kr=v[p],wr=kr.prototype,Er=v.TypeError,Pr=r("".slice),Lr=r("".charCodeAt),Mr=function(e){var t,i,n,r,a,s,o,l=He(e,"number");if(Me(l))throw Er("Cannot convert a Symbol value to a number");if("string"==typeof l&&2<l.length)if(l=Sr(l),43===(e=Lr(l,0))||45===e){if(88===(t=Lr(l,2))||120===t)return NaN}else if(48===e){switch(Lr(l,1)){case 66:case 98:i=2,n=49;break;case 79:case 111:i=8,n=55;break;default:return+l}for(a=(r=Pr(l,2)).length,s=0;s<a;s++)if((o=Lr(r,s))<48||n<o)return NaN;return parseInt(r,i)}return+l};if(Xt(p,!kr(" 0o1")||!kr("0b1")||kr("+0x1"))){for(var Or,Ar=function(e){var t,i,n,e=arguments.length<1?0:kr(function(e){e=He(e,"number");return"bigint"==typeof e?e:Mr(e)}(e)),r=this;return we(wr,r)&&l(function(){gr(r)})?(t=Object(e),i=r,n=Ar,Oi&&f(i=i.constructor)&&i!==n&&h(i=i.prototype)&&i!==n.prototype&&Oi(t,i),t):e},Cr=u?t(kr):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,isFinite,isInteger,isNaN,isSafeInteger,parseFloat,parseInt,fromString,range".split(","),jr=0;Cr.length>jr;jr++)k(kr,Or=Cr[jr])&&!k(Ar,Or)&&br(Ar,Or,xr(kr,Or));(Ar.prototype=wr).constructor=Ar,H(v,p,Ar,{constructor:!0})}function Tr(e,t,i){(t=$(t))in e?P.f(e,t,N(0,i)):e[t]=i}function Vr(t){return 51<=m||!l(function(){var e=[];return(e.constructor={})[Rr]=function(){return{foo:1}},1!==e[t](Boolean).foo})}function Ir(t){if(t&&t.forEach!==si)try{lt(t,"forEach",si)}catch(e){t.forEach=si}}var Fr,Rr=n("species"),A=Vr("slice"),Dr=n("species"),_r=Array,Nr=Math.max,Xr=(s({target:"Array",proto:!0,forced:!A},{slice:function(e,t){var i,n,r,a=Y(this),s=W(a),o=K(e,s),l=K(void 0===t?s:t,s);if(Bt(a)&&(i=a.constructor,(i=ei(i)&&(i===_r||Bt(i.prototype))||h(i)&&null===(i=i[Dr])?void 0:i)===_r||void 0===i))return Fi(a,o,l);for(n=new(void 0===i?_r:i)(Nr(l-o,0)),r=0;o<l;o++,r++)o in a&&Tr(n,r,a[o]);return n.length=r,n}}),g.find),C="find",zr=!0,Yr=(C in[]&&Array(1)[C](function(){zr=!1}),s({target:"Array",proto:!0,forced:zr},{find:function(e){return Xr(this,e,1<arguments.length?arguments[1]:void 0)}}),ci(C),{CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}),j=qe("span").classList,L=j&&j.constructor&&j.constructor.prototype,cn=L===Object.prototype?void 0:L;for(Fr in Yr)Yr[Fr]&&Ir(v[Fr]&&v[Fr].prototype);Ir(cn);function Gr(c){return function(e,t,i,n){b(t);var r=G(e),a=ve(r),s=W(r),o=c?s-1:0,l=c?-1:1;if(i<2)for(;;){if(o in a){n=a[o],o+=l;break}if(o+=l,c?o<0:s<=o)throw Ur("Reduce of empty array with no initial value")}for(;c?0<=o:o<s;o+=l)o in a&&(n=t(n,a[o],o,r));return n}}function Br(e){if(h(t=e)&&(void 0!==(i=t[ta])?!!i:"RegExp"==d(t)))throw ia("The method doesn't accept regular expressions");var t,i;return e}var $r=M.includes,Ur=(s({target:"Array",proto:!0,forced:l(function(){return!Array(1).includes()})},{includes:function(e){return $r(this,e,1<arguments.length?arguments[1]:void 0)}}),ci("includes"),TypeError),Hr={left:Gr(!1),right:Gr(!0)}.left,Kr=(s({target:"Array",proto:!0,forced:!Q("reduce")||!O&&79<m&&m<83},{reduce:function(e){var t=arguments.length;return Hr(this,e,t,1<t?arguments[1]:void 0)}}),Function),Wr=r([].concat),qr=r([].join),Jr={},I=le?Kr.bind:function(s){var o=b(this),e=o.prototype,l=Fi(arguments,1),c=function(){var e=Wr(l,Fi(arguments));if(this instanceof c){var t=o,i=e.length,n=e;if(!k(Jr,i)){for(var r=[],a=0;a<i;a++)r[a]="a["+a+"]";Jr[i]=Kr("C,a","return new C("+qr(r,",")+")")}return Jr[i](t,n)}return o.apply(s,e)};return h(e)&&(c.prototype=e),c},Zr=(s({target:"Function",proto:!0,forced:Function.bind!==I},{bind:I}),M.indexOf),Qr=r([].indexOf),ea=!!Qr&&1/Qr([1],1,-0)<0,or=Q("indexOf"),ta=(s({target:"Array",proto:!0,forced:ea||!or},{indexOf:function(e){var t=1<arguments.length?arguments[1]:void 0;return ea?Qr(this,e,t)||0:Zr(this,e,t)}}),n("match")),ia=TypeError,na=n("match"),ra=r("".indexOf);s({target:"String",proto:!0,forced:!function(t){var i=/./;try{"/./"[t](i)}catch(e){try{return i[na]=!1,"/./"[t](i)}catch(e){}}return!1}("includes")},{includes:function(e){return!!~ra(lr(z(this)),lr(Br(e)),1<arguments.length?arguments[1]:void 0)}});s({target:"Object",stat:!0,forced:l(function(){gi(1)})},{keys:function(e){return gi(G(e))}});function aa(e){if(9007199254740991<e)throw ha("Maximum allowed index exceeded")}s({target:"Array",proto:!0},{fill:function(e){for(var t=G(this),i=W(t),n=arguments.length,r=K(1<n?arguments[1]:void 0,i),n=2<n?arguments[2]:void 0,a=void 0===n?i:K(n,i);r<a;)t[r++]=e;return t}}),ci("fill");var sa=g.filter,oa=(s({target:"Array",proto:!0,forced:!Vr("filter")},{filter:function(e){return sa(this,e,1<arguments.length?arguments[1]:void 0)}}),g.map),la=(s({target:"Array",proto:!0,forced:!Vr("map")},{map:function(e){return oa(this,e,1<arguments.length?arguments[1]:void 0)}}),V.trim),ca=v.parseInt,t=v.Symbol,ua=t&&t.iterator,da=/^[+-]?0x/i,fa=r(da.exec),p=8!==ca(T+"08")||22!==ca(T+"0x16")||ua&&!l(function(){ca(Object(ua))})?function(e,t){e=la(lr(e));return ca(e,t>>>0||(fa(da,e)?16:10))}:ca,ha=(s({global:!0,forced:parseInt!=p},{parseInt:p}),s({target:"Array",stat:!0},{isArray:Bt}),TypeError),ga=n("isConcatSpreadable"),A=51<=m||!l(function(){var e=[];return e[ga]=!1,e.concat()[0]!==e}),C=Vr("concat"),j=(s({target:"Array",proto:!0,arity:1,forced:!A||!C},{concat:function(e){for(var t,i,n,r,a,s=G(this),o=re(s,0),l=0,c=-1,u=arguments.length;c<u;c++)if(a=void 0,!h(r=n=-1===c?s:arguments[c])||(void 0!==(a=r[ga])?!a:!Bt(r)))aa(l+1),Tr(o,l++,n);else for(i=W(n),aa(l+i),t=0;t<i;t++,l++)t in n&&Tr(o,l,n[t]);return o.length=l,o}}),R.Generic.extend({markup:['<clipPath class="clip"><rect/></clipPath>','<g class="rotatable">','<g class="scalable"></g>','<g class="background"><rect/><text/></g>','<g class="axis">','<g class="y-axis"><path/><g class="ticks"></g></g>','<g class="x-axis"><path/><g class="ticks"></g></g>','<g class="markings"></g>',"</g>",'<g class="data"><g class="series"></g></g>','<g class="foreground">','<rect/><text class="caption"/><text class="subcaption"/>','<g class="legend"><g class="legend-items"></g></g>','<line class="guideline x-guideline" /><line class="guideline y-guideline" />',"</g>","</g>"].join(""),tickMarkup:'<g class="tick"><line/><text/></g>',pointMarkup:'<g class="point"><circle/><text/></g>',barMarkup:'<path class="bar"/>',markingMarkup:'<g class="marking"><rect/><text/></g>',serieMarkup:'<g><clipPath class="serie-clip"><rect/></clipPath><path/><g class="bars"></g><g class="points"></g></g>',legendItemMarkup:'<g class="legend-item"><circle/><text/></g>',defaults:y.util.deepSupplement({type:"chart.Plot",attrs:{".data path":{fill:"none",stroke:"black"},".data .bars rect":{fill:"none",stroke:"black"},".background rect":{fill:"white",stroke:"#e5e5e5",opacity:1},".background text":{fill:"black",text:"No data available.",ref:".","ref-x":.5,"ref-y":.5,"text-anchor":"middle","y-alignment":"middle",display:"none"},".foreground > rect":{fill:"white",stroke:"#e5e5e5",opacity:0,"pointer-events":"none"},".foreground .caption":{fill:"black",text:"",ref:".foreground > rect","ref-x":.5,"ref-y":10,"text-anchor":"middle","y-alignment":"middle","font-size":14},".foreground .subcaption":{fill:"black",text:"",ref:".foreground > rect","ref-x":.5,"ref-y":23,"text-anchor":"middle","y-alignment":"middle","font-size":10},".point":{display:"inline-block"},".point circle":{r:2,stroke:"black",fill:"black",opacity:.3},".point text":{fill:"black","font-size":8,"text-anchor":"middle",display:"none"},".axis path":{fill:"none",stroke:"black"},".axis .tick":{fill:"none",stroke:"black"},".y-axis .tick line":{fill:"none",stroke:"black",x2:2,y2:0,opacity:1},".x-axis .tick line":{fill:"none",stroke:"black",x2:0,y2:-3,opacity:1},".y-axis .tick text":{fill:"black",stroke:"none","font-size":10,"text-anchor":"end"},".x-axis .tick text":{fill:"black",stroke:"none","font-size":10,"text-anchor":"middle"},".y-axis .tick text > tspan":{dy:"-.5em",x:-5},".x-axis .tick text > tspan":{dy:".5em",x:0},".axis .markings":{fill:"black",stroke:"none","fill-opacity":1},".axis .markings text":{fill:"black","text-anchor":"end","font-size":10,dy:-5,dx:-5},".guideline":{"pointer-events":"none",display:"none"},".x-guideline":{stroke:"black",visibility:"hidden"},".y-guideline":{stroke:"black",visibility:"hidden"},".legend":{"ref-x":10,"ref-y":10},".legend-item text":{fill:"black",transform:"translate(14, 0)","font-size":11},".legend-item circle":{r:5,transform:"translate(5,5)"},".legend-item":{cursor:"pointer"},".legend-item.disabled circle":{fill:"gray"},".legend-item.disabled text":{opacity:.5}}},R.Generic.prototype.defaults),legendPosition:function(e,t){t=t||{},this.trigger("batch:start"),[".legend/ref-x",".legend/ref-y",".legend/ref-dx",".legend/ref-dy",".legend/x-alignment",".legend/y-alignment"].forEach(function(e){this.removeAttr(e,{silent:!0})},this);t=t.padding||10,t={n:{".legend":{"ref-x":.5,"x-alignment":-.5,"ref-y":t}},ne:{".legend":{"ref-dx":-t,"x-alignment":-.999,"ref-y":t}},e:{".legend":{"ref-dx":-t,"x-alignment":-.999,"ref-y":.5,"y-alignment":-.5}},se:{".legend":{"ref-dx":-t,"ref-dy":-t,"x-alignment":-.999,"y-alignment":-.999}},s:{".legend":{"ref-x":.5,"ref-dy":-t,"x-alignment":-.5,"y-alignment":-.999}},sw:{".legend":{"ref-x":t,"ref-dy":-t,"y-alignment":-.999}},w:{".legend":{"ref-x":t,"ref-y":.5,"y-alignment":-.5}},nw:{".legend":{"ref-x":t,"ref-y":t}},nnw:{".legend":{"ref-x":t,"ref-y":-t,"y-alignment":-.999}},nn:{".legend":{"ref-x":.5,"ref-y":-t,"x-alignment":-.5,"y-alignment":-.999}},nne:{".legend":{"ref-dx":-t,"ref-y":-t,"x-alignment":-.999,"y-alignment":-.999}},nnee:{".legend":{"ref-dx":t,"ref-y":-t,"y-alignment":-.999}},nee:{".legend":{"ref-y":t,"ref-dx":t}},ee:{".legend":{"ref-dx":t,"ref-y":.5,"y-alignment":-.5}},see:{".legend":{"ref-dx":t,"ref-dy":-t,"y-alignment":-.999}},ssee:{".legend":{"ref-dx":t,"ref-dy":t}},sse:{".legend":{"ref-dx":-t,"ref-dy":t,"x-alignment":-.999}},ss:{".legend":{"ref-x":.5,"ref-dy":t,"x-alignment":-.5}},ssw:{".legend":{"ref-x":t,"ref-dy":t}},ssww:{".legend":{"ref-x":-t,"ref-dy":t,"x-alignment":-.999}},sww:{".legend":{"ref-x":-t,"ref-dy":-t,"x-alignment":-.999,"y-alignment":-.999}},ww:{".legend":{"ref-x":-t,"ref-y":.5,"x-alignment":-.999,"y-alignment":-.5}},nww:{".legend":{"ref-x":-t,"ref-y":t,"x-alignment":-.999}},nnww:{".legend":{"ref-x":-t,"ref-y":-t,"x-alignment":-.999,"y-alignment":-.999}}};t[e]&&this.attr(t[e]),this.trigger("batch:stop")},addPoint:function(e,t,i){i=i||{};var n=this.get("series"),r=y.util.toArray(n).findIndex(function(e){return e.name===t});if(-1===r)throw new Error("Serie "+t+" was not found.");var a=y.util.cloneDeep(n[r]);a.data.push(e),Number.isFinite(i.maxLen)&&a.data.length>i.maxLen&&a.data.shift(),(n=n.slice())[r]=a,this.set("series",n,i)},lastPoint:function(t){var e=y.util.toArray(this.get("series")).find(function(e){return e&&e.name===t}).data;return e[e.length-1]},firstPoint:function(t){return y.util.toArray(this.get("series")).find(function(e){return e&&e.name===t}).data[0]}})),L=y.dia.ElementView.extend({events:{mousemove:"onMouseMove",mouseout:"onMouseOut"},presentationAttributes:y.dia.ElementView.addPresentationAttributes({series:["UPDATE"],interpolate:["UPDATE"],padding:["UPDATE"],canvas:["UPDATE"],markings:["UPDATE"],axis:["UPDATE"]}),initialize:function(){y.dia.ElementView.prototype.initialize.apply(this,arguments),this.on("cell:pointerdown",this.onPointerDown,this),this._disabledSeries=[]},renderMarkup:function(){y.dia.ElementView.prototype.renderMarkup.apply(this,arguments),this.elDataClipPath=this.$(".clip")[0],this.elDataClipPathRect=this.elDataClipPath.firstChild,this.elBackgroundRect=this.$(".background rect")[0],this.elBackgroundText=this.$(".background text")[0],this.elForeground=this.$(".foreground")[0],this.elForegroundRect=this.$(".foreground rect")[0],this.elDataSeries=this.$(".data .series")[0],this.elYAxisPath=this.$(".y-axis path")[0],this.elYAxisTicks=this.$(".y-axis .ticks")[0],this.elXAxisPath=this.$(".x-axis path")[0],this.elXAxisTicks=this.$(".x-axis .ticks")[0],this.elMarkings=this.$(".axis .markings")[0],this.elXGuideline=this.$(".x-guideline")[0],this.elYGuideline=this.$(".y-guideline")[0],this.elLegend=this.$(".legend")[0],this.elLegendItems=this.$(".legend-items")[0],this.elTick=y.V(this.model.tickMarkup),this.elMarking=y.V(this.model.markingMarkup),this.elLegendItem=y.V(this.model.legendItemMarkup),this.elPoint=y.V(this.model.pointMarkup),this.elBar=y.V(this.model.barMarkup),this.elSerie=y.V(this.model.serieMarkup),this.elDataClipPath.id="clip_"+this.cid,y.V(this.$(".data")[0]).attr("clip-path","url(#"+this.elDataClipPath.id+")"),y.V(this.elMarkings).attr("clip-path","url(#"+this.elDataClipPath.id+")")},update:function(){var e=this.filterSeries(),t=(this.calculateStats(e),this.model.get("size")),i=t.width,t=t.height,n=(this.canvas=y.util.assign({x:0,y:0,width:i,height:t},this.model.get("canvas")),{top:0,right:0,bottom:0,left:0}),r=this.model.get("padding"),r=y.util.isObject(r)?y.util.assign({},n,r):void 0!==r?{top:r,right:2*r,bottom:2*r,left:r}:n,n=(this.canvas=y.g.rect(this.canvas).moveAndExpand(y.g.rect(r.left,r.top,-r.right,-r.bottom)),{x:0,y:0,width:i,height:t});y.V(this.elDataClipPathRect).attr(n),y.V(this.elBackgroundRect).attr(n),y.V(this.elForegroundRect).attr(n),this.updateAxis(),this.updateMarkings(),this.isEmpty()?a(this.elBackgroundText).show():a(this.elBackgroundText).hide(),this.updateSeries(e),this.updateLegend(),y.dia.ElementView.prototype.update.apply(this,arguments)},calculateStats:function(e){e=e||this.model.get("series");var r=[],a=[],s={},o={},l={},e=(y.util.toArray(e).forEach(function(t,e){var i,n=l[t.name||e]||(l[t.name||e]={});n.decreasingX=!0,n.decreasingY=!0,n.nonDecreasingX=!0,n.nonDecreasingY=!0,y.util.forIn(t.data,function(e){n.minX=void 0===n.minX?e.x:Math.min(n.minX,e.x),n.maxX=void 0===n.maxX?e.x:Math.max(n.maxX,e.x),n.minY=void 0===n.minY?e.y:Math.min(n.minY,e.y),n.maxY=void 0===n.maxY?e.y:Math.max(n.maxY,e.y),i&&(n.decreasingX=n.decreasingX&&e.x<i.x,n.decreasingY=n.decreasingY&&e.y<i.y,n.nonDecreasingX=n.nonDecreasingX&&e.x>=i.x,n.nonDecreasingY=n.nonDecreasingY&&e.y>=i.y),r.includes(e.x)||r.push(e.x),a.includes(e.y)||a.push(e.y),(s[e.x]||(s[e.x]=[])).push({serie:t,x:e.x,y:e.y}),(o[e.y]||(o[e.y]=[])).push({serie:t,x:e.x,y:e.y}),i=e})}),this.model.get("axis")||{}),t=e["x-axis"]||{},e=e["y-axis"]||{};this.stats={minX:void 0===t.min?r.reduce(function(e,t){return t<e?t:e},1/0):t.min,maxX:void 0===t.max?r.reduce(function(e,t){return e<t?t:e},-1/0):t.max,minY:void 0===e.min?a.reduce(function(e,t){return t<e?t:e},1/0):e.min,maxY:void 0===e.max?a.reduce(function(e,t){return e<t?t:e},-1/0):e.max,bySerie:l,xValues:r,yValues:a,xMap:s,yMap:o}},isEmpty:function(){return!this.stats.xValues.length},updateSeries:function(e){var l,c,u,d,f;e=e||this.model.get("series"),this.elDataSeries.textContent="",this.isEmpty()||(l=[this.stats.minX,this.stats.maxX],c=[this.stats.minY,this.stats.maxY],u=[this.canvas.x,this.canvas.x+this.canvas.width],d=[this.canvas.y+this.canvas.height,this.canvas.y],f=this.model.get("attrs"),y.util.toArray(e).forEach(function(n,e){var t=n.data,r=[],i=this.elSerie.clone().attr("class",n.name||"serie-"+e),t=(y.V(this.elDataSeries).append(i),y.util.forIn(t,function(e){var t=y.g.scale.linear(l,u,e.x),i=y.g.scale.linear(c,d,e.y);r.push({x:t,y:i}),f[".point"]&&"none"!==f[".point"].display&&this.renderPoint(e,n),n.bars&&this.renderBar(e,n)}.bind(this)),i.findOne(".serie-clip")),a=this.model.get("size"),s=this.stats.bySerie[n.name||e],o=y.g.scale.linear(l,u,s.minX),s=y.g.scale.linear(l,u,s.maxX);t.findOne("rect").attr(y.g.rect(o,0,s-o,a.height)),n.bars||i.findOne("path").attr({d:this.seriePathData(r,n,e),"clip-path":"url(#"+t.node.id+")"})},this))},seriePathClipData:function(e,t){var i=this.model.get("size"),e=e[0];return["M",e.x,e.y,"V",i.height+10].join(" ")},renderBar:function(e,t){var i=[this.stats.minX,this.stats.maxX],n=[this.stats.minY,this.stats.maxY],r=[this.canvas.x,this.canvas.x+this.canvas.width],a=[this.canvas.y+this.canvas.height,this.canvas.y],i=y.g.scale.linear(i,r,e.x),r=y.g.scale.linear(n,a,e.y),s=t.bars.barWidth||.8,s=1<s?s:this.canvas.width/(this.stats.maxX-this.stats.minX)*s,a=y.g.scale.linear(n,a,0)-r,n=(n[0]===n[1]&&(r=this.canvas.y+this.canvas.height,a=0),e["top-rx"]||t.bars["top-rx"]),o=e["top-ry"]||t.bars["top-ry"],l=e["bottom-rx"]||t.bars["bottom-rx"],c=e["bottom-ry"]||t.bars["bottom-ry"],i={left:i,middle:i-s/2,right:i-s}[t.bars.align||"middle"],u=this.elBar.clone(),e=(u.attr({"data-serie":t.name,"data-x":e.x,"data-y":e.y,d:y.V.rectToPath({x:i,y:r,width:s,height:a,"top-rx":n,"top-ry":o,"bottom-rx":l,"bottom-ry":c})}),t.name||"serie-"+this.model.get("series").indexOf(t));return y.V(this.elDataSeries).findOne("."+e+" .bars").append(u),u.node},renderPoint:function(e,t){var i=[this.stats.minX,this.stats.maxX],n=[this.stats.minY,this.stats.maxY],r=[this.canvas.x,this.canvas.x+this.canvas.width],a=[this.canvas.y+this.canvas.height,this.canvas.y],i=y.g.scale.linear(i,r,e.x),r=y.g.scale.linear(n,a,e.y),a=(n[0]===n[1]&&(r=this.canvas.y+this.canvas.height),this.elPoint.clone()),n=(a.attr({"data-serie":t.name,"data-x":e.x,"data-y":e.y}),a.findOne("circle").attr({cx:i,cy:r}),a.findOne("text").attr({x:i,dy:r}).text(this.pointLabel(e,t)),t.name||"serie-"+this.model.get("series").indexOf(t));return y.V(this.elDataSeries).findOne("."+n+" .points").append(a),a.node},seriePathData:function(e,t,i){var n,r,a=e.length,s=[this.stats.minY,this.stats.maxY];if(s[0]===s[1])for(n=0;n<a;n++)e[n].y=this.canvas.y+this.canvas.height;switch(void 0===t.interpolate?this.model.get("interpolate"):t.interpolate){case"bezier":r=new y.g.Path(y.g.Curve.throughPoints(e));break;case"step":for((r=new y.g.Path).appendSegment(y.g.Path.createSegment("M",e[0].x,e[0].y)),n=1;n<a;n++)r.appendSegment(y.g.Path.createSegment("L",(e[n-1].x+e[n].x)/2,e[n-1].y)),r.appendSegment(y.g.Path.createSegment("L",(e[n-1].x+e[n].x)/2,e[n].y));r.appendSegment(y.g.Path.createSegment("L",e[a-1].x,e[a-1].y));break;case"stepBefore":for((r=new y.g.Path).appendSegment(y.g.Path.createSegment("M",e[0].x,e[0].y)),n=1;n<a;n++)r.appendSegment(y.g.Path.createSegment("L",e[n-1].x,e[n].y)),r.appendSegment(y.g.Path.createSegment("L",e[n].x,e[n].y));break;case"stepAfter":for((r=new y.g.Path).appendSegment(y.g.Path.createSegment("M",e[0].x,e[0].y)),n=1;n<a;n++)r.appendSegment(y.g.Path.createSegment("L",e[n].x,e[n-1].y)),r.appendSegment(y.g.Path.createSegment("L",e[n].x,e[n].y));break;default:for((r=new y.g.Path).appendSegment(y.g.Path.createSegment("M",e[0].x,e[0].y)),n=1;n<a;n++)r.appendSegment(y.g.Path.createSegment("L",e[n].x,e[n].y))}return this.fixPathForFill(r,e,t,i).serialize()},fixPathForFill:function(e,t,i,n){var r,a,s,o;return 0===t.length||i.hideFillBoundaries||this.stats.bySerie[i.name||n].nonDecreasingX&&(n=e.getSegment(0),e.replaceSegment(0,y.g.Path.createSegment("L",n.end.x,n.end.y)),n=i.fillPadding&&i.fillPadding.left||0,r=i.fillPadding&&i.fillPadding.right||0,a=i.fillPadding&&i.fillPadding.bottom||10,s=this.model.get("size"),o=t[0],t=t[t.length-1],e.insertSegment(0,y.g.Path.createSegment("M",t.x+r,s.height+a)),e.insertSegment(1,y.g.Path.createSegment("L",o.x-n,s.height+a)),e.insertSegment(2,y.g.Path.createSegment("L",o.x-n,o.y)),i.showRightFillBoundary&&(e.appendSegment(y.g.Path.createSegment("L",t.x+r,t.y)),e.appendSegment(y.g.Path.createSegment("Z")))),e},updateAxis:function(){var e,t,i,n=this.model.get("axis"),r=this.model.get("size"),a=r.height,s=r.width;function l(e,t,i,n,r,a,s,o){for(var l=i[1]-i[0],c=e.ticks||11,u=l/(c=0==l?1:c)/o,d=i[0],f=0;f<c;f++)h.call(this,e,t,i,n,r,a,s,d),d+=u}function h(e,t,i,n,r,a,s,o){var l=this.elTick.clone(),r=r.call(this,i,n,o);r>t.width||(a.call(this,l,r,t),a=s.call(this,o,i,n),l.findOne("text").text(this.tickLabel(a,e)))}y.V(this.elXAxisPath).attr("d",["M",0,a,"L",s,a].join(" ")),y.V(this.elYAxisPath).attr("d",["M",0,0,"L",0,a].join(" ")),this.elXAxisTicks.textContent="",this.elYAxisTicks.textContent="",this.isEmpty()||(s=[this.stats.minX,this.stats.maxX],a=[this.stats.minY,this.stats.maxY],e=[this.canvas.x,this.canvas.x+this.canvas.width],t=[0,this.canvas.height],i=n&&n["y-axis"]||{},n=n&&n["x-axis"]||{},function(e,t,i,n){function r(e,t,i){e.translate(t,i.height),y.V(this.elXAxisTicks).append(e)}function a(e,t,i){return y.g.scale.linear(e,t,i)}function s(e){return e}var o;e.ticks?(o=this.canvas.width/(t.width-2*this.canvas.x),l.call(this,e,t,i,n,a,r,s,o)):(o=this.stats.xValues,function(i,n,r,a,s,o,l,e){e.forEach(function(e,t){t%(i.tickStep||1)==0&&h.call(this,i,n,r,a,s,o,l,e)},this)}.call(this,e,t,i,n,a,r,s,o))}.call(this,n,r,s,e),function(e,t,i,n){var r=this.canvas.height/t.height;l.call(this,e,t,i,n,function(e,t,i){return e[0]===e[1]?this.canvas.y+this.canvas.height:y.g.scale.linear(e,t,i)},function(e,t){e.translate(0,t),y.V(this.elYAxisTicks).append(e)},function(e,t,i){e=t[1]-(e-t[0]);return e+=y.g.scale.linear(i,t,this.canvas.y)-t[0]},r)}.call(this,i,r,a,t))},tickLabel:function(e,t){var i;return y.util.isFunction(t.tickFormat)?t.tickFormat(e):(i=t.tickFormat||".1f",y.util.format.number(i,e)+(y.util.isFunction(t.tickSuffix)?t.tickSuffix(e):t.tickSuffix||""))},pointLabel:function(e,t){var i;return y.util.isFunction(t.pointFormat)?t.pointFormat(e):(i=t.pointFormat||".1f",y.util.format.number(i,e.y)+(t.pointSuffix||""))},updateMarkings:function(){this.elMarkings.textContent="";var e,u,d,f,h,g,p,t=this.model.get("markings");function m(e,t){return void 0===e?t:e}t&&0!==t.length&&(e=this.model.get("size"),u=e.width,d=e.height,f=[this.stats.minX,this.stats.maxX],h=[this.stats.minY,this.stats.maxY],g=[this.canvas.x,this.canvas.x+this.canvas.width],p=[this.canvas.y,this.canvas.y+this.canvas.height],y.util.toArray(t).forEach(function(e,t){var i=e.start||e.end,n=e.end||e.start,r=Math.min(m(i.x,this.stats.minX),m(n.x,this.stats.minX)),a=Math.max(m(i.x,this.stats.maxX),m(n.x,this.stats.maxX)),s=Math.min(m(i.y,this.stats.minY),m(n.y,this.stats.minY)),o=Math.max(m(i.y,this.stats.maxY),m(n.y,this.stats.maxY)),l=void 0===i.x||void 0===n.x,i=void 0===i.y||void 0===n.y,n=(l&&(g=[0,u]),i&&(p=[0,d]),y.g.scale.linear(f,g,r)),l=y.g.scale.linear(f,g,a),i=y.g.scale.linear(h,p,s),r=y.g.scale.linear(h,p,o),a=n,c=p[1]-r+p[0],l=l-n,n=r-i;if(h[0]===h[1]&&s===o){if(h[0]!==s)return;c=this.canvas.y+this.canvas.height,n=1}l=Math.max(l,1),n=Math.max(n,1),r=this.elMarking.clone(),r.findOne("rect").attr({x:a,y:c,width:l,height:n}),r.findOne("text").text(e.label||"").attr({x:a+l,y:c}),i=r.attr("class")+" "+(e.name||"marking-"+t);r.attr(y.util.assign({class:i},e.attrs)),y.V(this.elMarkings).append(r)},this))},updateLegend:function(){var e=this.model.get("series");this.elLegendItems.textContent="",y.util.toArray(e).forEach(function(e,t){var i;y.util.isFunction(e.showLegend)&&!e.showLegend(e,this.stats.bySerie[e.name||t])||!1!==e.showLegend&&(i=this.elLegendItem.clone(),this._disabledSeries.includes(e.name)&&i.addClass("disabled"),i.attr("data-serie",e.name),i.findOne("circle").attr({fill:this.getSerieColor(e.name)}),i.findOne("text").text(e.label||e.name),i.translate(0,t*(e.legendLabelLineHeight||16)),y.V(this.elLegendItems).append(i))},this)},getSerieColor:function(t){var e=this.model.get("attrs"),i=Object.keys(e).find(function(e){return e.includes(t)});return i?e[i].stroke||e[i].fill:"black"},hideSerie:function(e){this._disabledSeries.includes(e)||this._disabledSeries.push(e);e=this.filterSeries();this.update(e)},showSerie:function(e){this._disabledSeries=y.util.without(this._disabledSeries,e);e=this.filterSeries();this.update(e)},filterSeries:function(e){return e=e||this.model.get("series"),e=y.util.toArray(e).filter(function(e){return!this._disabledSeries.includes(e.name)},this)},onPointerDown:function(e,t,i){e=a(e.target).closest(".legend-item")[0];e&&(y.V(e).toggleClass("disabled"),y.V(e).hasClass("disabled")?this.hideSerie(y.V(e).attr("data-serie")):this.showSerie(y.V(e).attr("data-serie")))},onMouseMove:function(e){this.showGuidelines(e.clientX,e.clientY,e)},onMouseOut:function(e){this.hideGuidelines(),this.trigger("mouseout",e)},showGuidelines:function(e,t,i){var n,r,a=this.model.get("angle"),s=this.model.getBBox(),a=new y.g.Point(y.V(this.paper.layers).toLocalPoint(e,t)).rotate(s.center(),a);y.g.rect(s).containsPoint(a)&&(r=this.model.get("size"),n=a.x-s.x,a=a.y-s.y,y.V(this.elXGuideline).attr({x1:n,y1:0,x2:n,y2:r.height,visibility:"visible"}),y.V(this.elYGuideline).attr({x1:0,y1:a,x2:r.width,y2:a,visibility:"visible"}),s=y.g.scale.linear([this.canvas.x,this.canvas.x+this.canvas.width],[this.stats.minX,this.stats.maxX],n),r=y.g.scale.linear([this.canvas.y,this.canvas.y+this.canvas.height],[this.stats.minY,this.stats.maxY],a),n={x:s,y:this.stats.minY+this.stats.maxY-r},a={x:e,y:t},r=this.closestPoints(s),this.trigger("mouseover",n,a,r,i))},closestPoints:function(e){var t=y.util.sortedIndex(this.stats.xValues,e),i=this.stats.xValues[t],t=this.stats.xValues[t-1],e=void 0===t||Math.abs(e-i)<Math.abs(e-t)?i:t;return this.stats.xMap[e]},hideGuidelines:function(){y.V(this.elXGuideline).attr("visibility","hidden"),y.V(this.elYGuideline).attr("visibility","hidden")}}),pa=R.Generic.extend({markup:['<g class="rotatable">','<g class="scalable"></g>','<g class="background"><rect/><text/></g>','<g class="data"></g>','<g class="foreground">','<rect/><text class="caption"/><text class="subcaption"/>','<g class="legend"><g class="legend-items"></g></g>',"</g>","</g>"].join(""),sliceMarkup:'<g class="slice"/>',sliceFillMarkup:'<path class="slice-fill"/>',sliceBorderMarkup:'<path class="slice-border"/>',sliceInnerLabelMarkup:'<text class="slice-inner-label"/>',legendSerieMarkup:'<g class="legend-serie"><text/></g>',legendSliceMarkup:'<g class="legend-slice"><circle/><text/></g>',defaults:y.util.deepSupplement({type:"chart.Pie",size:{width:200,height:200},pieHole:0,serieDefaults:{startAngle:0,degree:360,label:null,showLegend:!0,labelLineHeight:6},sliceDefaults:{innerLabel:"{percentage:.0f}%",innerLabelMargin:6,legendLabel:"{label}: {value}",legendLabelLineHeight:6,legendLabelMargin:14,offset:0,onClickEffect:{type:"offset",offset:20},onHoverEffect:null},series:[],attrs:{".background > rect":{opacity:0},".background > text":{fill:"black",text:"No data available.",ref:".background > rect","ref-x":.5,"ref-y":.5,"text-anchor":"middle","y-alignment":"middle",display:"none"},".foreground > rect":{fill:"white",stroke:"#e5e5e5",opacity:0,"pointer-events":"none"},".foreground .caption":{fill:"black",text:"",ref:".foreground > rect","ref-x":2,"ref-y":6,"text-anchor":"start","y-alignment":"middle","font-size":14},".foreground .subcaption":{fill:"black",text:"",ref:".foreground > rect","ref-x":2,"ref-y":18,"text-anchor":"start","y-alignment":"middle","font-size":10},".data":{ref:".background","ref-x":.5,"ref-y":.5},".slice":{cursor:"pointer"},".slice > .slice-fill":{stroke:"#ffffff","stroke-width":1,"fill-opacity":1},".slice.hover > .slice-fill":{"fill-opacity":.8},".slice > .slice-border":{"stroke-width":6,"stroke-opacity":.4,"fill-opacity":1,fill:"none",display:"none"},".slice.hover > .slice-border":{display:"block"},".slice > .slice-inner-label":{"text-anchor":"middle","font-size":"12",stroke:"none","stroke-width":"0",fill:"#ffffff"},".slice > .slice-inner-label > tspan":{dy:"-.5em"},".legend":{"ref-dx":20,"ref-y":5},".legend-serie text":{fill:"grey",transform:"translate(2, 0)","font-size":13},".legend-slice":{cursor:"pointer"},".legend-slice text":{"font-weight":"normal",fill:"black","font-size":11},".legend-slice.hover text":{"font-weight":"bold"},".legend-slice circle":{r:5,transform:"translate(5,5)"}}},R.Generic.prototype.defaults),addSlice:function(e,t,i){i=i||{},t=t||0;var n=this.get("series"),r=(void 0===n[t]&&(n[t]={data:[]}),y.util.cloneDeep(n[t]));r.data.push(e),i=1<((n=n.slice())[t]=r).data.length?y.util.assign(i,{changedSerieIndex:t}):i,this.set("series",n,i)},editSlice:function(e,t,i,n){n=n||{},i=i||0;var r=this.get("series");if(void 0===r[i]||void 0===r[i].data[t])throw new Error("Slice "+t+" on serie "+i+" was not found.");var a=y.util.cloneDeep(r[i]);a.data[t]=y.util.assign(a.data[t],e),(r=r.slice())[i]=a,this.set("series",r,y.util.assign(n,{changedSerieIndex:i}))}}),cn=y.dia.ElementView.extend({events:{"mouseover .slice":"onMouseOverSlice","mouseout .slice":"onMouseOverSlice","mousemove .slice":"onMouseMoveSlice","mouseover .legend-slice":"onEventLegendItem","mouseout .legend-slice":"onEventLegendItem"},presentationAttributes:y.dia.ElementView.addPresentationAttributes({series:["UPDATE"],serieDefaults:["UPDATE"],sliceDefaults:["UPDATE"],pieHole:["UPDATE"]}),initialize:function(){y.dia.ElementView.prototype.initialize.apply(this,arguments),this.on("cell:pointerclick",this.onClickSlice,this),this.on("cell:pointerclick",this.onEventLegendItem,this)},renderMarkup:function(){y.dia.ElementView.prototype.renderMarkup.apply(this,arguments),this.elBackgroundRect=this.$(".background rect")[0],this.elBackgroundText=this.$(".background text")[0],this.elForegroundRect=this.$(".foreground rect")[0],this.elLegendItems=this.$(".legend-items")[0],this.elPie=this.$(".data")[0],this.elSlice=y.V(this.model.sliceMarkup),this.elSliceFill=y.V(this.model.sliceFillMarkup),this.elSliceBorder=y.V(this.model.sliceBorderMarkup),this.elSliceInnerLabel=y.V(this.model.sliceInnerLabelMarkup),this.elLegendSerie=y.V(this.model.legendSerieMarkup),this.elLegendSlice=y.V(this.model.legendSliceMarkup)},update:function(e,t,i){var n=(i=i||{}).changedSerieIndex,i=this.calculateSeries(n),r=(n in i?a(this.elPie).find(".serie-"+n).remove():a(this.elPie).empty(),this.model.get("size"));y.V(this.elBackgroundRect).attr(r),y.V(this.elForegroundRect).attr(r),i.length?a(this.elBackgroundText).hide():a(this.elBackgroundText).show(),y.util.toArray(i).forEach(function(e,t){void 0!==n&&n!==t||y.util.forIn(e.data,this.updateSlice.bind(this))},this),this.updateLegend(),y.dia.ElementView.prototype.update.apply(this,arguments)},calculateSeries:function(s){var e=y.util.cloneDeep(this.model.get("series")),o=this.model.get("serieDefaults"),l=this.model.get("sliceDefaults"),t=this.model.get("size"),t=Math.min(t.width,t.height)/2,i=this.model.get("pieHole"),c=t,u=(t-(1<i?i:t*i))/e.length;return this._series=e.map(function(e,i){var n,t,r,a;return void 0!==s&&s!==i||(n=(e=y.util.defaults(e,o)).startAngle,t=e.data.reduce(function(e,t){return e+t.value},0),r=e.degree/t||0,a=100/t,e.data=e.data.map(function(e,t){(e=y.util.defaults(e,y.util.omit(l,"offset","onClickEffect","onHoverEffect"))).outerRadius=c,e.innerRadius=c-u,i||((e=y.util.defaults(e,y.util.pick(l,"offset","onClickEffect","onHoverEffect"))).isOuter=!0,e.offset=1<e.offset?e.offset:e.offset*e.outerRadius,e.onClickEffect.offset=1<e.onClickEffect.offset?e.onClickEffect.offset:e.onClickEffect.offset*e.outerRadius),e.serieIndex=i,e.sliceIndex=t,e.innerLabelMargin=e.innerLabelMargin<-1||1<e.innerLabelMargin?e.innerLabelMargin:e.innerLabelMargin*e.outerRadius,e.percentage=e.value*a;t=e.value*r;return e.degree={angle:t,start:n,end:t+n},e.rad={angle:y.g.toRad(e.degree.angle,!0),start:y.g.toRad(e.degree.start,!0),end:y.g.toRad(e.degree.end,!0)},e.middleangle=(e.rad.start+e.rad.end)/2,n=e.degree.end,e}),c-=u),e}),this._series},updateLegend:function(){var e=this._series,a=(this.elLegendItems.textContent="",0),i=parseInt(this.model.attr(".legend-serie text/font-size"),10),s=parseInt(this.model.attr(".legend-slice text/font-size"),10);y.util.toArray(e).forEach(function(e,r){var t;e.showLegend&&(e.label&&(t=this.elLegendSerie.clone(),e.name&&t.addClass(e.name),t.attr({"data-serie":r}),t.findOne("text").text(e.label),t.translate(0,a),y.V(this.elLegendItems).append(t),a+=i+e.labelLineHeight),y.util.forIn(e.data,function(e,t){var i=this.elLegendSlice.clone(),n=this.getSliceFillColor(t,r);e.name&&i.addClass(e.name),i.attr({"data-serie":r,"data-slice":t}),i.findOne("text").text(y.util.format.string(e.legendLabel,e)),i.findOne("text").translate(e.legendLabelMargin),i.translate(0,a),a+=s+e.legendLabelLineHeight,y.util.isObject(n)?this.applyGradient(i.findOne("circle"),"fill",n):i.findOne("circle").attr({fill:n}),y.V(this.elLegendItems).append(i)}.bind(this)))},this)},applyGradient:function(e,t,i){var e=y.util.isString(e)?this.findBySelector(e):a(e).toArray(),n=this.paper.defineGradient(i);e.forEach(function(e){y.V(e).attr(t,"url(#"+n+")")})},updateSlice:function(e){var t=this.elSlice.clone(),i=(y.V(this.elPie).append(t),this.elSliceFill.clone()),n=this.getSliceFillColor(e.sliceIndex,e.serieIndex),i=(i.attr({fill:n,d:y.V.createSlicePathData(e.innerRadius,e.outerRadius,e.rad.start,e.rad.end)}),t.append(i),y.util.isObject(n)&&this.applyGradient("#"+i.attr("id"),"fill",n),this.elSliceBorder.clone()),r=parseInt(this.model.attr(".slice > .slice-border/stroke-width"),10),a=y.g.point.fromPolar(e.outerRadius+r/2,-e.rad.start,y.g.point(0,0)),s=y.g.point.fromPolar(e.outerRadius+r/2,-e.rad.end,y.g.point(0,0)),a=(i.attr({stroke:n,d:this.drawArc(a,s,e.outerRadius+r/2,e.rad.start,e.rad.end)}),t.append(i),y.util.isObject(n)&&this.applyGradient("#"+i.attr("id"),"stroke",n),this.elSliceInnerLabel.clone()),s=(a.text(y.util.format.string(e.innerLabel,e)),t.append(a),a.bbox()),r=e.outerRadius-s.width/2-e.innerLabelMargin,i=(a.translate(r*Math.cos(-e.middleangle),-r*Math.sin(-e.middleangle)),t.attr({"data-serie":e.serieIndex,"data-slice":e.sliceIndex,"data-value":e.value}),this._series[e.serieIndex].name);return i&&t.addClass(i),e.name&&t.addClass(e.name),t.addClass("serie-"+e.serieIndex+" slice-"+e.sliceIndex),e.isOuter&&(t.addClass("outer"),e.offset&&(t.addClass("clicked"),this.effectOnSlice(t,e,{type:"offset",offset:e.offset}))),t},getSliceFillColor:function(t,i){i=i||0;var e=this.model.get("attrs"),n=Object.keys(e).find(function(e){return-1<e.indexOf(".serie-"+i+".slice-"+t+" > .slice-fill")});return(n?e[n]:this._series[i].data[t]).fill},onMouseMoveSlice:function(e){var t=y.V(e.currentTarget),i=t.attr("data-serie"),t=t.attr("data-slice"),i=this._series[i].data[t];this.trigger(e.type,i,e)},mouseOverSlice:function(e,t){var i=y.V(this.$('.slice[data-serie="'+(t=t||0)+'"][data-slice="'+e+'"]')[0]),n=this._series[t].data[e],n=(i.toggleClass("hover"),n.isOuter&&!y.util.isEmpty(n.onHoverEffect)&&this.effectOnSlice(i,n,n.onHoverEffect,!i.hasClass("hover")),y.V(this.$('.legend-slice[data-serie="'+t+'"][data-slice="'+e+'"]')[0])),i=(n&&n.toggleClass("hover"),Object.keys(this.model.get("attrs")).filter(function(e){return-1<e.indexOf(".slice")||-1<e.indexOf(".legend-slice")}));y.dia.ElementView.prototype.update.call(this,this.model,y.util.pick(this.model.get("attrs"),i))},onMouseOverSlice:function(e){var t=y.V(e.currentTarget),i=t.attr("data-serie"),t=t.attr("data-slice"),i=(this.mouseOverSlice(t,i),this._series[i].data[t]);this.trigger(e.type,i,e)},clickSlice:function(e,t){var i=y.V(this.$('.slice[data-serie="'+(t=t||0)+'"][data-slice="'+e+'"]')[0]),n=this._series[t].data[e];n.isOuter&&(i.hasClass("clicked")?(i.removeClass("clicked"),this.model.get("series")[t].data[e].offset=0,this.effectOnSlice(i,n,n.onClickEffect,!0)):(i.addClass("clicked"),this.model.get("series")[t].data[e].offset=n.onClickEffect.offset,this.effectOnSlice(i,n,n.onClickEffect)))},onClickSlice:function(e){var t,i=y.V(a(e.target).closest(".slice.outer")[0]);i&&(t=i.attr("data-serie"),i=i.attr("data-slice"),this.clickSlice(i,t),t=this._series[t].data[i],this.trigger(e.type,t,e))},onEventLegendItem:function(e){var t=y.V(a(e.target).closest(".legend-slice")[0]);if(t){var i=t.attr("data-serie"),n=t.attr("data-slice");switch(e.type){case"click":this.clickSlice(n,i);break;case"mouseover":case"mouseout":this.mouseOverSlice(n,i)}}},effectOnSlice:function(e,t,i,n){switch(n=n||!1,i.type){case"enlarge":n?e.scale(1):e.scale(i.scale||1.05);break;case"offset":n?e.translate(0,0,{absolute:!0}):e.translate(i.offset*Math.cos(-t.middleangle),-i.offset*Math.sin(-t.middleangle))}},svgArcMax:2*Math.PI-1e-6,drawArc:function(e,t,i,n,r){var a=0,s=1,r=r-n;return r>Math.PI&&(a=1,r>=this.svgArcMax&&(s=a=0)),"M"+e.x+","+e.y+" A"+i+","+i+" 0 "+a+","+s+" "+t.x+","+t.y}}),I=pa.extend({defaults:y.util.deepSupplement({type:"chart.Knob",sliceDefaults:{legendLabel:"{value:.0f}",outer:{offsetOnClick:0}},pieHole:.7,value:0,attrs:{".legend":{"ref-x":.5,"ref-y":.5,"ref-dx":null,"x-alignment":-.5,"y-alignment":-.5},".legend-slice text":{"font-size":30},".legend-slice circle":{display:"none"},".slice-inner-label":{display:"none"},".slice-fill":{stroke:"none"}}},pa.prototype.defaults),initialize:function(){this.set("series",this.getKnobSeries(),{silent:!0}),pa.prototype.initialize.apply(this,arguments),this.on("change:value change:min change:max change:fill",this.updateKnob,this)},getKnobSeries:function(){var e=Array.isArray(this.get("value"))?this.get("value"):[this.get("value")],a=Array.isArray(this.get("fill"))?this.get("fill"):[this.get("fill")],s=Array.isArray(this.get("min"))?this.get("min"):[this.get("min")],o=Array.isArray(this.get("max"))?this.get("max"):[this.get("max")];return e.map(function(e,t){var i=void 0===s[t]?s[0]:s[t],n=void 0===o[t]?o[0]:o[t],r=void 0===a[t]?a[0]:a[t];return{degree:y.g.scale.linear([i,n],[0,360],e),data:[{value:e,fill:r}],showLegend:!(0<t)}})},updateKnob:function(){this.set("series",this.getKnobSeries())}}),M=cn,or=R.Generic.extend({markup:['<g class="rotatable">','<g class="scalable">','<g class="background"><rect/></g>','<g class="cells"/>','<g class="foreground"/>',"</g>",'<g class="labels">','<g class="rows"/>','<g class="columns"/>',"</g>","</g>"].join(""),cellMarkup:'<rect class="cell"/>',labelMarkup:'<text class="label"/>',gridLineMarkup:'<path class="grid-line"/>',defaults:y.util.deepSupplement({type:"chart.Matrix",attrs:{".background rect":{fill:"#eeeeee"},".grid-line":{stroke:"white","stroke-width":2},".label":{fill:"black","alignment-baseline":"middle"},".labels .rows .label":{"text-anchor":"end"},".labels .columns .label":{"text-anchor":"start"}}},R.Generic.prototype.defaults)}),g=y.dia.ElementView.extend({presentationAttributes:y.dia.ElementView.addPresentationAttributes({size:["LABELS"],cells:["MARKUP","LABELS"]}),initFlag:["LABELS"].concat(y.dia.ElementView.prototype.initFlag),confirmUpdate:function(){var e=y.dia.ElementView.prototype.confirmUpdate.apply(this,arguments);return this.hasFlag(e,"MARKUP")&&(this.renderMarkup(),e=this.removeFlag(e,"MARKUP")),this.hasFlag(e,"LABELS")&&(this.renderLabels(),e=this.removeFlag(e,"LABELS")),e},renderMarkup:function(){y.dia.ElementView.prototype.renderMarkup.apply(this,arguments),this.elCells=this.$(".cells")[0],this.elRowLabels=this.$(".labels .rows")[0],this.elColumnLabels=this.$(".labels .columns")[0],this.elForeground=this.$(".foreground")[0],this.elCell=y.V(this.model.cellMarkup),this.elGridLine=y.V(this.model.gridLineMarkup);for(var e,t,i,n,r,a=this.model.get("cells")||[],s=this.model.get("size"),o=(this.elBackgroundRect=this.$(".background rect")[0],y.V(this.elBackgroundRect).attr(s),s.height/a.length),l=s.width/a.length,c=document.createDocumentFragment(),u=(this.elCells.textContent="",this.elForeground.textContent="",document.createDocumentFragment()),d=0;d<a.length;d++)for((i=this.elGridLine.clone()).addClass("horizontal"),i.attr("d","M 0 "+d*o+" "+s.width+" "+d*o),u.appendChild(i.node),e=a[d],t=0;t<e.length;t++)0===d&&((i=this.elGridLine.clone()).addClass("vertical"),i.attr("d","M "+t*l+" 0 "+t*l+" "+s.height),u.appendChild(i.node)),(n=e[t])&&((r=this.elCell.clone()).attr(y.util.assign({x:t*l,y:d*o,width:l,height:o},n)),c.appendChild(r.node));this.elForeground.appendChild(u),this.elCells.appendChild(c)},renderLabels:function(){this.elLabel=y.V(this.model.labelMarkup);for(var e,t,i,n,r=this.model.get("cells")||[],a=this.model.get("labels")||{},s=a.rows||[],o=a.columns||[],l=this.model.get("size"),c=l.height/r.length,u=l.width/r.length,d=(this.elRowLabels.textContent="",this.elColumnLabels.textContent="",document.createDocumentFragment()),f=0;f<s.length;f++)e=a.rows[f],(t=this.elLabel.clone()).text(e.text),t.attr(y.util.assign({x:-(a.padding||5),y:f*c+c/2,"text-anchor":"end","dominant-baseline":"central","font-size":c,"data-row":f},y.util.omit(e,"text"))),d.appendChild(t.node);this.elRowLabels.appendChild(d);for(var h=document.createDocumentFragment(),g=0;g<o.length;g++)e=a.columns[g],t=this.elLabel.clone(),n=-(a.padding||5),t.attr("x",i=g*u+u/2),t.text(e.text),t.attr(y.util.assign({y:n,"text-anchor":"start","dominant-baseline":"central","font-size":u,"data-column":g},y.util.omit(e,"text"))),t.rotate(-90,i,n),h.appendChild(t.node);this.elColumnLabels.appendChild(h)}});e.Knob=I,e.KnobView=M,e.Matrix=or,e.MatrixView=g,e.Pie=pa,e.PieView=cn,e.Plot=j,e.PlotView=L}(this.joint.shapes=this.joint.shapes||{},$,joint.shapes.basic,joint);