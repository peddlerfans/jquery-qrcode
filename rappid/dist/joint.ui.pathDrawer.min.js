/*! JointJS+ v3.6.3 - HTML5 Diagramming Framework

Copyright (c) 2022 client IO

 2022-12-09 


This Source Code Form is subject to the terms of the JointJS+ License
, v. 2.0. If a copy of the JointJS+ License was not distributed with this
file, You can obtain one at http://jointjs.com/license/rappid_v2.txt
 or from the JointJS+ archive as was distributed by client IO. See the LICENSE file.*/


this.joint=this.joint||{},function(R,e,l){"use strict";e=e&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e;function n(t){try{return!!t()}catch(t){return!0}}function i(t){return o?V(t):function(){return s.apply(t,arguments)}}function r(t){return I(z(t),8,-1)}function t(t){if("Function"===r(t))return i(t)}var o=!n(function(){var t=function(){}.bind();return"function"!=typeof t||t.hasOwnProperty("prototype")}),a=Function.prototype,s=a.call,V=o&&a.bind.bind(s,s),z=i({}.toString),I=i("".slice),a="object"==typeof document&&document.all,a={all:a,IS_HTMLDDA:void 0===a&&void 0!==a},F=a.all,u=a.IS_HTMLDDA?function(t){return"function"==typeof t||t===F}:function(t){return"function"==typeof t},c=!n(function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}),h="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function H(t,e){return t(e={exports:{}},e.exports),e.exports}function g(t){return t&&t.Math==Math&&t}function U(t,e){return arguments.length<2?(n=S[t],u(n)?n:void 0):S[t]&&S[t][e];var n}function W(t){if(u(t))return t;throw rt(function(t){try{return it(t)}catch(t){return"Object"}}(t)+" is not a function")}function X(e,n){try{ct(S,e,{value:n,configurable:!0,writable:!0})}catch(t){S[e]=n}return n}function Y(t){return lt(function(t){if(ot(t))throw ht("Can't call method on "+t);return t}(t))}function Z(t){return"Symbol("+(void 0===t?"":t)+")_"+ft(++pt+dt,36)}function p(t){var e;return N(k,t)&&(D||"string"==typeof k[t])||(e="Symbol."+t,D&&N(M,t)?k[t]=M[t]:k[t]=(T&&mt?mt:vt)(e)),k[t]}function $(t){return t=function(t,e){if(!P(t)||nt(t))return t;var n=at(t,yt);if(n){if(n=x(n,t,e=void 0===e?"default":e),!P(n)||nt(n))return n;throw bt("Can't convert object to primitive value")}return ut(t,e=void 0===e?"number":e)}(t,"string"),nt(t)?t:t+""}function d(t,e,n,i){var r=(i=i||{}).enumerable,o=void 0!==i.name?i.name:e;if(u(n)&&At(n,o,i),i.global)r?t[e]=n:X(e,n);else{try{i.unsafe?t[e]&&(r=!0):delete t[e]}catch(t){}r?t[e]=n:Ot.f(t,e,{value:n,enumerable:!1,configurable:!i.nonConfigurable,writable:!i.nonWritable})}}var f,m,v,b,y,S=g("object"==typeof globalThis&&globalThis)||g("object"==typeof window&&window)||g("object"==typeof self&&self)||g("object"==typeof h&&h)||function(){return this}()||Function("return this")(),B=a.all,P=a.IS_HTMLDDA?function(t){return"object"==typeof t?null!==t:u(t)||t===B}:function(t){return"object"==typeof t?null!==t:u(t)},w=S.document,G=P(w)&&P(w.createElement),q=!c&&!n(function(){return 7!=Object.defineProperty(G?w.createElement("div"):{},"a",{get:function(){return 7}}).a}),h=c&&n(function(){return 42!=Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype}),J=String,K=TypeError,j=function(t){if(P(t))return t;throw K(J(t)+" is not an object")},E=Function.prototype.call,x=o?E.bind(E):function(){return E.apply(E,arguments)},Q=t({}.isPrototypeOf),a=U("navigator","userAgent")||"",O=S.process,C=S.Deno,O=O&&O.versions||C&&C.version,C=O&&O.v8,tt=_=!(_=C?0<(A=C.split("."))[0]&&A[0]<4?1:+(A[0]+A[1]):_)&&a&&(!(A=a.match(/Edge\/(\d+)/))||74<=A[1])&&(A=a.match(/Chrome\/(\d+)/))?+A[1]:_,D=!!Object.getOwnPropertySymbols&&!n(function(){var t=Symbol();return!String(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&tt&&tt<41}),T=D&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,et=Object,nt=T?function(t){return"symbol"==typeof t}:function(t){var e=U("Symbol");return u(e)&&Q(e.prototype,et(t))},it=String,rt=TypeError,ot=function(t){return null==t},at=function(t,e){t=t[e];return ot(t)?void 0:W(t)},st=TypeError,ut=function(t,e){var n,i;if("string"===e&&u(n=t.toString)&&!P(i=x(n,t)))return i;if(u(n=t.valueOf)&&!P(i=x(n,t)))return i;if("string"!==e&&u(n=t.toString)&&!P(i=x(n,t)))return i;throw st("Can't convert object to primitive value")},ct=Object.defineProperty,O="__core-js_shared__",L=S[O]||X(O,{}),C=H(function(t){(t.exports=function(t,e){return L[t]||(L[t]=void 0!==e?e:{})})("versions",[]).push({version:"3.25.5",mode:"global",copyright:"Â© 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.25.5/LICENSE",source:"https://github.com/zloirock/core-js"})}),ht=TypeError,lt=Object,gt=t({}.hasOwnProperty),N=Object.hasOwn||function(t,e){return gt(Y(t),e)},pt=0,dt=Math.random(),ft=t(1..toString),k=C("wks"),M=S.Symbol,mt=M&&M.for,vt=T?M:M&&M.withoutSetter||Z,bt=TypeError,yt=p("toPrimitive"),St=TypeError,Pt=Object.defineProperty,wt=Object.getOwnPropertyDescriptor,jt="enumerable",Et="configurable",xt="writable",Ot={f:c?h?function(t,e,n){var i;return j(t),e=$(e),j(n),"function"==typeof t&&"prototype"===e&&"value"in n&&xt in n&&!n[xt]&&((i=wt(t,e))&&i[xt]&&(t[e]=n.value,n={configurable:(Et in n?n:i)[Et],enumerable:(jt in n?n:i)[jt],writable:!1})),Pt(t,e,n)}:Pt:function(t,e,n){if(j(t),e=$(e),j(n),q)try{return Pt(t,e,n)}catch(t){}if("get"in n||"set"in n)throw St("Accessors not supported");return"value"in n&&(t[e]=n.value),t}},a=Function.prototype,A=c&&Object.getOwnPropertyDescriptor,_=N(a,"name"),Ct={EXISTS:_,PROPER:_&&"something"===function(){}.name,CONFIGURABLE:_&&(!c||A(a,"name").configurable)},Dt=t(Function.toString),Tt=(u(L.inspectSource)||(L.inspectSource=function(t){return Dt(t)}),L.inspectSource),O=S.WeakMap,h=u(O)&&/native code/.test(String(O)),Lt=c?function(t,e,n){return Ot.f(t,e,{enumerable:!((t=1)&t),configurable:!(2&t),writable:!(4&t),value:n})}:function(t,e,n){return t[e]=n,t},_=C("keys"),Nt="Object already initialized",kt=S.TypeError,A=S.WeakMap,Mt=(y=h||L.state?((f=L.state||(L.state=new A)).get=f.get,f.has=f.has,f.set=f.set,v=function(t,e){if(f.has(t))throw kt(Nt);return e.facade=t,f.set(t,e),e},b=function(t){return f.get(t)||{}},function(t){return f.has(t)}):(m=_[a="state"]||(_[a]=Z(a)),v=function(t,e){if(N(t,m))throw kt(Nt);return e.facade=t,Lt(t,m,e),e},b=function(t){return N(t,m)?t[m]:{}},function(t){return N(t,m)}),{set:v,get:b,has:y,enforce:function(t){return y(t)?b(t):v(t,{})},getterFor:function(e){return function(t){if(P(t)&&(t=b(t)).type===e)return t;throw kt("Incompatible receiver, "+e+" required")}}}),At=H(function(t){var i=Ct.CONFIGURABLE,r=Mt.enforce,e=Mt.get,o=Object.defineProperty,a=c&&!n(function(){return 8!==o(function(){},"length",{value:8}).length}),s=String(String).split("String"),t=t.exports=function(t,e,n){"Symbol("===String(e).slice(0,7)&&(e="["+String(e).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),n&&n.getter&&(e="get "+e),n&&n.setter&&(e="set "+e),(!N(t,"name")||i&&t.name!==e)&&(c?o(t,"name",{value:e,configurable:!0}):t.name=e),a&&n&&N(n,"arity")&&t.length!==n.arity&&o(t,"length",{value:n.arity});try{n&&N(n,"constructor")&&n.constructor?c&&o(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch(t){}n=r(t);return N(n,"source")||(n.source=s.join("string"==typeof e?e:"")),t};Function.prototype.toString=t(function(){return u(this)&&e(this).source||Tt(this)},"toString")}),O=Date.prototype,_t="Invalid Date",C="toString",Rt=t(O[C]),Vt=t(O.getTime);String(new Date(NaN))!=_t&&d(O,C,function(){var t=Vt(this);return t==t?Rt(this):_t});function zt(t){if("Symbol"===Wt(t))throw TypeError("Cannot convert a Symbol value to a string");return Xt(t)}function It(){var t=j(this),e="";return t.hasIndices&&(e+="d"),t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.dotAll&&(e+="s"),t.unicode&&(e+="u"),t.unicodeSets&&(e+="v"),t.sticky&&(e+="y"),e}var h={},A=(h[p("toStringTag")]="z","[object z]"===String(h)),Ft=p("toStringTag"),Ht=Object,Ut="Arguments"==r(function(){return arguments}()),Wt=A?r:function(t){var e;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(e=function(t,e){try{return t[e]}catch(t){}}(t=Ht(t),Ft))?e:Ut?r(t):"Object"==(e=r(t))&&u(t.callee)?"Arguments":e},Xt=(A||d(Object.prototype,"toString",A?{}.toString:function(){return"[object "+Wt(this)+"]"},{unsafe:!0}),String),Yt=RegExp.prototype,_=Ct.PROPER,a="toString",Zt=RegExp.prototype[a],O=n(function(){return"/a/b"!=Zt.call({source:"a",flags:"b"})}),C=_&&Zt.name!=a,h=((O||C)&&d(RegExp.prototype,a,function(){var t,e=j(this);return"/"+zt(e.source)+"/"+zt(void 0!==(t=(e=e).flags)||"flags"in Yt||N(e,"flags")||!Q(Yt,e)?t:x(It,e))},{unsafe:!0}),l.mvc.View.extend({tagName:"g",svgElement:!0,className:"path-drawer",events:{"mousedown .start-point":"onStartPointPointerDown",mousedown:"onPointerDown","touchstart .start-point":"onStartPointPointerDown",touchstart:"onPointerDown",dblclick:"onDoubleClick",contextmenu:"onContextMenu"},documentEvents:{mousemove:"onPointerMove",touchmove:"onPointerMove",mouseup:"onPointerUp",touchend:"onPointerUp",touchcancel:"onPointerUp"},options:{pathAttributes:{class:null,fill:"#ffffff",stroke:"#000000","stroke-width":1,"pointer-events":"none"},startPointMarkup:'<circle r="5"/>',snapRadius:0},init:function(){var t=this.svgTarget=l.V(this.options.target);this.path=new l.g.Path,this.$document=e(t.node.ownerDocument),this.action="awaiting-input",this.render()},onRemove:function(){var t=this.pathNode;t&&l.V(t).remove(),this.clear()},clear:function(){var t=this.path,e=this.pathNode;e&&t&&t.segments.length<=1&&l.V(e).remove(),this.svgStart.remove(),this.svgControl.remove(),this.pathNode=null,this.path=new l.g.Path,this.undelegateDocumentEvents(),this.action="awaiting-input",this.trigger("clear")},render:function(){var t=this.options;return this.svgPathTemplate=l.V("path").attr(t.pathAttributes),this.svgStart=l.V(t.startPointMarkup).addClass("start-point"),this.svgControl=l.V("path").addClass("control-path"),this.vel.append(l.V("rect",{x:0,y:0,width:"100%",height:"100%",fill:"transparent",stroke:"none"})),this.svgTarget.append(this.el),this},createPath:function(t,e){var n=this.svgPathTemplate.clone(),i=this.pathNode=n.node,r=this.svgStart.translate(t,e,{absolute:!0});this.trigger("path:create",i),this.addMoveSegment(t,e),this.vel.before(n),this.vel.append(r)},closePath:function(){var t=this.path,e=this.pathNode,n=t.getSegment(0),i=t.getSegment(t.segments.length-1);"L"===i.type?t.replaceSegment(t.segments.length-1,l.g.Path.createSegment("Z")):(i.end.x=n.end.x,i.end.y=n.end.y,t.appendSegment(l.g.Path.createSegment("Z"))),e.setAttribute("d",t.toString()),this.finishPath("path:close")},finishPath:function(t){var e=this.path,n=this.pathNode;e&&0<this.numberOfVisibleSegments()?(this.trigger("path:finish",n),this.trigger(t,n)):this.trigger("path:abort",n),this.clear()},numberOfVisibleSegments:function(){var t=this.path,e=t.segments.length;return--e,"Z"===t.getSegment(t.segments.length-1).type&&--e,e},addMoveSegment:function(t,e){var n=this.path,i=this.pathNode,t=l.g.Path.createSegment("M",t,e);n.appendSegment(t),i.setAttribute("d",n.toString()),this.trigger("path:segment:add",i),this.trigger("path:move-segment:add",i)},addLineSegment:function(t,e){var n=this.path,i=this.pathNode,t=l.g.Path.createSegment("L",t,e);n.appendSegment(t),i.setAttribute("d",n.toString()),this.trigger("path:segment:add",i),this.trigger("path:line-segment:add",i)},addCurveSegment:function(t,e,n,i,r,o){var a=this.path,s=this.pathNode,n=l.g.Path.createSegment("C",n,i,r||t,o||e,t,e);a.appendSegment(n),s.setAttribute("d",a.toString()),this.trigger("path:segment:add",s),this.trigger("path:curve-segment:add",s)},adjustLastSegment:function(t,e,n,i,r,o){var a=this.path,s=this.pathNode,u=this.options.snapRadius,u=(u&&(t=(u=this.snapLastSegmentCoordinates(t,e,u)).x,e=u.y),a.getSegment(a.segments.length-1));null!=t&&(u.end.x=t),null!=e&&(u.end.y=e),null!=n&&(u.controlPoint1.x=n),null!=i&&(u.controlPoint1.y=i),null!=r&&(u.controlPoint2.x=r),null!=o&&(u.controlPoint2.y=o),s.setAttribute("d",a.toString()),this.trigger("path:edit",s),this.trigger("path:last-segment:adjust",s)},snapLastSegmentCoordinates:function(t,e,n){for(var i=this.path,r=!1,o=!1,a=t,s=e,u=i.segments.length-2;0<=u&&(!r||!o);u--){var c=i.getSegment(u),h=c.end.x,c=c.end.y;!r&&Math.abs(h-t)<n&&(a=h,r=!0),!o&&Math.abs(c-e)<n&&(s=c,o=!0)}return new l.g.Point(a,s)},removeLastSegment:function(){var t=this.path,e=this.pathNode;t.removeSegment(t.segments.length-1),e.setAttribute("d",t.toString()),this.trigger("path:edit",e),this.trigger("path:last-segment:remove",e)},findControlPoint:function(t,e){var n=this.path,n=n.getSegment(n.segments.length-1);return new l.g.Point(t,e).reflection({x:n.end.x,y:n.end.y})},replaceLastSegmentWithCurve:function(){var t=this.path,e=this.pathNode,n=t.getSegment(t.segments.length-1),i=t.getSegment(t.segments.length-2),i=l.g.Path.createSegment("C",i.end.x,i.end.y,n.end.x,n.end.y,n.end.x,n.end.y);t.replaceSegment(t.segments.length-1,i),e.setAttribute("d",t.toString()),this.trigger("path:edit",e),this.trigger("path:last-segment:replace-with-curve",e)},adjustControlPath:function(t,e,n,i){var r=this.pathNode,o=this.svgControl.node,t=new l.g.Path([l.g.Path.createSegment("M",t,e),l.g.Path.createSegment("L",n,i)]);o.setAttribute("d",t.toString()),this.vel.append(o),this.trigger("path:interact",r),this.trigger("path:control:adjust",r)},removeControlPath:function(){var t=this.pathNode,e=this.svgControl.node;e.removeAttribute("d"),this.vel.append(e),this.trigger("path:interact",t),this.trigger("path:control:remove",t)},onPointerDown:function(t){t=l.util.normalizeEvent(t);if(t.stopPropagation(),!(1<t.which)&&!(1<t.originalEvent.detail)&&this.el.parentNode){var e=this.vel.toLocalPoint(t.clientX,t.clientY);switch(this.action){case"awaiting-input":this.createPath(e.x,e.y),this.action="path-created",this.delegateDocumentEvents();break;case"adjusting-line-end":this.action="awaiting-line-end";break;case"adjusting-curve-end":this.action="awaiting-curve-control-2"}this._timeStamp=t.timeStamp}},MOVEMENT_DETECTION_THRESHOLD:150,onPointerMove:function(t){t=l.util.normalizeEvent(t);if(t.stopPropagation(),"awaiting-input"!=this.action){var e,n,i=this.vel.toLocalPoint(t.clientX,t.clientY),r=this._timeStamp;if(r)if(t.timeStamp-r<this.MOVEMENT_DETECTION_THRESHOLD)switch(this.action){case"path-created":e=this.svgStart.translate(),this.adjustControlPath(e.tx,e.ty,i.x,i.y);break;case"awaiting-line-end":case"adjusting-curve-control-1":this.adjustLastSegment(i.x,i.y);break;case"awaiting-curve-control-2":this.adjustLastSegment(i.x,i.y,null,null,i.x,i.y)}else switch(this.action){case"path-created":this.action="adjusting-curve-control-1";break;case"awaiting-line-end":this.replaceLastSegmentWithCurve(),this.action="adjusting-curve-control-2";break;case"awaiting-curve-control-2":this.action="adjusting-curve-control-2";break;case"adjusting-curve-control-1":e=this.svgStart.translate(),this.adjustControlPath(e.tx,e.ty,i.x,i.y);break;case"adjusting-curve-control-2":n=this.findControlPoint(i.x,i.y),this.adjustLastSegment(null,null,null,null,n.x,n.y),this.adjustControlPath(n.x,n.y,i.x,i.y)}else switch(this.action){case"adjusting-line-end":this.adjustLastSegment(i.x,i.y);break;case"adjusting-curve-end":this.adjustLastSegment(i.x,i.y,null,null,i.x,i.y)}}},onPointerUp:function(t){this._timeStamp=null;t=l.util.normalizeEvent(t);if(t.stopPropagation(),!(1<t.which||1<t.originalEvent.detail)){var e=this.vel.toLocalPoint(t.clientX,t.clientY);switch(this.action){case"path-created":case"awaiting-line-end":this.addLineSegment(e.x,e.y),this.action="adjusting-line-end";break;case"awaiting-curve-control-2":this.removeControlPath(),this.addLineSegment(e.x,e.y),this.action="adjusting-line-end";break;case"adjusting-curve-control-1":case"adjusting-curve-control-2":this.addCurveSegment(e.x,e.y,e.x,e.y),this.action="adjusting-curve-end"}}},onStartPointPointerDown:function(t){t=l.util.normalizeEvent(t);t.stopPropagation(),1<t.which||1<t.originalEvent.detail||this.closePath()},onDoubleClick:function(t){t=l.util.normalizeEvent(t);t.preventDefault(),t.stopPropagation(),1<t.which||this.pathNode&&0<this.numberOfVisibleSegments()&&(this.removeLastSegment(),this.finishPath("path:stop"))},onContextMenu:function(t){t=l.util.normalizeEvent(t);t.preventDefault(),t.stopPropagation(),1<t.originalEvent.detail||this.pathNode&&0<this.numberOfVisibleSegments()&&(this.removeLastSegment(),this.finishPath("path:stop"))}}));R.PathDrawer=h}(this.joint.ui=this.joint.ui||{},$,joint);