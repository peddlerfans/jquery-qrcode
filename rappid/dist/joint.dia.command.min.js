/*! JointJS+ v3.6.3 - HTML5 Diagramming Framework

Copyright (c) 2022 client IO

 2022-12-09 


This Source Code Form is subject to the terms of the JointJS+ License
, v. 2.0. If a copy of the JointJS+ License was not distributed with this
file, You can obtain one at http://jointjs.com/license/rappid_v2.txt
 or from the JointJS+ archive as was distributed by client IO. See the LICENSE file.*/


this.joint=this.joint||{},function(B,t,s){"use strict";function D(t){return function(t){if(Array.isArray(t))return F(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,n){var e;if(t)return"string"==typeof t?F(t,n):"Map"===(e="Object"===(e=Object.prototype.toString.call(t).slice(8,-1))&&t.constructor?t.constructor.name:e)||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?F(t,n):void 0}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function F(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}t=t&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t;var n="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function _(t,n){return t(n={exports:{}},n.exports),n.exports}function G(t){return t&&t.Math==Math&&t}function u(t){try{return!!t()}catch(t){return!0}}function H(t,n){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:n}}function U(t){return ot?st(t):function(){return ut.apply(t,arguments)}}function e(t){return lt(ft(t),8,-1)}function r(t){if("Function"===e(t))return U(t)}function z(t){if(mt(t))throw gt("Can't call method on "+t);return t}function f(t){return pt(z(t))}function o(t,n){return arguments.length<2?(e=y[t],b(e)?e:void 0):y[t]&&y[t][n];var e}function q(t){try{return At(t)}catch(t){return"Object"}}function O(t){return Mt(z(t))}function J(t){return"Symbol("+(void 0===t?"":t)+")_"+Dt(++Nt+Bt,36)}function i(t){var n;return E(L,t)&&(Ct||"string"==typeof L[t])||(n="Symbol."+t,Ct&&E(j,t)?L[t]=j[t]:L[t]=(Ot&&Ft?Ft:_t)(n)),L[t]}function V(t,n){if(!S(t)||wt(t))return t;var e=jt(t,Ht);if(e){if(e=v(e,t,n=void 0===n?"default":n),!S(e)||wt(e))return e;throw Gt("Can't convert object to primitive value")}return kt(t,n=void 0===n?"number":n)}function X(t){return t=V(t,"string"),wt(t)?t:t+""}function W(t){return cn[t]||(cn[t]=J(t))}function $(t,n,e,r){var o=(r=r||{}).enumerable,i=void 0!==r.name?r.name:n;if(b(e)&&dn(e,i,r),r.global)o?t[n]=e:Pt(n,e);else{try{r.unsafe?t[n]&&(o=!0):delete t[n]}catch(t){}o?t[n]=e:k.f(t,n,{value:e,enumerable:!1,configurable:!r.nonConfigurable,writable:!r.nonWritable})}}function K(t,n){return(t=yn(t))<0?vn(t+n,0):bn(t,n)}function x(t){return Cn(t.length)}function Y(c){return function(t,n,e){var r,o=f(t),i=x(o),a=K(e,i);if(c&&n!=n){for(;a<i;)if((r=o[a++])!=r)return!0}else for(;a<i;a++)if((c||a in o)&&o[a]===n)return c||a||0;return!c&&-1}}function Q(t,n){var e,r=f(t),o=0,i=[];for(e in r)!E(un,e)&&E(r,e)&&xn(i,e);for(;n.length>o;)!E(r,e=n[o++])||~On(i,e)||xn(i,e);return i}function a(t,n){return(t=Pn[Tn(t)])==Rn||t!=Mn&&(b(n)?u(n):!!n)}function c(t,n){var e,r,o,i=t.target,a=t.global,c=t.stat,u=a?y:c?y[i]||Pt(i,{}):(y[i]||{}).prototype;if(u)for(e in n){if(r=n[e],o=t.dontCallGetSet?(o=Bn(u,e))&&o.value:u[e],!Nn(a?e:i+(c?".":"#")+e,t.forced)&&void 0!==o){if(typeof r==typeof o)continue;for(var s=r,f=o,l=g=m=p=d=h=void 0,h=In(f),d=k.f,p=Xt.f,m=0;m<h.length;m++){var g=h[m];E(s,g)||l&&E(l,g)||d(s,g,p(f,g))}}(t.sham||o&&o.sham)&&en(r,"sham",!0),$(u,e,r,t)}}function Z(){}function l(t){if(!b(t))return!1;try{return zn(Z,Un,t),!0}catch(t){return!1}}function tt(t){if(!b(t))return!1;switch(Hn(t)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return Vn||!!Jn(qn,an(t))}catch(t){return!0}}function nt(t,n){return new(Kn(t))(0===n?0:n)}function h(p){var m=1==p,g=2==p,y=3==p,v=4==p,b=6==p,S=7==p,C=5==p||b;return function(t,n,e,r){for(var o,i,a,c,u=O(t),s=pt(u),f=(i=e,Lt(o=n),void 0===i?o:ot?Dn(o,i):function(){return o.apply(i,arguments)}),l=x(s),h=0,e=r||nt,d=m?e(t,l):g||S?e(t,0):void 0;h<l;h++)if((C||h in s)&&(c=f(a=s[h],h,u),p))if(m)d[h]=c;else if(c)switch(p){case 3:return!0;case 5:return a;case 6:return h;case 2:Yn(d,a)}else switch(p){case 4:return!1;case 7:Yn(d,a)}return b?-1:y||v?v:d}}function et(t,n){var e=[][t];return!!e&&u(function(){e.call(null,n||function(){return 1},1)})}var rt,d,p,m,y=G("object"==typeof globalThis&&globalThis)||G("object"==typeof window&&window)||G("object"==typeof self&&self)||G("object"==typeof n&&n)||function(){return this}()||Function("return this")(),g=!u(function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}),ot=!u(function(){var t=function(){}.bind();return"function"!=typeof t||t.hasOwnProperty("prototype")}),it=Function.prototype.call,v=ot?it.bind(it):function(){return it.apply(it,arguments)},n={}.propertyIsEnumerable,at=Object.getOwnPropertyDescriptor,ct={f:at&&!n.call({1:2},1)?function(t){t=at(this,t);return!!t&&t.enumerable}:n},n=Function.prototype,ut=n.call,st=ot&&n.bind.bind(ut,ut),ft=U({}.toString),lt=U("".slice),ht=Object,dt=r("".split),pt=u(function(){return!ht("z").propertyIsEnumerable(0)})?function(t){return"String"==e(t)?dt(t,""):ht(t)}:ht,mt=function(t){return null==t},gt=TypeError,n="object"==typeof document&&document.all,n={all:n,IS_HTMLDDA:void 0===n&&void 0!==n},yt=n.all,b=n.IS_HTMLDDA?function(t){return"function"==typeof t||t===yt}:function(t){return"function"==typeof t},vt=n.all,S=n.IS_HTMLDDA?function(t){return"object"==typeof t?null!==t:b(t)||t===vt}:function(t){return"object"==typeof t?null!==t:b(t)},bt=r({}.isPrototypeOf),n=o("navigator","userAgent")||"",C=y.process,w=y.Deno,C=C&&C.versions||w&&w.version,w=C&&C.v8,St=P=!(P=w?0<(T=w.split("."))[0]&&T[0]<4?1:+(T[0]+T[1]):P)&&n&&(!(T=n.match(/Edge\/(\d+)/))||74<=T[1])&&(T=n.match(/Chrome\/(\d+)/))?+T[1]:P,Ct=!!Object.getOwnPropertySymbols&&!u(function(){var t=Symbol();return!String(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&St&&St<41}),Ot=Ct&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,xt=Object,wt=Ot?function(t){return"symbol"==typeof t}:function(t){var n=o("Symbol");return b(n)&&bt(n.prototype,xt(t))},At=String,Et=TypeError,Lt=function(t){if(b(t))return t;throw Et(q(t)+" is not a function")},jt=function(t,n){t=t[n];return mt(t)?void 0:Lt(t)},It=TypeError,kt=function(t,n){var e,r;if("string"===n&&b(e=t.toString)&&!S(r=v(e,t)))return r;if(b(e=t.valueOf)&&!S(r=v(e,t)))return r;if("string"!==n&&b(e=t.toString)&&!S(r=v(e,t)))return r;throw It("Can't convert object to primitive value")},Tt=Object.defineProperty,Pt=function(n,e){try{Tt(y,n,{value:e,configurable:!0,writable:!0})}catch(t){y[n]=e}return e},C="__core-js_shared__",A=y[C]||Pt(C,{}),w=_(function(t){(t.exports=function(t,n){return A[t]||(A[t]=void 0!==n?n:{})})("versions",[]).push({version:"3.25.5",mode:"global",copyright:"Â© 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.25.5/LICENSE",source:"https://github.com/zloirock/core-js"})}),Mt=Object,Rt=r({}.hasOwnProperty),E=Object.hasOwn||function(t,n){return Rt(O(t),n)},Nt=0,Bt=Math.random(),Dt=r(1..toString),L=w("wks"),j=y.Symbol,Ft=j&&j.for,_t=Ot?j:j&&j.withoutSetter||J,Gt=TypeError,Ht=i("toPrimitive"),Ut=y.document,zt=S(Ut)&&S(Ut.createElement),qt=function(t){return zt?Ut.createElement(t):{}},Jt=!g&&!u(function(){return 7!=Object.defineProperty(qt("div"),"a",{get:function(){return 7}}).a}),Vt=Object.getOwnPropertyDescriptor,Xt={f:g?Vt:function(t,n){if(t=f(t),n=X(n),Jt)try{return Vt(t,n)}catch(t){}if(E(t,n))return H(!v(ct.f,t,n),t[n])}},n=g&&u(function(){return 42!=Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype}),Wt=String,$t=TypeError,I=function(t){if(S(t))return t;throw $t(Wt(t)+" is not an object")},Kt=TypeError,Yt=Object.defineProperty,Qt=Object.getOwnPropertyDescriptor,Zt="enumerable",tn="configurable",nn="writable",k={f:g?n?function(t,n,e){var r;return I(t),n=X(n),I(e),"function"==typeof t&&"prototype"===n&&"value"in e&&nn in e&&!e[nn]&&((r=Qt(t,n))&&r[nn]&&(t[n]=e.value,e={configurable:(tn in e?e:r)[tn],enumerable:(Zt in e?e:r)[Zt],writable:!1})),Yt(t,n,e)}:Yt:function(t,n,e){if(I(t),n=X(n),I(e),Jt)try{return Yt(t,n,e)}catch(t){}if("get"in e||"set"in e)throw Kt("Accessors not supported");return"value"in e&&(t[n]=e.value),t}},en=g?function(t,n,e){return k.f(t,n,H(1,e))}:function(t,n,e){return t[n]=e,t},T=Function.prototype,P=g&&Object.getOwnPropertyDescriptor,C=E(T,"name"),rn={EXISTS:C,PROPER:C&&"something"===function(){}.name,CONFIGURABLE:C&&(!g||P(T,"name").configurable)},on=r(Function.toString),an=(b(A.inspectSource)||(A.inspectSource=function(t){return on(t)}),A.inspectSource),C=y.WeakMap,P=b(C)&&/native code/.test(String(C)),cn=w("keys"),un={},sn="Object already initialized",fn=y.TypeError,T=y.WeakMap,ln=P||A.state?((p=A.state||(A.state=new T)).get=p.get,p.has=p.has,p.set=p.set,rt=function(t,n){if(p.has(t))throw fn(sn);return n.facade=t,p.set(t,n),n},d=function(t){return p.get(t)||{}},function(t){return p.has(t)}):(m=W("state"),un[m]=!0,rt=function(t,n){if(E(t,m))throw fn(sn);return n.facade=t,en(t,m,n),n},d=function(t){return E(t,m)?t[m]:{}},function(t){return E(t,m)}),hn={set:rt,get:d,has:ln,enforce:function(t){return ln(t)?d(t):rt(t,{})},getterFor:function(n){return function(t){if(S(t)&&(t=d(t)).type===n)return t;throw fn("Incompatible receiver, "+n+" required")}}},dn=_(function(t){var r=rn.CONFIGURABLE,o=hn.enforce,n=hn.get,i=Object.defineProperty,a=g&&!u(function(){return 8!==i(function(){},"length",{value:8}).length}),c=String(String).split("String"),t=t.exports=function(t,n,e){"Symbol("===String(n).slice(0,7)&&(n="["+String(n).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),e&&e.getter&&(n="get "+n),e&&e.setter&&(n="set "+n),(!E(t,"name")||r&&t.name!==n)&&(g?i(t,"name",{value:n,configurable:!0}):t.name=n),a&&e&&E(e,"arity")&&t.length!==e.arity&&i(t,"length",{value:e.arity});try{e&&E(e,"constructor")&&e.constructor?g&&i(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch(t){}e=o(t);return E(e,"source")||(e.source=c.join("string"==typeof n?n:"")),t};Function.prototype.toString=t(function(){return b(this)&&n(this).source||an(this)},"toString")}),pn=Math.ceil,mn=Math.floor,gn=Math.trunc||function(t){t=+t;return(0<t?mn:pn)(t)},yn=function(t){t=+t;return t!=t||0==t?0:gn(t)},vn=Math.max,bn=Math.min,Sn=Math.min,Cn=function(t){return 0<t?Sn(yn(t),9007199254740991):0},C={includes:Y(!0),indexOf:Y(!1)},On=C.indexOf,xn=r([].push),wn=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],An=wn.concat("length","prototype"),En={f:Object.getOwnPropertyNames||function(t){return Q(t,An)}},Ln={f:Object.getOwnPropertySymbols},jn=r([].concat),In=o("Reflect","ownKeys")||function(t){var n=En.f(I(t)),e=Ln.f;return e?jn(n,e(t)):n},kn=/#|\.prototype\./,Tn=a.normalize=function(t){return String(t).replace(kn,".").toLowerCase()},Pn=a.data={},Mn=a.NATIVE="N",Rn=a.POLYFILL="P",Nn=a,Bn=Xt.f,Dn=r(r.bind),M=Array.isArray||function(t){return"Array"==e(t)},P={},T=(P[i("toStringTag")]="z","[object z]"===String(P)),Fn=i("toStringTag"),_n=Object,Gn="Arguments"==e(function(){return arguments}()),Hn=T?e:function(t){var n;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=function(t,n){try{return t[n]}catch(t){}}(t=_n(t),Fn))?n:Gn?e(t):"Object"==(n=e(t))&&b(t.callee)?"Arguments":n},Un=[],zn=o("Reflect","construct"),qn=/^\s*(?:class|function)\b/,Jn=r(qn.exec),Vn=!qn.exec(Z),Xn=(tt.sham=!0,!zn||u(function(){var t;return l(l.call)||!l(Object)||!l(function(){t=!0})||t})?tt:l),Wn=i("species"),$n=Array,Kn=function(t){var n;return M(t)&&(n=t.constructor,(Xn(n)&&(n===$n||M(n.prototype))||S(n)&&null===(n=n[Wn]))&&(n=void 0)),void 0===n?$n:n},Yn=r([].push),P={forEach:h(0),map:h(1),filter:h(2),some:h(3),every:h(4),find:h(5),findIndex:h(6),filterReject:h(7)},Qn=P.forEach,Zn=et("forEach")?[].forEach:function(t){return Qn(this,t,1<arguments.length?arguments[1]:void 0)};c({target:"Array",proto:!0,forced:[].forEach!=Zn},{forEach:Zn});function te(n){if(n&&n.forEach!==Zn)try{en(n,"forEach",Zn)}catch(t){n.forEach=Zn}}T||$(Object.prototype,"toString",T?{}.toString:function(){return"[object "+Hn(this)+"]"},{unsafe:!0});var ne,ee={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},T=qt("span").classList,T=T&&T.constructor&&T.constructor.prototype,T=T===Object.prototype?void 0:T;for(ne in ee)ee[ne]&&te(y[ne]&&y[ne].prototype);te(T),c({target:"Array",stat:!0},{isArray:M});function re(t){if(9007199254740991<t)throw pe("Maximum allowed index exceeded")}function oe(t,n,e){(n=X(n))in t?k.f(t,n,H(0,e)):t[n]=e}function ie(t,n){if(!delete t[n])throw me("Cannot delete property "+q(n)+" of "+q(t))}function ae(n){return 51<=St||!u(function(){var t=[];return(t.constructor={})[ge]=function(){return{foo:1}},1!==t[n](Boolean).foo})}function ce(){var t=I(this),n="";return t.hasIndices&&(n+="d"),t.global&&(n+="g"),t.ignoreCase&&(n+="i"),t.multiline&&(n+="m"),t.dotAll&&(n+="s"),t.unicode&&(n+="u"),t.unicodeSets&&(n+="v"),t.sticky&&(n+="y"),n}function ue(){}function se(t){t.write(Le("")),t.close();var n=t.parentWindow.Object;return t=null,n}var fe,le=TypeError,he=Object.getOwnPropertyDescriptor,de=g&&!function(){if(void 0!==this)return 1;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(t){return t instanceof TypeError}}()?function(t,n){if(M(t)&&!he(t,"length").writable)throw le("Cannot set read only .length");return t.length=n}:function(t,n){return t.length=n},pe=TypeError,me=TypeError,ge=i("species"),T=ae("splice"),ye=Math.max,ve=Math.min,be=(c({target:"Array",proto:!0,forced:!T},{splice:function(t,n){var e,r,o,i,a,c,u=O(this),s=x(u),f=K(t,s),t=arguments.length;for(0===t?e=r=0:r=1===t?(e=0,s-f):(e=t-2,ve(ye(yn(n),0),s-f)),re(s+e-r),o=nt(u,r),i=0;i<r;i++)(a=f+i)in u&&oe(o,i,u[a]);if(e<(o.length=r)){for(i=f;i<s-r;i++)c=i+e,(a=i+r)in u?u[c]=u[a]:ie(u,c);for(i=s;s-r+e<i;i--)ie(u,i-1)}else if(r<e)for(i=s-r;f<i;i--)c=i+e-1,(a=i+r-1)in u?u[c]=u[a]:ie(u,c);for(i=0;i<e;i++)u[i+f]=arguments[i+2];return de(u,s-r+e),o}}),String),Se=y.RegExp,T=u(function(){var t=Se("a","y");return t.lastIndex=2,null!=t.exec("abcd")}),R=T||u(function(){return!Se("a","y").sticky}),R={BROKEN_CARET:T||u(function(){var t=Se("^r","gy");return t.lastIndex=2,null!=t.exec("str")}),MISSED_STICKY:R,UNSUPPORTED_Y:T},Ce=Object.keys||function(t){return Q(t,wn)},Oe={f:g&&!n?Object.defineProperties:function(t,n){I(t);for(var e,r=f(n),o=Ce(n),i=o.length,a=0;a<i;)k.f(t,e=o[a++],r[e]);return t}},xe=o("document","documentElement"),we="prototype",Ae="script",Ee=W("IE_PROTO"),Le=function(t){return"<"+Ae+">"+t+"</"+Ae+">"},je=function(){try{fe=new ActiveXObject("htmlfile")}catch(t){}je="undefined"==typeof document||document.domain&&fe?se(fe):(t=qt("iframe"),n="java"+Ae+":",t.style.display="none",xe.appendChild(t),t.src=String(n),(n=t.contentWindow.document).open(),n.write(Le("document.F=Object")),n.close(),n.F);for(var t,n,e=wn.length;e--;)delete je[we][wn[e]];return je()},Ie=(un[Ee]=!0,Object.create||function(t,n){var e;return null!==t?(ue[we]=I(t),e=new ue,ue[we]=null,e[Ee]=t):e=je(),void 0===n?e:Oe.f(e,n)}),ke=y.RegExp,T=u(function(){var t=ke(".","s");return!t.dotAll||!t.exec("\n")||"s"!==t.flags}),Te=y.RegExp,n=u(function(){var t=Te("(?<a>b)","g");return"b"!==t.exec("b").groups.a||"bc"!=="b".replace(t,"$<a>c")}),Pe=hn.get,Me=w("native-string-replace",String.prototype.replace),Re=RegExp.prototype.exec,Ne=Re,Be=r("".charAt),De=r("".indexOf),Fe=r("".replace),_e=r("".slice),Ge=(w=/b*/g,v(Re,N=/a/,"a"),v(Re,w,"a"),0!==N.lastIndex||0!==w.lastIndex),He=R.BROKEN_CARET,Ue=void 0!==/()??/.exec("")[1],N=Ne=Ge||Ue||He||T||n?function(t){var n,e,r,o,i,a,c=this,u=Pe(c),t=function(t){if("Symbol"===Hn(t))throw TypeError("Cannot convert a Symbol value to a string");return be(t)}(t),s=u.raw;if(s)return s.lastIndex=c.lastIndex,l=v(Ne,s,t),c.lastIndex=s.lastIndex,l;var f=u.groups,s=He&&c.sticky,l=v(ce,c),u=c.source,h=0,d=t;if(s&&(l=Fe(l,"y",""),-1===De(l,"g")&&(l+="g"),d=_e(t,c.lastIndex),0<c.lastIndex&&(!c.multiline||c.multiline&&"\n"!==Be(t,c.lastIndex-1))&&(u="(?: "+u+")",d=" "+d,h++),n=new RegExp("^(?:"+u+")",l)),Ue&&(n=new RegExp("^"+u+"$(?!\\s)",l)),Ge&&(e=c.lastIndex),r=v(Re,s?n:c,d),s?r?(r.input=_e(r.input,h),r[0]=_e(r[0],h),r.index=c.lastIndex,c.lastIndex+=r[0].length):c.lastIndex=0:Ge&&r&&(c.lastIndex=c.global?r.index+r[0].length:e),Ue&&r&&1<r.length&&v(Me,r[0],n,function(){for(o=1;o<arguments.length-2;o++)void 0===arguments[o]&&(r[o]=void 0)}),r&&f)for(r.groups=i=Ie(null),o=0;o<f.length;o++)i[(a=f[o])[0]]=r[a[1]];return r}:Ne,w=(c({target:"RegExp",proto:!0,forced:/./.exec!==N},{exec:N}),k.f),R=i("unscopables"),T=Array.prototype,ze=(null==T[R]&&w(T,R,{configurable:!0,value:Ie(null)}),P.findIndex),n="findIndex",qe=!0;n in[]&&Array(1)[n](function(){qe=!1}),c({target:"Array",proto:!0,forced:qe},{findIndex:function(t){return ze(this,t,1<arguments.length?arguments[1]:void 0)}});c({target:"Date",proto:T[R][n]=!0,arity:1,forced:u(function(){return null!==new Date(NaN).toJSON()||1!==Date.prototype.toJSON.call({toISOString:function(){return 1}})})},{toJSON:function(t){var n=O(this),e=V(n,"number");return"number"!=typeof e||isFinite(e)?n.toISOString():null}}),c({target:"URL",proto:!0,enumerable:!0},{toJSON:function(){return v(URL.prototype.toString,this)}});var Je=i("isConcatSpreadable"),N=51<=St||!u(function(){var t=[];return t[Je]=!1,t.concat()[0]!==t}),w=ae("concat"),Ve=(c({target:"Array",proto:!0,arity:1,forced:!N||!w},{concat:function(t){for(var n,e,r,o,i,a=O(this),c=nt(a,0),u=0,s=-1,f=arguments.length;s<f;s++)if(i=void 0,!S(o=r=-1===s?a:arguments[s])||(void 0!==(i=o[Je])?!i:!M(o)))re(u+1),oe(c,u++,r);else for(e=x(r),re(u+e),n=0;n<e;n++,u++)n in r&&oe(c,u,r[n]);return c.length=u,c}}),P.map),Xe=(c({target:"Array",proto:!0,forced:!ae("map")},{map:function(t){return Ve(this,t,1<arguments.length?arguments[1]:void 0)}}),r([].slice)),R=ae("slice"),We=i("species"),$e=Array,Ke=Math.max,Ye=(c({target:"Array",proto:!0,forced:!R},{slice:function(t,n){var e,r,o,i=f(this),a=x(i),c=K(t,a),u=K(void 0===n?a:n,a);if(M(i)&&(e=i.constructor,(e=Xn(e)&&(e===$e||M(e.prototype))||S(e)&&null===(e=e[We])?void 0:e)===$e||void 0===e))return Xe(i,c,u);for(r=new(void 0===e?$e:e)(Ke(u-c,0)),o=0;c<u;c++,o++)c in i&&oe(r,o,i[c]);return r.length=o,r}}),P.filter),Qe=(c({target:"Array",proto:!0,forced:!ae("filter")},{filter:function(t){return Ye(this,t,1<arguments.length?arguments[1]:void 0)}}),C.indexOf),Ze=r([].indexOf),tr=!!Ze&&1/Ze([1],1,-0)<0,n=et("indexOf");function nr(r){for(var o={},t=arguments.length,n=new Array(1<t?t-1:0),e=1;e<t;e++)n[e-1]=arguments[e];return n.forEach(function(t){if(Array.isArray(t))t.forEach(function(t){r&&r.hasOwnProperty(t)&&(o[t]=r[t])},o);else if(s.util.isFunction(t))for(var n in r){var e;r.hasOwnProperty(n)&&(t(e=r[n],n)&&(o[n]=e))}}),o}function er(t){return Array.isArray(t)?t:[t]}c({target:"Array",proto:!0,forced:tr||!n},{indexOf:function(t){var n=1<arguments.length?arguments[1]:void 0;return tr?Ze(this,t,n)||0:Qe(this,t,n)}});N=t.Model.extend({defaults:{cmdBeforeAdd:null,cmdNameRegex:/^(?:add|remove|change:\w+)$/,applyOptionsList:["propertyPath"],revertOptionsList:["propertyPath"],storeReducedOptions:!0,stackLimit:1/0},PREFIX_LENGTH:7,initialize:function(t){s.util.bindAll(this,"initBatchCommand","storeBatchCommand"),this.graph=t.graph,this.reset(),this.listen()},listen:function(){this.listenTo(this.graph,"all",this.addCommand,this),this.listenTo(this.graph,"batch:start",this.initBatchCommand,this),this.listenTo(this.graph,"batch:stop",this.storeBatchCommand,this)},createCommand:function(t){return{action:void 0,data:{id:void 0,type:void 0,previous:{},next:{}},batch:t&&t.batch}},push:function(t,n){this.redoStack=[],t.batch?(this.lastCmdIndex=Math.max(this.lastCmdIndex,0),this.trigger("batch",t)):(this._push(this.undoStack,t),this.notifyStackChange("push",t,n),this.trigger("add",t))},_push:function(t,n){var e=this.attributes.stackLimit,e=void 0===e?1/0:e;t.push(n),t.length>e&&t.splice(0,t.length-e)},squashUndo:function(t){this.constructor.squashCommands(this.undoStack,t)},squashRedo:function(t){this.constructor.squashCommands(this.redoStack,t)},addCommand:function(e,r,t,n){var o,i,a,c;(n=n||{}).dry||this.get("cmdNameRegex").test(e)&&("function"!=typeof this.get("cmdBeforeAdd")||this.get("cmdBeforeAdd").apply(this,arguments))&&(i=void 0,o=r instanceof s.dia.Graph,this.batchCommand?(i=this.batchCommand[Math.max(this.lastCmdIndex,0)],c=o&&!i.graphChange||i.data.id!==r.id,a=i.action!==e,0<=this.lastCmdIndex&&(c||a)&&((c=this.batchCommand.findIndex(function(t,n){return(o&&t.graphChange||t.data.id===r.id)&&t.action===e}))<0||"add"===e||"remove"===e?i=this.createCommand({batch:!0}):(i=this.batchCommand[c],this.batchCommand.splice(c,1)),this.lastCmdIndex=this.batchCommand.push(i)-1)):i=this.createCommand({batch:!1}),a=this.attributes.storeReducedOptions,"add"===e||"remove"===e?(i.action=e,i.data.id=r.id,i.data.type=r.attributes.type,i.data.attributes=s.util.merge({},r.toJSON()),i.options=a?this.reduceOptions(n):n):(c=e.substr(this.PREFIX_LENGTH),i.batch&&i.action||(i.action=e,i.data.previous[c]=s.util.clone(r.previous(c)),i.options=a?this.reduceOptions(n):n,o?i.graphChange=!0:(i.data.id=r.id,i.data.type=r.attributes.type)),i.data.next[c]=s.util.clone(r.get(c))),this.push(i,n))},reduceOptions:function(t){var n=this.attributes;return nr(t,n.applyOptionsList,n.revertOptionsList)},initBatchCommand:function(){this.batchCommand?this.batchLevel++:(this.batchCommand=[this.createCommand({batch:!0})],this.lastCmdIndex=-1,this.batchLevel=0)},storeBatchCommand:function(t){var n;this.batchCommand&&this.batchLevel<=0?(0<(n=this.constructor.filterBatchCommand(this.batchCommand)).length&&(this.redoStack=[],this._push(this.undoStack,n),this.notifyStackChange("push",n,t),this.trigger("add",n)),this.batchCommand=null,this.lastCmdIndex=null,this.batchLevel=null):this.batchCommand&&0<this.batchLevel&&this.batchLevel--},revertCommand:function(t,n){this.stopListening(),e=Array.isArray(t)?this.constructor.sortBatchCommand(t):[t];for(var e,r=this.graph,o=e.length-1;0<=o;o--){var i=e[o],a=i.graphChange?r:r.getCell(i.data.id),c=s.util.assign({commandManager:this.id||this.cid},n,nr(i.options,this.get("revertOptionsList")));switch(i.action){case"add":a.remove(c);break;case"remove":r.addCell(i.data.attributes,c);break;default:var u=i.action.substr(this.PREFIX_LENGTH);a.set(u,i.data.previous[u],c)}}this.listen()},applyCommand:function(t,n){this.stopListening(),e=Array.isArray(t)?this.constructor.sortBatchCommand(t):[t];for(var e,r=this.graph,o=0;o<e.length;o++){var i=e[o],a=i.graphChange?r:r.getCell(i.data.id),c=s.util.assign({commandManager:this.id||this.cid},n,nr(i.options,this.get("applyOptionsList")));switch(i.action){case"add":r.addCell(i.data.attributes,c);break;case"remove":a.remove(c);break;default:var u=i.action.substr(this.PREFIX_LENGTH);a.set(u,i.data.next[u],c)}}this.listen()},undo:function(t){var n=this.undoStack.pop();n&&(this.revertCommand(n,t),this.redoStack.push(n),this.notifyStackChange("undo",n,t))},redo:function(t){var n=this.redoStack.pop();n&&(this.applyCommand(n,t),this.undoStack.push(n),this.notifyStackChange("redo",n,t))},cancel:function(t){var n=this.undoStack.pop();n&&(this.revertCommand(n,t),this.redoStack=[],this.notifyStackChange("cancel",n,t))},reset:function(t){this.undoStack=[],this.redoStack=[],this.notifyStackChange("reset",null,t)},hasUndo:function(){return 0<this.undoStack.length},hasRedo:function(){return 0<this.redoStack.length},notifyStackChange:function(t,n){var e=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},n=n?[er(n),e]:[e];this.trigger.apply(this,["stack:".concat(t)].concat(D(n))),this.trigger("stack",e)},toJSON:function(){var t=this.undoStack,n=this.redoStack;return{undo:this.exportBatchCommands(t),redo:this.exportBatchCommands(n)}},fromJSON:function(t,n){if(!t||!Array.isArray(t.undo)||!Array.isArray(t.redo))throw new Error("dia.CommandManager: JSON must contain undo and redo arrays.");this.undoStack=t.undo,this.redoStack=t.redo,this.notifyStackChange("reset",null,n)},exportBatchCommands:function(t){var n=this,e=this.attributes.storeReducedOptions;return t.map(function(t){return er(t).map(function(t){t=s.util.clone(t);return e||(t.options=n.reduceOptions(t.options)),s.util.cloneDeep(t)})})}},{squashCommands:function(t){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1/0,e=t.length;if(!(e<2)){for(var n=Math.min(e,n),r=[];0<n;){var o=t.pop();Array.isArray(o)||(o.batch=!0,o=[o]),r.unshift.apply(r,D(o)),n--}e=this.filterBatchCommand(r);return t.push(e),e}},sortBatchCommand:function(t){for(var n=[],e=0;e<t.length;e++){var r=t[e],o=null;if("add"===r.action)for(var i=r.data.id,a=0;a<e;a++)if(t[a].data.id===i){o=a;break}null!==o?n.splice(o,0,r):n.push(r)}return n},filterBatchCommand:function(t){for(var n=t.slice(),e=[];0<n.length;){var r=n.shift(),o=r.data.id;if(null!=r.action&&(null!=o||r.graphChange)){if("add"===r.action){var i=n.findIndex(function(t){return"remove"===t.action&&t.data&&t.data.id===o});if(0<=i){n=n.filter(function(t,n){return i<n||t.data.id!==o});continue}}else if("remove"===r.action){var a=n.findIndex(function(t){return"add"===t.action&&t.data&&t.data.id==o});if(0<=a){n.splice(a,1);continue}}else if(0===r.action.indexOf("change")&&s.util.isEqual(r.data.previous,r.data.next))continue;e.push(r)}}return e}});N.sortBatchCommands=N.sortBatchCommand,N.prototype.filterBatchCommand=function(t){return this.constructor.filterBatchCommand(t)},B.CommandManager=N}(this.joint.dia=this.joint.dia||{},Backbone,joint);