/*! JointJS+ v3.6.3 - HTML5 Diagramming Framework

Copyright (c) 2022 client IO

 2022-12-09 


This Source Code Form is subject to the terms of the JointJS+ License
, v. 2.0. If a copy of the JointJS+ License was not distributed with this
file, You can obtain one at http://jointjs.com/license/rappid_v2.txt
 or from the JointJS+ archive as was distributed by client IO. See the LICENSE file.*/


this.joint=this.joint||{},function(F,h,S){"use strict";h=h&&Object.prototype.hasOwnProperty.call(h,"default")?h.default:h;var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function N(t,e){return t(e={exports:{}},e.exports),e.exports}function e(t){return t&&t.Math==Math&&t}function s(t){try{return!!t()}catch(t){return!0}}function B(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}function V(t){return tt?ot(t):function(){return it.apply(t,arguments)}}function n(t){if("Function"===O(t))return V(t)}function H(t){if(ft(t))throw pt("Can't call method on "+t);return t}function u(t){return lt(H(t))}function r(t,e){return arguments.length<2?(n=y[t],T(n)?n:void 0):y[t]&&y[t][e];var n}function G(t){return It(H(t))}function k(t){return"Symbol("+(void 0===t?"":t)+")_"+Rt(++Lt+zt,36)}function i(t){var e;return A(I,t)&&(yt||"string"==typeof I[t])||(e="Symbol."+t,yt&&A(D,t)?I[t]=D[t]:I[t]=(vt&&Ct?Ct:Mt)(e)),I[t]}function o(t){return t=function(t,e){if(!P(t)||St(t))return t;var n=Pt(t,Nt);if(n){if(n=b(n,t,e=void 0===e?"default":e),!P(n)||St(n))return n;throw Ft("Can't convert object to primitive value")}return xt(t,e=void 0===e?"number":e)}(t,"string"),St(t)?t:t+""}function c(t){if(P(t))return t;throw Ut(Wt(t)+" is not an object")}function _(t){return ne[t]||(ne[t]=k(t))}function W(t,e,n,r){var i=(r=r||{}).enumerable,o=void 0!==r.name?r.name:e;if(T(n)&&se(n,o,r),r.global)i?t[e]=n:At(e,n);else{try{r.unsafe?t[e]&&(i=!0):delete t[e]}catch(t){}i?t[e]=n:L.f(t,e,{value:n,enumerable:!1,configurable:!r.nonConfigurable,writable:!r.nonWritable})}}function U(t,e){return(t=pe(t))<0?he(t+e,0):de(t,e)}function w(t){return me(t.length)}function $(c){return function(t,e,n){var r,i=u(t),o=w(i),a=U(n,o);if(c&&e!=e){for(;a<o;)if((r=i[a++])!=r)return!0}else for(;a<o;a++)if((c||a in i)&&i[a]===e)return c||a||0;return!c&&-1}}function q(t,e){var n,r=u(t),i=0,o=[];for(n in r)!A(re,n)&&A(r,n)&&ve(o,n);for(;e.length>i;)!A(r,n=e[i++])||~ye(o,n)||ve(o,n);return o}function a(t,e){return(t=Ee[xe(t)])==Ie||t!=Ae&&(T(e)?s(e):!!e)}function l(t,e){var n,r,i,o=t.target,a=t.global,c=t.stat,s=a?y:c?y[o]||At(o,{}):(y[o]||{}).prototype;if(s)for(n in e){if(r=e[n],i=t.dontCallGetSet?(i=Le(s,n))&&i.value:s[n],!De(a?n:o+(c?".":"#")+n,t.forced)&&void 0!==i){if(typeof r==typeof i)continue;for(var u=r,l=i,f=m=g=d=h=p=void 0,p=Pe(l),h=L.f,d=_t.f,g=0;g<p.length;g++){var m=p[g];A(u,m)||f&&A(f,m)||h(u,m,d(l,m))}}(t.sham||i&&i.sham)&&Qt(r,"sham",!0),W(s,n,r,t)}}function X(){}function f(t){if(!T(t))return!1;try{return Be(X,Ne,t),!0}catch(t){return!1}}function Y(t){if(!T(t))return!1;switch(Fe(t)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return Ge||!!He(Ve,ee(t))}catch(t){return!0}}function K(t,e){return new(Ue(t))(0===e?0:e)}function p(d){var g=1==d,m=2==d,y=3==d,v=4==d,b=6==d,S=7==d,O=5==d||b;return function(t,e,n,r){for(var i,o,a,c,s=G(t),u=lt(s),l=(o=n,Tt(i=e),void 0===o?i:tt?ze(i,o):function(){return i.apply(o,arguments)}),f=w(u),p=0,n=r||K,h=g?n(t,f):m||S?n(t,0):void 0;p<f;p++)if((O||p in u)&&(c=l(a=u[p],p,s),d))if(g)h[p]=c;else if(c)switch(d){case 3:return!0;case 5:return a;case 6:return p;case 2:$e(h,a)}else switch(d){case 4:return!1;case 7:$e(h,a)}return b?-1:y||v?v:h}}function J(e){return 51<=mt||!s(function(){var t=[];return(t.constructor={})[qe]=function(){return{foo:1}},1!==t[e](Boolean).foo})}function Q(t,e){var n=[][t];return!!n&&s(function(){n.call(null,e||function(){return 1},1)})}var Z,d,g,m,y=e("object"==typeof globalThis&&globalThis)||e("object"==typeof window&&window)||e("object"==typeof self&&self)||e("object"==typeof t&&t)||function(){return this}()||Function("return this")(),v=!s(function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}),tt=!s(function(){var t=function(){}.bind();return"function"!=typeof t||t.hasOwnProperty("prototype")}),et=Function.prototype.call,b=tt?et.bind(et):function(){return et.apply(et,arguments)},t={}.propertyIsEnumerable,nt=Object.getOwnPropertyDescriptor,rt={f:nt&&!t.call({1:2},1)?function(t){t=nt(this,t);return!!t&&t.enumerable}:t},t=Function.prototype,it=t.call,ot=tt&&t.bind.bind(it,it),at=V({}.toString),ct=V("".slice),O=function(t){return ct(at(t),8,-1)},st=Object,ut=n("".split),lt=s(function(){return!st("z").propertyIsEnumerable(0)})?function(t){return"String"==O(t)?ut(t,""):st(t)}:st,ft=function(t){return null==t},pt=TypeError,t="object"==typeof document&&document.all,t={all:t,IS_HTMLDDA:void 0===t&&void 0!==t},ht=t.all,T=t.IS_HTMLDDA?function(t){return"function"==typeof t||t===ht}:function(t){return"function"==typeof t},dt=t.all,P=t.IS_HTMLDDA?function(t){return"object"==typeof t?null!==t:T(t)||t===dt}:function(t){return"object"==typeof t?null!==t:T(t)},gt=n({}.isPrototypeOf),t=r("navigator","userAgent")||"",j=y.process,x=y.Deno,j=j&&j.versions||x&&x.version,x=j&&j.v8,mt=R=!(R=x?0<(z=x.split("."))[0]&&z[0]<4?1:+(z[0]+z[1]):R)&&t&&(!(z=t.match(/Edge\/(\d+)/))||74<=z[1])&&(z=t.match(/Chrome\/(\d+)/))?+z[1]:R,yt=!!Object.getOwnPropertySymbols&&!s(function(){var t=Symbol();return!String(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&mt&&mt<41}),vt=yt&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,bt=Object,St=vt?function(t){return"symbol"==typeof t}:function(t){var e=r("Symbol");return T(e)&&gt(e.prototype,bt(t))},Ot=String,wt=TypeError,Tt=function(t){if(T(t))return t;throw wt(function(t){try{return Ot(t)}catch(t){return"Object"}}(t)+" is not a function")},Pt=function(t,e){t=t[e];return ft(t)?void 0:Tt(t)},jt=TypeError,xt=function(t,e){var n,r;if("string"===e&&T(n=t.toString)&&!P(r=b(n,t)))return r;if(T(n=t.valueOf)&&!P(r=b(n,t)))return r;if("string"!==e&&T(n=t.toString)&&!P(r=b(n,t)))return r;throw jt("Can't convert object to primitive value")},Et=Object.defineProperty,At=function(e,n){try{Et(y,e,{value:n,configurable:!0,writable:!0})}catch(t){y[e]=n}return n},j="__core-js_shared__",E=y[j]||At(j,{}),x=N(function(t){(t.exports=function(t,e){return E[t]||(E[t]=void 0!==e?e:{})})("versions",[]).push({version:"3.25.5",mode:"global",copyright:"Â© 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.25.5/LICENSE",source:"https://github.com/zloirock/core-js"})}),It=Object,Dt=n({}.hasOwnProperty),A=Object.hasOwn||function(t,e){return Dt(G(t),e)},Lt=0,zt=Math.random(),Rt=n(1..toString),I=x("wks"),D=y.Symbol,Ct=D&&D.for,Mt=vt?D:D&&D.withoutSetter||k,Ft=TypeError,Nt=i("toPrimitive"),Bt=y.document,Vt=P(Bt)&&P(Bt.createElement),Ht=function(t){return Vt?Bt.createElement(t):{}},Gt=!v&&!s(function(){return 7!=Object.defineProperty(Ht("div"),"a",{get:function(){return 7}}).a}),kt=Object.getOwnPropertyDescriptor,_t={f:v?kt:function(t,e){if(t=u(t),e=o(e),Gt)try{return kt(t,e)}catch(t){}if(A(t,e))return B(!b(rt.f,t,e),t[e])}},t=v&&s(function(){return 42!=Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype}),Wt=String,Ut=TypeError,$t=TypeError,qt=Object.defineProperty,Xt=Object.getOwnPropertyDescriptor,Yt="enumerable",Kt="configurable",Jt="writable",L={f:v?t?function(t,e,n){var r;return c(t),e=o(e),c(n),"function"==typeof t&&"prototype"===e&&"value"in n&&Jt in n&&!n[Jt]&&((r=Xt(t,e))&&r[Jt]&&(t[e]=n.value,n={configurable:(Kt in n?n:r)[Kt],enumerable:(Yt in n?n:r)[Yt],writable:!1})),qt(t,e,n)}:qt:function(t,e,n){if(c(t),e=o(e),c(n),Gt)try{return qt(t,e,n)}catch(t){}if("get"in n||"set"in n)throw $t("Accessors not supported");return"value"in n&&(t[e]=n.value),t}},Qt=v?function(t,e,n){return L.f(t,e,B(1,n))}:function(t,e,n){return t[e]=n,t},z=Function.prototype,R=v&&Object.getOwnPropertyDescriptor,j=A(z,"name"),Zt={EXISTS:j,PROPER:j&&"something"===function(){}.name,CONFIGURABLE:j&&(!v||R(z,"name").configurable)},te=n(Function.toString),ee=(T(E.inspectSource)||(E.inspectSource=function(t){return te(t)}),E.inspectSource),j=y.WeakMap,R=T(j)&&/native code/.test(String(j)),ne=x("keys"),re={},ie="Object already initialized",oe=y.TypeError,z=y.WeakMap,ae=R||E.state?((g=E.state||(E.state=new z)).get=g.get,g.has=g.has,g.set=g.set,Z=function(t,e){if(g.has(t))throw oe(ie);return e.facade=t,g.set(t,e),e},d=function(t){return g.get(t)||{}},function(t){return g.has(t)}):(m=_("state"),re[m]=!0,Z=function(t,e){if(A(t,m))throw oe(ie);return e.facade=t,Qt(t,m,e),e},d=function(t){return A(t,m)?t[m]:{}},function(t){return A(t,m)}),ce={set:Z,get:d,has:ae,enforce:function(t){return ae(t)?d(t):Z(t,{})},getterFor:function(e){return function(t){if(P(t)&&(t=d(t)).type===e)return t;throw oe("Incompatible receiver, "+e+" required")}}},se=N(function(t){var r=Zt.CONFIGURABLE,i=ce.enforce,e=ce.get,o=Object.defineProperty,a=v&&!s(function(){return 8!==o(function(){},"length",{value:8}).length}),c=String(String).split("String"),t=t.exports=function(t,e,n){"Symbol("===String(e).slice(0,7)&&(e="["+String(e).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),n&&n.getter&&(e="get "+e),n&&n.setter&&(e="set "+e),(!A(t,"name")||r&&t.name!==e)&&(v?o(t,"name",{value:e,configurable:!0}):t.name=e),a&&n&&A(n,"arity")&&t.length!==n.arity&&o(t,"length",{value:n.arity});try{n&&A(n,"constructor")&&n.constructor?v&&o(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch(t){}n=i(t);return A(n,"source")||(n.source=c.join("string"==typeof e?e:"")),t};Function.prototype.toString=t(function(){return T(this)&&e(this).source||ee(this)},"toString")}),ue=Math.ceil,le=Math.floor,fe=Math.trunc||function(t){t=+t;return(0<t?le:ue)(t)},pe=function(t){t=+t;return t!=t||0==t?0:fe(t)},he=Math.max,de=Math.min,ge=Math.min,me=function(t){return 0<t?ge(pe(t),9007199254740991):0},j={includes:$(!0),indexOf:$(!1)},ye=j.indexOf,ve=n([].push),be=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],Se=be.concat("length","prototype"),Oe={f:Object.getOwnPropertyNames||function(t){return q(t,Se)}},we={f:Object.getOwnPropertySymbols},Te=n([].concat),Pe=r("Reflect","ownKeys")||function(t){var e=Oe.f(c(t)),n=we.f;return n?Te(e,n(t)):e},je=/#|\.prototype\./,xe=a.normalize=function(t){return String(t).replace(je,".").toLowerCase()},Ee=a.data={},Ae=a.NATIVE="N",Ie=a.POLYFILL="P",De=a,Le=_t.f,ze=n(n.bind),C=Array.isArray||function(t){return"Array"==O(t)},x={},R=(x[i("toStringTag")]="z","[object z]"===String(x)),Re=i("toStringTag"),Ce=Object,Me="Arguments"==O(function(){return arguments}()),Fe=R?O:function(t){var e;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(e=function(t,e){try{return t[e]}catch(t){}}(t=Ce(t),Re))?e:Me?O(t):"Object"==(e=O(t))&&T(t.callee)?"Arguments":e},Ne=[],Be=r("Reflect","construct"),Ve=/^\s*(?:class|function)\b/,He=n(Ve.exec),Ge=!Ve.exec(X),ke=(Y.sham=!0,!Be||s(function(){var t;return f(f.call)||!f(Object)||!f(function(){t=!0})||t})?Y:f),_e=i("species"),We=Array,Ue=function(t){var e;return C(t)&&(e=t.constructor,(ke(e)&&(e===We||C(e.prototype))||P(e)&&null===(e=e[_e]))&&(e=void 0)),void 0===e?We:e},$e=n([].push),z={forEach:p(0),map:p(1),filter:p(2),some:p(3),every:p(4),find:p(5),findIndex:p(6),filterReject:p(7)},qe=i("species"),Xe=z.map,Ye=(l({target:"Array",proto:!0,forced:!J("map")},{map:function(t){return Xe(this,t,1<arguments.length?arguments[1]:void 0)}}),l({target:"Array",stat:!0},{isArray:C}),z.forEach),M=Q("forEach")?[].forEach:function(t){return Ye(this,t,1<arguments.length?arguments[1]:void 0)};l({target:"Array",proto:!0,forced:[].forEach!=M},{forEach:M});function Ke(e){if(e&&e.forEach!==M)try{Qt(e,"forEach",M)}catch(t){e.forEach=M}}R||W(Object.prototype,"toString",R?{}.toString:function(){return"[object "+Fe(this)+"]"},{unsafe:!0});var Je,Qe={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},x=Ht("span").classList,z=x&&x.constructor&&x.constructor.prototype,R=z===Object.prototype?void 0:z;for(Je in Qe)Qe[Je]&&Ke(y[Je]&&y[Je].prototype);Ke(R);function Ze(){}function tn(t){t.write(hn("")),t.close();var e=t.parentWindow.Object;return t=null,e}function en(t){if(P(e=t)&&(void 0!==(n=e[mn])?!!n:"RegExp"==O(e)))throw yn("The method doesn't accept regular expressions");var e,n;return t}function nn(t){if("Symbol"===Fe(t))throw TypeError("Cannot convert a Symbol value to a string");return vn(t)}function rn(t){if(9007199254740991<t)throw On("Maximum allowed index exceeded")}function on(t,e,n){(e=o(e))in t?L.f(t,e,B(0,n)):t[e]=n}var an,cn=Object.keys||function(t){return q(t,be)},sn={f:v&&!t?Object.defineProperties:function(t,e){c(t);for(var n,r=u(e),i=cn(e),o=i.length,a=0;a<o;)L.f(t,n=i[a++],r[n]);return t}},un=r("document","documentElement"),ln="prototype",fn="script",pn=_("IE_PROTO"),hn=function(t){return"<"+fn+">"+t+"</"+fn+">"},dn=function(){try{an=new ActiveXObject("htmlfile")}catch(t){}dn="undefined"==typeof document||document.domain&&an?tn(an):(t=Ht("iframe"),e="java"+fn+":",t.style.display="none",un.appendChild(t),t.src=String(e),(e=t.contentWindow.document).open(),e.write(hn("document.F=Object")),e.close(),e.F);for(var t,e,n=be.length;n--;)delete dn[ln][be[n]];return dn()},x=(re[pn]=!0,Object.create||function(t,e){var n;return null!==t?(Ze[ln]=c(t),n=new Ze,Ze[ln]=null,n[pn]=t):n=dn(),void 0===e?n:sn.f(n,e)}),z=L.f,R=i("unscopables"),t=Array.prototype,gn=(null==t[R]&&z(t,R,{configurable:!0,value:x(null)}),j.includes),mn=(l({target:"Array",proto:!0,forced:s(function(){return!Array(1).includes()})},{includes:function(t){return gn(this,t,1<arguments.length?arguments[1]:void 0)}}),t[R].includes=!0,i("match")),yn=TypeError,vn=String,bn=i("match"),Sn=n("".indexOf),On=(l({target:"String",proto:!0,forced:!function(e){var n=/./;try{"/./"[e](n)}catch(t){try{return n[bn]=!1,"/./"[e](n)}catch(t){}}return!1}("includes")},{includes:function(t){return!!~Sn(nn(H(this)),nn(en(t)),1<arguments.length?arguments[1]:void 0)}}),TypeError),wn=i("isConcatSpreadable"),z=51<=mt||!s(function(){var t=[];return t[wn]=!1,t.concat()[0]!==t}),x=J("concat"),Tn=(l({target:"Array",proto:!0,arity:1,forced:!z||!x},{concat:function(t){for(var e,n,r,i,o,a=G(this),c=K(a,0),s=0,u=-1,l=arguments.length;u<l;u++)if(o=void 0,!P(i=r=-1===u?a:arguments[u])||(void 0!==(o=i[wn])?!o:!C(i)))rn(s+1),on(c,s++,r);else for(n=w(r),rn(s+n),e=0;e<n;e++,s++)e in r&&on(c,s,r[e]);return c.length=s,c}}),n([].slice)),t=J("slice"),Pn=i("species"),jn=Array,xn=Math.max,En=(l({target:"Array",proto:!0,forced:!t},{slice:function(t,e){var n,r,i,o=u(this),a=w(o),c=U(t,a),s=U(void 0===e?a:e,a);if(C(o)&&(n=o.constructor,(n=ke(n)&&(n===jn||C(n.prototype))||P(n)&&null===(n=n[Pn])?void 0:n)===jn||void 0===n))return Tn(o,c,s);for(r=new(void 0===n?jn:n)(xn(s-c,0)),i=0;c<s;c++,i++)c in o&&on(r,i,o[c]);return r.length=i,r}}),n([].join)),R=lt!=Object,z=Q("join",","),An=(l({target:"Array",proto:!0,forced:R||!z},{join:function(t){return En(u(this),void 0===t?",":t)}}),j.indexOf),In=n([].indexOf),Dn=!!In&&1/In([1],1,-0)<0,x=Q("indexOf"),Ln=(l({target:"Array",proto:!0,forced:Dn||!x},{indexOf:function(t){var e=1<arguments.length?arguments[1]:void 0;return Dn?In(this,t,e)||0:An(this,t,e)}}),S.mvc.View.extend({className:"free-transform",events:{"mousedown .resize":"startResizing","mousedown .rotate":"startRotating","touchstart .resize":"startResizing","touchstart .rotate":"startRotating"},DIRECTIONS:["nw","n","ne","e","se","s","sw","w"],POSITIONS:["top-left","top","top-right","right","bottom-right","bottom","bottom-left","left"],options:{cellView:void 0,rotateAngleGrid:15,resizeGrid:void 0,preserveAspectRatio:!1,minWidth:0,minHeight:0,maxWidth:1/0,maxHeight:1/0,allowOrthogonalResize:!0,resizeDirections:null,allowRotation:!0,clearAll:!0,clearOnBlankPointerdown:!0,usePaperScale:!1,padding:3},documentEvents:{mousemove:"pointermove",touchmove:"pointermove",mouseup:"pointerup",touchend:"pointerup"},init:function(){var t=this.options,e=(t.cellView?S.util.defaults(t,{cell:t.cellView.model,paper:t.cellView.paper,graph:t.cellView.paper.model}):t.paper&&t.cell&&S.util.defaults(t,{cellView:t.cell.findView(t.paper),graph:t.paper.model}),t.paper);t.clearAll&&this.constructor.clear(e),this.startListening(),e.$el.append(this.el),this.constructor.registerInstanceToPaper(this,e)},startListening:function(){var t=this,e=this.options,n=e.cell,r=e.paper,i=e.graph,e=e.clearOnBlankPointerdown;this.listenTo(n,"change:size change:position change:angle",this.onCellAttributeChange),this.listenTo(r,"scale translate",function(){return t.requestUpdate()}),this.listenTo(i,"reset",function(){return t.remove()}),this.listenTo(n,"remove",function(){return t.remove()}),e&&this.listenTo(r,"blank:pointerdown",function(){return t.remove()})},onCellAttributeChange:function(t,e,n){n.updateHandled||this.requestUpdate()},renderHandles:function(){var t=this.options,n=this.POSITIONS,e=h("<div/>").prop("draggable",!1),r=e.clone().addClass("rotate"),i=n.map(function(t){return e.clone().addClass("resize").attr("data-position",t)}),o=t.resizeDirections;Array.isArray(o)&&i.forEach(function(t,e){o.includes(n[e])||t.hide()}),this.$el.empty().append(i,r)},render:function(){var t=this.options,e=this.$el,n=t.cell,r=t.preserveAspectRatio,i=t.allowRotation,t=t.allowOrthogonalResize;e.attr("data-type",n.get("type")),e.toggleClass("no-orthogonal-resize",r||!t),e.toggleClass("no-rotation",!i),this.renderHandles(),this.requestUpdate()},requestUpdate:function(t){var e=this.UPDATE_PRIORITY;this.options.paper.requestViewUpdate(this,1,e,t)},confirmUpdate:function(){this.update()},update:function(){this.options.usePaperScale?this.updateFrameScaled():this.updateFrameNoScale(),this.updateHandleDirections()},updateFrameScaled:function(){var t=this.options,e=t.paper,n=t.cell,t=t.padding,t=S.util.normalizeSides(t),r=t.left,i=t.right,o=t.top,t=t.bottom,r=n.getBBox().moveAndExpand({x:-r,y:-o,width:r+i,height:o+t}),i=r.x,o=r.y,t=r.width,r=r.height,n=n.angle(),e=e.matrix().translate(i,o).translate(t/2,r/2).rotate(n).translate(-t/2,-r/2),i=S.V.matrixToTransformString(e);this.$el.css({width:t,height:r,left:0,top:0,"transform-origin":"0 0",transform:i,"-webkit-transform":i,"-ms-transform":i})},updateFrameNoScale:function(){var t=this.options,e=t.paper,n=t.cell,t=t.padding,t=S.util.normalizeSides(t),r=t.left,i=t.right,o=t.top,t=t.bottom,e=e.matrix(),a=e.a,c=e.d,s=e.e,e=e.f,u=n.getBBox(),n=n.angle(),s=(u.x*=a,u.x+=s,u.y*=c,u.y+=e,u.width*=a,u.height*=c,u.moveAndExpand({x:-r,y:-o,width:r+i,height:o+t}),"rotate(".concat(n,"deg)"));this.$el.css({width:u.width,height:u.height,left:u.x,top:u.y,"transform-origin":"50% 50%",transform:s,"-webkit-transform":s,"-ms-transform":s})},updateHandleDirections:function(){var n,t=this.options.cell.angle(),t=Math.floor(t*(this.DIRECTIONS.length/360));t!=this._previousDirectionsShift&&(n=this.DIRECTIONS.slice(t).concat(this.DIRECTIONS.slice(0,t)),this.$(".resize").removeClass(this.DIRECTIONS.join(" ")).each(function(t,e){h(e).addClass(n[t])}),this._previousDirectionsShift=t)},calculateTrueDirection:function(t){var e=this.options.cell,e=S.g.normalizeAngle(e.get("angle")),t=this.POSITIONS.indexOf(t),t=(t+=Math.floor(e*(this.POSITIONS.length/360)))%this.POSITIONS.length;return this.POSITIONS[t]},startResizing:function(t){t.stopPropagation();var e=this.options,n=e.cell,r=e.graph,i=e.paper,r=(r.startBatch("free-transform",{freeTransform:this.cid}),h(t.target).data("position")),o=this.calculateTrueDirection(r),a=0,c=0,s=(r.split("-").forEach(function(t){a={left:-1,right:1}[t]||a,c={top:-1,bottom:1}[t]||c}),this.toValidResizeDirection(r)),u={"top-right":"bottomLeft","top-left":"corner","bottom-left":"topRight","bottom-right":"origin"}[s],l=e.minWidth,f=e.minHeight,p=e.maxWidth,e=e.maxHeight,l="function"==typeof l?l.call(this,n,this):l,f="function"==typeof f?f.call(this,n,this):f,p="function"==typeof p?p.call(this,n,this):p,e="function"==typeof e?e.call(this,n,this):e,u={action:"resize",angle:n.angle(),resizeX:a,resizeY:c,selector:u,direction:s,relativeDirection:r,trueDirection:o,maxHeight:e,minHeight:f,maxWidth:p,minWidth:l,cellView:n.findView(i)};this.startOp(t.target),this.delegateDocumentEvents(null,u),this.trigger("".concat(u.action,":start"),t)},toValidResizeDirection:function(t){return{top:"top-left",bottom:"bottom-right",left:"bottom-left",right:"top-right"}[t]||t},startRotating:function(t){t.stopPropagation();var e=S.util.normalizeEvent(t),n=(this.options.graph.startBatch("free-transform",{freeTransform:this.cid}),this.options.cell.getBBox().center()),e=this.options.paper.snapToGrid({x:e.clientX,y:e.clientY}),e={action:"rotate",centerRotation:n,modelAngle:S.g.normalizeAngle(this.options.cell.get("angle")||0),startAngle:S.g.point(e).theta(n)};this.startOp(t.target),this.delegateDocumentEvents(null,e),this.trigger("".concat(e.action,":start"),t)},pointermove:function(t){var e=t.data,n=e.action,r=e.maxHeight,i=e.maxWidth,o=e.minHeight,a=e.minWidth,c=e.cellView;if(n){t=S.util.normalizeEvent(t);var s=this.options,u=s.cell,l=s.paper.snapToGrid({x:t.clientX,y:t.clientY}),f=s.paper.options.gridSize,p=s.resizeGrid||{},h=p.width||f,d=p.height||f;switch(n){case"resize":var g,m=u.getBBox(),y=S.g.point(l).rotate(m.center(),e.angle).difference(m[e.selector]()),v=e.resizeX?y.x*e.resizeX:m.width,y=e.resizeY?y.y*e.resizeY:m.height,v=S.g.snapToGrid(v,h),y=S.g.snapToGrid(y,d);v=Math.max(v,a||h),y=Math.max(y,o||d),v=Math.min(v,i),y=Math.min(y,r),s.preserveAspectRatio&&(b=m.width*y/m.height,g=m.height*v/m.width,v<b?y=g:v=b),m.width==v&&m.height==y||(g={freeTransform:this.cid,direction:e.direction,relativeDirection:e.relativeDirection,trueDirection:e.trueDirection,ui:!0,minWidth:a,minHeight:o,maxWidth:i,maxHeight:r,preserveAspectRatio:s.preserveAspectRatio},c.scalableNode&&(g.async=!1),u.resize(v,y,g));break;case"rotate":var b=e.startAngle-S.g.point(l).theta(e.centerRotation);u.rotate(S.g.snapToGrid(e.modelAngle+b,s.rotateAngleGrid),!0,null,{freeTransform:this.cid})}this.trigger("".concat(n),t)}},pointerup:function(t){this.undelegateDocumentEvents();var e=t.data;e&&e.action&&(this.stopOp(),this.trigger("".concat(e.action,":stop"),t),this.options.graph.stopBatch("free-transform",{freeTransform:this.cid}))},onRemove:function(){Ln.unregisterInstanceFromPaper(this,this.options.paper)},startOp:function(t){t&&(h(t).addClass("in-operation"),this._elementOp=t),this.$el.addClass("in-operation"),this.options.paper.undelegateEvents()},stopOp:function(){this._elementOp&&(h(this._elementOp).removeClass("in-operation"),this._elementOp=null),this.$el.removeClass("in-operation"),this.options.paper.delegateEvents()}},{instancesByPaper:{},clear:function(t){t.trigger("freetransform:create"),this.removeInstancesForPaper(t)},removeInstancesForPaper:function(t){S.util.invoke(this.getInstancesForPaper(t),"remove")},getInstancesForPaper:function(t){return this.instancesByPaper[t.cid]||{}},registerInstanceToPaper:function(t,e){this.instancesByPaper[e.cid]||(this.instancesByPaper[e.cid]={}),this.instancesByPaper[e.cid][t.cid]=t},unregisterInstanceFromPaper:function(t,e){this.instancesByPaper[e.cid]&&(this.instancesByPaper[e.cid][t.cid]=null)}}));F.FreeTransform=Ln}(this.joint.ui=this.joint.ui||{},$,joint);