/*! JointJS+ v3.6.3 - HTML5 Diagramming Framework

Copyright (c) 2022 client IO

 2022-12-09 


This Source Code Form is subject to the terms of the JointJS+ License
, v. 2.0. If a copy of the JointJS+ License was not distributed with this
file, You can obtain one at http://jointjs.com/license/rappid_v2.txt
 or from the JointJS+ archive as was distributed by client IO. See the LICENSE file.*/


this.joint=this.joint||{},function(H,u,h){"use strict";function V(t,e){return $(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var o,r,i=[],a=!0,s=!1;try{for(n=n.call(t);!(a=(o=n.next()).done)&&(i.push(o.value),!e||i.length!==e);a=!0);}catch(t){s=!0,r=t}finally{try{a||null==n.return||n.return()}finally{if(s)throw r}}return i}}(t,e)||F(t,e)||U()}function D(t){return $(t)||N(t)||F(t)||U()}function B(t){return function(t){if(Array.isArray(t))return G(t)}(t)||N(t)||F(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function $(t){if(Array.isArray(t))return t}function N(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function F(t,e){var n;if(t)return"string"==typeof t?G(t,e):"Map"===(n="Object"===(n=Object.prototype.toString.call(t).slice(8,-1))&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?G(t,e):void 0}function G(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}function U(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}u=u&&Object.prototype.hasOwnProperty.call(u,"default")?u.default:u;var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function z(t,e){return t(e={exports:{}},e.exports),e.exports}function W(t){return t&&t.Math==Math&&t}function c(t){try{return!!t()}catch(t){return!0}}function X(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}function Y(t){return bt?Tt(t):function(){return Et.apply(t,arguments)}}function o(t){return At(Ct(t),8,-1)}function l(t){if("Function"===o(t))return Y(t)}function K(t){if(Pt(t))throw It("Can't call method on "+t);return t}function q(t){return jt(K(t))}function n(t,e){return arguments.length<2?(n=y[t],x(n)?n:void 0):y[t]&&y[t][e];var n}function J(t){return Yt(K(t))}function Q(t){return"Symbol("+(void 0===t?"":t)+")_"+Qt(++qt+Jt,36)}function f(t){var e;return w(Zt,t)&&(Ht||"string"==typeof Zt[t])||(e="Symbol."+t,Ht&&w(te,t)?Zt[t]=te[t]:Zt[t]=(Vt&&ee?ee:ne)(e)),Zt[t]}function Z(t){return t=function(t,e){if(!d(t)||Bt(t))return t;var n=Gt(t,re);if(n){if(n=m(n,t,e=void 0===e?"default":e),!d(n)||Bt(n))return n;throw oe("Can't convert object to primitive value")}return zt(t,e=void 0===e?"number":e)}(t,"string"),Bt(t)?t:t+""}function tt(t){return Ee[t]||(Ee[t]=Q(t))}function et(t,e,n,o){var r=(o=o||{}).enumerable,i=void 0!==o.name?o.name:e;if(x(n)&&je(n,i,o),o.global)r?t[e]=n:Xt(e,n);else{try{o.unsafe?t[e]&&(r=!0):delete t[e]}catch(t){}r?t[e]=n:S.f(t,e,{value:n,enumerable:!1,configurable:!o.nonConfigurable,writable:!o.nonWritable})}return t}function nt(t,e){return(t=Le(t))<0?_e(t+e,0):Me(t,e)}function ot(t){return Ve(t.length)}function rt(s){return function(t,e,n){var o,r=q(t),i=ot(r),a=nt(n,i);if(s&&e!=e){for(;a<i;)if((o=r[a++])!=o)return!0}else for(;a<i;a++)if((s||a in r)&&r[a]===e)return s||a||0;return!s&&-1}}function it(t,e){var n,o=q(t),r=0,i=[];for(n in o)!w(Te,n)&&w(o,n)&&Be(i,n);for(;e.length>r;)!w(o,n=e[r++])||~De(i,n)||Be(i,n);return i}function at(t,e){return(t=Ye[Xe(t)])==qe||t!=Ke&&(x(e)?c(e):!!e)}function e(t,e){var n,o,r,i=t.target,a=t.global,s=t.stat,c=a?y:s?y[i]||Xt(i,{}):(y[i]||{}).prototype;if(c)for(n in e){if(o=e[n],r=t.dontCallGetSet?(r=Qe(c,n))&&r.value:c[n],!Je(a?n:i+(s?".":"#")+n,t.forced)&&void 0!==r){if(typeof o==typeof r)continue;for(var l=o,u=r,h=v=g=d=p=f=void 0,f=ze(u),p=S.f,d=ue.f,g=0;g<f.length;g++){var v=f[g];w(l,v)||h&&w(h,v)||p(l,v,d(u,v))}}(t.sham||r&&r.sham)&&be(o,"sham",!0),et(c,n,o,t)}}function st(){}function ct(t){if(!x(t))return!1;try{return an(st,rn,t),!0}catch(t){return!1}}function lt(t){if(!x(t))return!1;switch(on(t)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return ln||!!cn(sn,xe(t))}catch(t){return!0}}function ut(t,e,n){(e=Z(e))in t?S.f(t,e,X(0,n)):t[e]=n}function ht(e){return 51<=a||!c(function(){var t=[];return(t.constructor={})[hn]=function(){return{foo:1}},1!==t[e](Boolean).foo})}function ft(t){if(9007199254740991<t)throw vn("Maximum allowed index exceeded")}function pt(t,e){return Ze(t=t)&&(n=t.constructor,(un(n)&&(n===mn||Ze(n.prototype))||d(n)&&null===(n=n[yn]))&&(n=void 0)),new(void 0===n?mn:n)(0===e?0:e);var n}function dt(l){return function(t,e,n,o){b(e);var r=J(t),i=jt(r),a=ot(r),s=l?a-1:0,c=l?-1:1;if(n<2)for(;;){if(s in i){o=i[s],s+=c;break}if(s+=c,l?s<0:a<=s)throw wn("Reduce of empty array with no initial value")}for(;l?0<=s:s<a;s+=c)s in i&&(o=e(o,i[s],s,r));return o}}function gt(t,e){var n=[][t];return!!n&&c(function(){n.call(null,e||function(){return 1},1)})}var vt,yt,r,mt,y=W("object"==typeof globalThis&&globalThis)||W("object"==typeof window&&window)||W("object"==typeof self&&self)||W("object"==typeof t&&t)||function(){return this}()||Function("return this")(),p=!c(function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}),bt=!c(function(){var t=function(){}.bind();return"function"!=typeof t||t.hasOwnProperty("prototype")}),wt=Function.prototype.call,m=bt?wt.bind(wt):function(){return wt.apply(wt,arguments)},t={}.propertyIsEnumerable,St=Object.getOwnPropertyDescriptor,xt={f:St&&!t.call({1:2},1)?function(t){t=St(this,t);return!!t&&t.enumerable}:t},t=Function.prototype,Et=t.call,Tt=bt&&t.bind.bind(Et,Et),Ct=Y({}.toString),At=Y("".slice),Ot=Object,kt=l("".split),jt=c(function(){return!Ot("z").propertyIsEnumerable(0)})?function(t){return"String"==o(t)?kt(t,""):Ot(t)}:Ot,Pt=function(t){return null==t},It=TypeError,t="object"==typeof document&&document.all,t={all:t,IS_HTMLDDA:void 0===t&&void 0!==t},Rt=t.all,x=t.IS_HTMLDDA?function(t){return"function"==typeof t||t===Rt}:function(t){return"function"==typeof t},Lt=t.all,d=t.IS_HTMLDDA?function(t){return"object"==typeof t?null!==t:x(t)||t===Lt}:function(t){return"object"==typeof t?null!==t:x(t)},_t=l({}.isPrototypeOf),t=n("navigator","userAgent")||"",i=y.process,Mt=y.Deno,i=i&&i.versions||Mt&&Mt.version,Mt=i&&i.v8,a=v=!(v=Mt?0<(g=Mt.split("."))[0]&&g[0]<4?1:+(g[0]+g[1]):v)&&t&&(!(g=t.match(/Edge\/(\d+)/))||74<=g[1])&&(g=t.match(/Chrome\/(\d+)/))?+g[1]:v,Ht=!!Object.getOwnPropertySymbols&&!c(function(){var t=Symbol();return!String(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&a&&a<41}),Vt=Ht&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,Dt=Object,Bt=Vt?function(t){return"symbol"==typeof t}:function(t){var e=n("Symbol");return x(e)&&_t(e.prototype,Dt(t))},$t=String,Nt=function(t){try{return $t(t)}catch(t){return"Object"}},Ft=TypeError,b=function(t){if(x(t))return t;throw Ft(Nt(t)+" is not a function")},Gt=function(t,e){t=t[e];return Pt(t)?void 0:b(t)},Ut=TypeError,zt=function(t,e){var n,o;if("string"===e&&x(n=t.toString)&&!d(o=m(n,t)))return o;if(x(n=t.valueOf)&&!d(o=m(n,t)))return o;if("string"!==e&&x(n=t.toString)&&!d(o=m(n,t)))return o;throw Ut("Can't convert object to primitive value")},Wt=Object.defineProperty,Xt=function(e,n){try{Wt(y,e,{value:n,configurable:!0,writable:!0})}catch(t){y[e]=n}return n},i="__core-js_shared__",s=y[i]||Xt(i,{}),Mt=z(function(t){(t.exports=function(t,e){return s[t]||(s[t]=void 0!==e?e:{})})("versions",[]).push({version:"3.25.5",mode:"global",copyright:"Â© 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.25.5/LICENSE",source:"https://github.com/zloirock/core-js"})}),Yt=Object,Kt=l({}.hasOwnProperty),w=Object.hasOwn||function(t,e){return Kt(J(t),e)},qt=0,Jt=Math.random(),Qt=l(1..toString),Zt=Mt("wks"),te=y.Symbol,ee=te&&te.for,ne=Vt?te:te&&te.withoutSetter||Q,oe=TypeError,re=f("toPrimitive"),ie=y.document,ae=d(ie)&&d(ie.createElement),se=function(t){return ae?ie.createElement(t):{}},ce=!p&&!c(function(){return 7!=Object.defineProperty(se("div"),"a",{get:function(){return 7}}).a}),le=Object.getOwnPropertyDescriptor,ue={f:p?le:function(t,e){if(t=q(t),e=Z(e),ce)try{return le(t,e)}catch(t){}if(w(t,e))return X(!m(xt.f,t,e),t[e])}},g=p&&c(function(){return 42!=Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype}),he=String,fe=TypeError,E=function(t){if(d(t))return t;throw fe(he(t)+" is not an object")},pe=TypeError,de=Object.defineProperty,ge=Object.getOwnPropertyDescriptor,ve="enumerable",ye="configurable",me="writable",S={f:p?g?function(t,e,n){var o;return E(t),e=Z(e),E(n),"function"==typeof t&&"prototype"===e&&"value"in n&&me in n&&!n[me]&&((o=ge(t,e))&&o[me]&&(t[e]=n.value,n={configurable:(ye in n?n:o)[ye],enumerable:(ve in n?n:o)[ve],writable:!1})),de(t,e,n)}:de:function(t,e,n){if(E(t),e=Z(e),E(n),ce)try{return de(t,e,n)}catch(t){}if("get"in n||"set"in n)throw pe("Accessors not supported");return"value"in n&&(t[e]=n.value),t}},be=p?function(t,e,n){return S.f(t,e,X(1,n))}:function(t,e,n){return t[e]=n,t},v=Function.prototype,i=p&&Object.getOwnPropertyDescriptor,T=w(v,"name"),we={EXISTS:T,PROPER:T&&"something"===function(){}.name,CONFIGURABLE:T&&(!p||i(v,"name").configurable)},Se=l(Function.toString),xe=(x(s.inspectSource)||(s.inspectSource=function(t){return Se(t)}),s.inspectSource),T=y.WeakMap,i=x(T)&&/native code/.test(String(T)),Ee=Mt("keys"),Te={},Ce="Object already initialized",Ae=y.TypeError,v=y.WeakMap,Oe=i||s.state?((r=s.state||(s.state=new v)).get=r.get,r.has=r.has,r.set=r.set,vt=function(t,e){if(r.has(t))throw Ae(Ce);return e.facade=t,r.set(t,e),e},yt=function(t){return r.get(t)||{}},function(t){return r.has(t)}):(mt=tt("state"),Te[mt]=!0,vt=function(t,e){if(w(t,mt))throw Ae(Ce);return e.facade=t,be(t,mt,e),e},yt=function(t){return w(t,mt)?t[mt]:{}},function(t){return w(t,mt)}),ke={set:vt,get:yt,has:Oe,enforce:function(t){return Oe(t)?yt(t):vt(t,{})},getterFor:function(e){return function(t){if(d(t)&&(t=yt(t)).type===e)return t;throw Ae("Incompatible receiver, "+e+" required")}}},je=z(function(t){var o=we.CONFIGURABLE,r=ke.enforce,e=ke.get,i=Object.defineProperty,a=p&&!c(function(){return 8!==i(function(){},"length",{value:8}).length}),s=String(String).split("String"),t=t.exports=function(t,e,n){"Symbol("===String(e).slice(0,7)&&(e="["+String(e).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),n&&n.getter&&(e="get "+e),n&&n.setter&&(e="set "+e),(!w(t,"name")||o&&t.name!==e)&&(p?i(t,"name",{value:e,configurable:!0}):t.name=e),a&&n&&w(n,"arity")&&t.length!==n.arity&&i(t,"length",{value:n.arity});try{n&&w(n,"constructor")&&n.constructor?p&&i(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch(t){}n=r(t);return w(n,"source")||(n.source=s.join("string"==typeof e?e:"")),t};Function.prototype.toString=t(function(){return x(this)&&e(this).source||xe(this)},"toString")}),Pe=Math.ceil,Ie=Math.floor,Re=Math.trunc||function(t){t=+t;return(0<t?Ie:Pe)(t)},Le=function(t){t=+t;return t!=t||0==t?0:Re(t)},_e=Math.max,Me=Math.min,He=Math.min,Ve=function(t){return 0<t?He(Le(t),9007199254740991):0},De={includes:rt(!0),indexOf:rt(!1)}.indexOf,Be=l([].push),$e=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],Ne=$e.concat("length","prototype"),Fe={f:Object.getOwnPropertyNames||function(t){return it(t,Ne)}},Ge={f:Object.getOwnPropertySymbols},Ue=l([].concat),ze=n("Reflect","ownKeys")||function(t){var e=Fe.f(E(t)),n=Ge.f;return n?Ue(e,n(t)):e},We=/#|\.prototype\./,Xe=at.normalize=function(t){return String(t).replace(We,".").toLowerCase()},Ye=at.data={},Ke=at.NATIVE="N",qe=at.POLYFILL="P",Je=at,Qe=ue.f,Ze=Array.isArray||function(t){return"Array"==o(t)},T={},i=(T[f("toStringTag")]="z","[object z]"===String(T)),tn=f("toStringTag"),en=Object,nn="Arguments"==o(function(){return arguments}()),on=i?o:function(t){var e;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(e=function(t,e){try{return t[e]}catch(t){}}(t=en(t),tn))?e:nn?o(t):"Object"==(e=o(t))&&x(t.callee)?"Arguments":e},rn=[],an=n("Reflect","construct"),sn=/^\s*(?:class|function)\b/,cn=l(sn.exec),ln=!sn.exec(st),un=(lt.sham=!0,!an||c(function(){var t;return ct(ct.call)||!ct(Object)||!ct(function(){t=!0})||t})?lt:ct),hn=f("species"),fn=l([].slice),v=ht("slice"),pn=f("species"),dn=Array,gn=Math.max,vn=(e({target:"Array",proto:!0,forced:!v},{slice:function(t,e){var n,o,r,i=q(this),a=ot(i),s=nt(t,a),c=nt(void 0===e?a:e,a);if(Ze(i)&&(n=i.constructor,(n=un(n)&&(n===dn||Ze(n.prototype))||d(n)&&null===(n=n[pn])?void 0:n)===dn||void 0===n))return fn(i,s,c);for(o=new(void 0===n?dn:n)(gn(c-s,0)),r=0;s<c;s++,r++)s in i&&ut(o,r,i[s]);return o.length=r,o}}),TypeError),yn=f("species"),mn=Array,bn=f("isConcatSpreadable"),T=51<=a||!c(function(){var t=[];return t[bn]=!1,t.concat()[0]!==t}),v=ht("concat"),wn=(e({target:"Array",proto:!0,arity:1,forced:!T||!v},{concat:function(t){for(var e,n,o,r,i,a=J(this),s=pt(a,0),c=0,l=-1,u=arguments.length;l<u;l++)if(i=void 0,!d(r=o=-1===l?a:arguments[l])||(void 0!==(i=r[bn])?!i:!Ze(r)))ft(c+1),ut(s,c++,o);else for(n=ot(o),ft(c+n),e=0;e<n;e++,c++)e in o&&ut(s,c,o[e]);return s.length=c,s}}),TypeError),T={left:dt(!1),right:dt(!0)},C="process"==o(y.process),Sn=T.left;e({target:"Array",proto:!0,forced:!gt("reduce")||!C&&79<a&&a<83},{reduce:function(t){var e=arguments.length;return Sn(this,t,e,1<e?arguments[1]:void 0)}});function xn(t,e){return b(t),void 0===e?t:bt?Cn(t,e):function(){return t.apply(e,arguments)}}function A(f){var p=1==f,d=2==f,g=3==f,v=4==f,y=6==f,m=7==f,b=5==f||y;return function(t,e,n,o){for(var r,i,a=J(t),s=jt(a),c=xn(e,n),l=ot(s),u=0,e=o||pt,h=p?e(t,l):d||m?e(t,0):void 0;u<l;u++)if((b||u in s)&&(i=c(r=s[u],u,a),f))if(p)h[u]=i;else if(i)switch(f){case 3:return!0;case 5:return r;case 6:return u;case 2:An(h,r)}else switch(f){case 4:return!1;case 7:An(h,r)}return y?-1:g||v?v:h}}function En(e){if(e&&e.forEach!==jn)try{be(e,"forEach",jn)}catch(t){e.forEach=jn}}i||et(Object.prototype,"toString",i?{}.toString:function(){return"[object "+on(this)+"]"},{unsafe:!0});var Tn,Cn=l(l.bind),An=l([].push),v={forEach:A(0),map:A(1),filter:A(2),some:A(3),every:A(4),find:A(5),findIndex:A(6),filterReject:A(7)},On=v.map,kn=(e({target:"Array",proto:!0,forced:!ht("map")},{map:function(t){return On(this,t,1<arguments.length?arguments[1]:void 0)}}),v.forEach),jn=gt("forEach")?[].forEach:function(t){return kn(this,t,1<arguments.length?arguments[1]:void 0)},Pn=(e({target:"Array",proto:!0,forced:[].forEach!=jn},{forEach:jn}),{CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}),T=se("span").classList,i=T&&T.constructor&&T.constructor.prototype,T=i===Object.prototype?void 0:i;for(Tn in Pn)Pn[Tn]&&En(y[Tn]&&y[Tn].prototype);En(T);function In(){}function Rn(t){t.write(Un("")),t.close();var e=t.parentWindow.Object;return t=null,e}function Ln(t){Yn[Xn][t]=!0}function _n(t,e){var n,t=E(t).constructor;if(void 0===t||Pt(n=E(t)[no]))return e;if(un(t=n))return t;throw eo(Nt(t)+" is not a constructor")}var Mn,Hn,Vn,Dn=Object.keys||function(t){return it(t,$e)},Bn={f:p&&!g?Object.defineProperties:function(t,e){E(t);for(var n,o=q(e),r=Dn(e),i=r.length,a=0;a<i;)S.f(t,n=r[a++],o[n]);return t}},$n=n("document","documentElement"),Nn="prototype",Fn="script",Gn=tt("IE_PROTO"),Un=function(t){return"<"+Fn+">"+t+"</"+Fn+">"},zn=function(){try{Mn=new ActiveXObject("htmlfile")}catch(t){}zn="undefined"==typeof document||document.domain&&Mn?Rn(Mn):(t=se("iframe"),e="java"+Fn+":",t.style.display="none",$n.appendChild(t),t.src=String(e),(e=t.contentWindow.document).open(),e.write(Un("document.F=Object")),e.close(),e.F);for(var t,e,n=$e.length;n--;)delete zn[Nn][$e[n]];return zn()},Wn=(Te[Gn]=!0,Object.create||function(t,e){var n;return null!==t?(In[Nn]=E(t),n=new In,In[Nn]=null,n[Gn]=t):n=zn(),void 0===e?n:Bn.f(n,e)}),i=S.f,Xn=f("unscopables"),Yn=Array.prototype,Kn=(null==Yn[Xn]&&i(Yn,Xn,{configurable:!0,value:Wn(null)}),v.find),T="find",qn=!0,Jn=(T in[]&&Array(1)[T](function(){qn=!1}),e({target:"Array",proto:!0,forced:qn},{find:function(t){return Kn(this,t,1<arguments.length?arguments[1]:void 0)}}),Ln(T),String),Qn=TypeError,g=Object.setPrototypeOf||("__proto__"in{}?function(){var n,o=!1,t={};try{(n=l(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))(t,[]),o=t instanceof Array}catch(t){}return function(t,e){return E(t),function(t){if("object"==typeof t||x(t))return;throw Qn("Can't set "+Jn(t)+" as a prototype")}(e),o?n(t,e):t.__proto__=e,t}}():void 0),i=S.f,T=f("toStringTag"),Zn=f("species"),to=TypeError,eo=TypeError,no=f("species"),O=Function.prototype,oo=O.apply,ro=O.call,io="object"==typeof Reflect&&Reflect.apply||(bt?ro.bind(oo):function(){return ro.apply(oo,arguments)}),ao=TypeError,O=/(?:ipad|iphone|ipod).*applewebkit/i.test(t),k=y.setImmediate,j=y.clearImmediate,so=y.process,co=y.Dispatch,lo=y.Function,P=y.MessageChannel,uo=y.String,ho=0,fo={},po="onreadystatechange";try{Hn=y.location}catch(t){}function go(t){return function(){Io(t)}}function vo(t){Io(t.data)}function yo(t){y.postMessage(uo(t),Hn.protocol+"//"+Hn.host)}function mo(){this.head=null,this.tail=null}function bo(t){var n,o;this.promise=new t(function(t,e){if(void 0!==n||void 0!==o)throw Go("Bad Promise constructor");n=t,o=e}),this.resolve=b(n),this.reject=b(o)}function wo(t,e){var n,o,r,i,a=e.value,s=e.state==ar,c=s?t.ok:t.fail,l=t.resolve,u=t.reject,h=t.domain;try{c?(s||(e.rejection===lr&&(i=e,m(zo,y,function(){var t=i.facade;C?tr.emit("rejectionHandled",t):fr(ir,t,i.value)})),e.rejection=cr),!0===c?n=a:(h&&h.enter(),n=c(a),h&&(h.exit(),r=!0)),n===t.promise?u(Qo("Promise-chain cycle")):(o=ur(n))?m(o,n,l,u):l(n)):u(a)}catch(t){h&&!r&&h.exit(),u(t)}}var So,xo,Eo,To,Co,Ao,Oo,ko,jo,Po,Io=function(t){var e;w(fo,t)&&(e=fo[t],delete fo[t],e())},P=(k&&j||(k=function(t){var e=arguments.length,n=1;if(e<n)throw ao("Not enough arguments");var o=x(t)?t:lo(t),r=fn(arguments,1);return fo[++ho]=function(){io(o,void 0,r)},Vn(ho),ho},j=function(t){delete fo[t]},C?Vn=function(t){so.nextTick(go(t))}:co&&co.now?Vn=function(t){co.now(go(t))}:P&&!O?(I=(P=new P).port2,P.port1.onmessage=vo,Vn=xn(I.postMessage,I)):y.addEventListener&&x(y.postMessage)&&!y.importScripts&&Hn&&"file:"!==Hn.protocol&&!c(yo)?(Vn=yo,y.addEventListener("message",vo,!1)):Vn=po in se("script")?function(t){$n.appendChild(se("script"))[po]=function(){$n.removeChild(this),Io(t)}}:function(t){setTimeout(go(t),0)}),{set:k,clear:j}),I=/ipad|iphone|ipod/i.test(t)&&void 0!==y.Pebble,k=/web0s(?!.*chrome)/i.test(t),j=ue.f,Ro=P.set,t=y.MutationObserver||y.WebKitMutationObserver,Lo=y.document,_o=y.process,R=y.Promise,j=j(y,"queueMicrotask"),j=j&&j.value,Mo=(j||(So=function(){var t,e;for(C&&(t=_o.domain)&&t.exit();xo;){e=xo.fn,xo=xo.next;try{e()}catch(t){throw xo?To():Eo=void 0,t}}Eo=void 0,t&&t.enter()},To=O||C||k||!t||!Lo?!I&&R&&R.resolve?((O=R.resolve(void 0)).constructor=R,Oo=xn(O.then,O),function(){Oo(So)}):C?function(){_o.nextTick(So)}:(Ro=xn(Ro,y),function(){Ro(So)}):(Co=!0,Ao=Lo.createTextNode(""),new t(So).observe(Ao,{characterData:!0}),function(){Ao.data=Co=!Co})),j||function(t){t={fn:t,next:void 0};Eo&&(Eo.next=t),xo||(xo=t,To()),Eo=t}),Ho=function(t){try{return{error:!1,value:t()}}catch(t){return{error:!0,value:t}}},Vo=(mo.prototype={add:function(t){t={item:t,next:null};this.head?this.tail.next=t:this.head=t,this.tail=t},get:function(){var t=this.head;if(t)return this.head=t.next,this.tail===t&&(this.tail=null),t.item}},mo),L=y.Promise,Do="object"==typeof Deno&&Deno&&"object"==typeof Deno.version,Bo=!Do&&!C&&"object"==typeof window&&"object"==typeof document,$o=(L&&L.prototype,f("species")),No=!1,Fo=x(y.PromiseRejectionEvent),k={CONSTRUCTOR:Je("Promise",function(){var t=xe(L),e=t!==String(L);if(!e&&66===a)return!0;if(!a||a<51||!/native code/.test(t)){var t=new L(function(t){t(1)}),n=function(t){t(function(){},function(){})};if((t.constructor={})[$o]=n,!(No=t.then(function(){})instanceof n))return!0}return!e&&(Bo||Do)&&!Fo}),REJECTION_EVENT:Fo,SUBCLASSING:No},Go=TypeError,Uo={f:function(t){return new bo(t)}},zo=P.set,Wo="Promise",I=k.CONSTRUCTOR,Xo=k.REJECTION_EVENT,R=k.SUBCLASSING,Yo=ke.getterFor(Wo),Ko=ke.set,O=L&&L.prototype,qo=L,Jo=O,Qo=y.TypeError,Zo=y.document,tr=y.process,er=Uo.f,nr=er,or=!!(Zo&&Zo.createEvent&&y.dispatchEvent),rr="unhandledrejection",ir="rejectionhandled",ar=1,sr=2,cr=1,lr=2,ur=function(t){var e;return!(!d(t)||!x(e=t.then))&&e},hr=function(n,r){n.notified||(n.notified=!0,Mo(function(){for(var t,o,e=n.reactions;t=e.get();)wo(t,n);n.notified=!1,r&&!n.rejection&&(o=n,m(zo,y,function(){var t=o.facade,e=o.value,n=pr(o);if(n&&(n=Ho(function(){C?tr.emit("unhandledRejection",e,t):fr(rr,t,e)}),o.rejection=C||pr(o)?lr:cr,n.error))throw n.value}))}))},fr=function(t,e,n){var o;or?((o=Zo.createEvent("Event")).promise=e,o.reason=n,o.initEvent(t,!1,!0),y.dispatchEvent(o)):o={promise:e,reason:n},!Xo&&(e=y["on"+t])?e(o):t===rr&&function(t,e){var n=y.console;n&&n.error&&(1==arguments.length?n.error(t):n.error(t,e))}("Unhandled promise rejection",n)},pr=function(t){return t.rejection!==cr&&!t.parent},dr=function(e,n,o){return function(t){e(n,t,o)}},gr=function(t,e,n){t.done||(t.done=!0,(t=n?n:t).value=e,t.state=sr,hr(t,!0))},vr=function(n,t,e){if(!n.done){n.done=!0,e&&(n=e);try{if(n.facade===t)throw Qo("Promise can't be resolved itself");var o=ur(t);o?Mo(function(){var e={done:!1};try{m(o,t,dr(vr,e,n),dr(gr,e,n))}catch(t){gr(e,t,n)}}):(n.value=t,n.state=ar,hr(n,!1))}catch(t){gr({done:!1},t,n)}}};if(I&&(Jo=(qo=function(t){!function(t,e){if(_t(e,t))return;throw to("Incorrect invocation")}(this,Jo),b(t),m(ko,this);var e=Yo(this);try{t(dr(vr,e),dr(gr,e))}catch(t){gr(e,t)}}).prototype,(ko=function(t){Ko(this,{type:Wo,done:!1,notified:!1,parent:!1,reactions:new Vo,rejection:!1,state:0,value:void 0})}).prototype=et(Jo,"then",function(t,e){var n=Yo(this),o=er(_n(this,qo));return n.parent=!0,o.ok=!x(t)||t,o.fail=x(e)&&e,o.domain=C?tr.domain:void 0,0==n.state?n.reactions.add(o):Mo(function(){wo(o,n)}),o.promise}),jo=function(){var t=new ko,e=Yo(t);this.promise=t,this.resolve=dr(vr,e),this.reject=dr(gr,e)},Uo.f=er=function(t){return t===qo||void 0===t?new jo:nr(t)},x(L)&&O!==Object.prototype)){Po=O.then,R||et(O,"then",function(t,e){var n=this;return new qo(function(t,e){m(Po,n,t,e)}).then(t,e)},{unsafe:!0});try{delete O.constructor}catch(t){}g&&g(O,Jo)}e({global:!0,constructor:!0,wrap:!0,forced:I},{Promise:qo}),t=!(Lo=Wo),(j=(j=qo)&&!t?j.prototype:j)&&!w(j,T)&&i(j,T,{configurable:!0,value:Lo}),P=n(P=Wo),R=S.f,p&&P&&!P[Zn]&&R(P,Zn,{configurable:!0,get:function(){return this}});function yr(t,e,n){var o,r;E(t);try{if(!(o=Gt(t,"return"))){if("throw"===e)throw n;return}o=m(o,t)}catch(t){r=!0,o=t}if("throw"===e)throw n;if(r)throw o;E(o)}function mr(t,e){this.stopped=t,this.result=e}function br(t,e,n){function o(t){return i&&yr(i,"normal",t),new mr(!0,t)}function r(t){return f?(E(t),g?v(t[0],t[1],o):v(t[0],t[1])):g?v(t,o):v(t)}var i,a,s,c,l,u,h=n&&n.that,f=!(!n||!n.AS_ENTRIES),p=!(!n||!n.IS_RECORD),d=!(!n||!n.IS_ITERATOR),g=!(!n||!n.INTERRUPTED),v=xn(e,h);if(p)i=t.iterator;else if(d)i=t;else{if(!(n=Tr(t)))throw Ar(Nt(t)+" is not iterable");if(void 0!==(e=n)&&(wr.Array===e||xr[Sr]===e)){for(a=0,s=ot(t);a<s;a++)if((c=r(t[a]))&&_t(Or,c))return;return}i=function(t,e){e=arguments.length<2?Tr(t):e;if(b(e))return E(m(e,t));throw Cr(Nt(t)+" is not iterable")}(t,n)}for(l=(p?t:i).next;!(u=m(l,i)).done;){try{c=r(u.value)}catch(t){yr(i,"throw",t)}if("object"==typeof c&&c&&_t(Or,c))return}}var wr={},Sr=f("iterator"),xr=Array.prototype,Er=f("iterator"),Tr=function(t){if(!Pt(t))return Gt(t,Er)||Gt(t,"@@iterator")||wr[on(t)]},Cr=TypeError,Ar=TypeError,Or=mr.prototype,kr=f("iterator"),jr=!1;try{var Pr=0,Ir={next:function(){return{done:!!Pr++}},return:function(){jr=!0}};Ir[kr]=function(){return this},Array.from(Ir,function(){throw 2})}catch(t){}g=k.CONSTRUCTOR||!function(t,e){if(!e&&!jr)return!1;var n=!1;try{var o={};o[kr]=function(){return{next:function(){return{done:n=!0}}}},t(o)}catch(t){}return n}(function(t){L.all(t).then(void 0,function(){})}),e({target:"Promise",stat:!0,forced:g},{all:function(t){var s=this,e=Uo.f(s),c=e.resolve,l=e.reject,n=Ho(function(){var o=b(s.resolve),r=[],i=0,a=1;br(t,function(t){var e=i++,n=!1;a++,m(o,s,t).then(function(t){n||(n=!0,r[e]=t,--a||c(r))},l)}),--a||c(r)});return n.error&&l(n.value),e.promise}}),O=k.CONSTRUCTOR,I=L&&L.prototype;e({target:"Promise",proto:!0,forced:O,real:!0},{catch:function(t){return this.then(void 0,t)}}),x(L)&&(t=n("Promise").prototype.catch,I.catch!==t&&et(I,"catch",t,{unsafe:!0})),e({target:"Promise",stat:!0,forced:g},{race:function(t){var n=this,o=Uo.f(n),r=o.reject,e=Ho(function(){var e=b(n.resolve);br(t,function(t){m(e,n,t).then(o.resolve,r)})});return e.error&&r(e.value),o.promise}});e({target:"Promise",stat:!0,forced:k.CONSTRUCTOR},{reject:function(t){var e=Uo.f(this);return m(e.reject,void 0,t),e.promise}});function _(t){if("Symbol"===on(t))throw TypeError("Cannot convert a Symbol value to a string");return Wr(t)}function Rr(){var t=E(this),e="";return t.hasIndices&&(e+="d"),t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.dotAll&&(e+="s"),t.unicode&&(e+="u"),t.unicodeSets&&(e+="v"),t.sticky&&(e+="y"),e}function Lr(n,t,e,o){var a,r=f(n),s=!c(function(){var t={};return t[r]=function(){return 7},7!=""[n](t)}),i=s&&!c(function(){var t=!1,e=/a/;return"split"===n&&((e={constructor:{}}).constructor[ci]=function(){return e},e.flags="",e[r]=/./[r]),e.exec=function(){return t=!0,null},e[r](""),!t});s&&i&&!e||(a=l(/./[r]),i=t(r,""[n],function(t,e,n,o,r){var t=l(t),i=e.exec;return i===si||i===li.exec?s&&!r?{done:!0,value:a(e,n,o)}:{done:!0,value:t(n,e,o)}:{done:!1}}),et(String.prototype,n,i[0]),et(li,r,i[1])),o&&be(li[r],"sham",!0)}function _r(r){return function(t,e){var n,t=_(K(t)),e=Le(e),o=t.length;return e<0||o<=e?r?"":void 0:(n=hi(t,e))<55296||56319<n||e+1===o||(o=hi(t,e+1))<56320||57343<o?r?ui(t,e):n:r?fi(t,e,e+2):o-56320+(n-55296<<10)+65536}}function Mr(t,e,n){return e+(n?pi(t,e).length:1)}function Hr(t,e){var n=t.exec;if(x(n))return null!==(n=m(n,t,e))&&E(n),n;if("RegExp"===o(t))return m(si,t,e);throw wi("RegExp#exec called on incompatible receiver")}function Vr(t,e){if(!delete t[e])throw Ri("Cannot delete property "+Nt(e)+" of "+Nt(t))}function Dr(){this.options={handles:[{name:"remove",position:"nw",events:{pointerdown:"removeElement"},icon:null},{name:"direction",position:"se",events:{pointerdown:"directionSwap"},icon:null}],bbox:function(t){return t.paper.localToPaperPoint(t.getPointAtRatio(.5))},typeCssName:"type-link",tinyThreshold:-1,smallThreshold:-1,boxContent:!1}}function M(){this.options={handles:[{name:"remove",position:"nw",events:{pointerdown:"removeElement"},icon:null},{name:"resize",position:"se",events:{pointerdown:"startResizing",pointermove:"doResize",pointerup:"stopBatch"},icon:null},{name:"clone",position:"n",events:{pointerdown:"startCloning",pointermove:"doClone",pointerup:"stopCloning"},icon:null},{name:"link",position:"e",events:{pointerdown:"startLinking",pointermove:"doLink",pointerup:"stopLinking"},icon:null},{name:"fork",position:"ne",events:{pointerdown:"startForking",pointermove:"doFork",pointerup:"stopForking"},icon:null},{name:"unlink",position:"w",events:{pointerdown:"unlinkElement"},icon:null},{name:"rotate",position:"sw",events:{pointerdown:"startRotating",pointermove:"doRotate",pointerup:"stopBatch"},icon:null}],bbox:function(t,e){return t.getBBox({useModelGeometry:e.options.useModelGeometry})},typeCssName:"type-element",tinyThreshold:40,smallThreshold:80,boxContent:function(t,e){var n=h.util.template("x: <%= x %>, y: <%= y %>, width: <%= width %>, height: <%= height %>, angle: <%= angle %>"),t=t.model,o=t.getBBox();return n({x:Math.floor(o.x),y:Math.floor(o.y),width:Math.floor(o.width),height:Math.floor(o.height),angle:Math.floor(t.get("angle")||0)})},magnet:function(t){return t.el},loopLinkPreferredSide:"top",loopLinkWidth:40,rotateAngleGrid:15,rotateEmbeds:!1,linkAttributes:{},smoothLinks:void 0}}var i=k.CONSTRUCTOR,j=(n("Promise"),e({target:"Promise",stat:!0,forced:i},{resolve:function(t){return t=t,E(e=this),d(t)&&t.constructor===e?t:((0,(e=Uo.f(e)).resolve)(t),e.promise);var e}}),we.EXISTS),T=S.f,Lo=Function.prototype,Br=l(Lo.toString),$r=/function\b(?:\s|\/\*[\S\s]*?\*\/|\/\/[^\n\r]*[\n\r]+)*([^\s(/]*)/,Nr=l($r.exec),Fr=(p&&!j&&T(Lo,"name",{configurable:!0,get:function(){try{return Nr($r,Br(this))[1]}catch(t){return""}}}),Function),Gr=l([].concat),Ur=l([].join),zr={},R=bt?Fr.bind:function(a){var s=b(this),t=s.prototype,c=fn(arguments,1),l=function(){var t=Gr(c,fn(arguments));if(this instanceof l){var e=s,n=t.length,o=t;if(!w(zr,n)){for(var r=[],i=0;i<n;i++)r[i]="a["+i+"]";zr[n]=Fr("C,a","return new C("+Ur(r,",")+")")}return zr[n](e,o)}return s.apply(a,t)};return d(t)&&(l.prototype=t),l},Wr=(e({target:"Function",proto:!0,forced:Function.bind!==R},{bind:R}),String),Xr=y.RegExp,P=c(function(){var t=Xr("a","y");return t.lastIndex=2,null!=t.exec("abcd")}),Zn=P||c(function(){return!Xr("a","y").sticky}),Ir={BROKEN_CARET:P||c(function(){var t=Xr("^r","gy");return t.lastIndex=2,null!=t.exec("str")}),MISSED_STICKY:Zn,UNSUPPORTED_Y:P},Yr=y.RegExp,O=c(function(){var t=Yr(".","s");return!t.dotAll||!t.exec("\n")||"s"!==t.flags}),Kr=y.RegExp,I=c(function(){var t=Kr("(?<a>b)","g");return"b"!==t.exec("b").groups.a||"bc"!=="b".replace(t,"$<a>c")}),qr=ke.get,Jr=Mt("native-string-replace",String.prototype.replace),Qr=RegExp.prototype.exec,Zr=Qr,ti=l("".charAt),ei=l("".indexOf),ni=l("".replace),oi=l("".slice),ri=(t=/b*/g,m(Qr,g=/a/,"a"),m(Qr,t,"a"),0!==g.lastIndex||0!==t.lastIndex),ii=Ir.BROKEN_CARET,ai=void 0!==/()??/.exec("")[1],si=Zr=ri||ai||ii||O||I?function(t){var e,n,o,r,i,a,s=this,c=qr(s),t=_(t),l=c.raw;if(l)return l.lastIndex=s.lastIndex,h=m(Zr,l,t),s.lastIndex=l.lastIndex,h;var u=c.groups,l=ii&&s.sticky,h=m(Rr,s),c=s.source,f=0,p=t;if(l&&(h=ni(h,"y",""),-1===ei(h,"g")&&(h+="g"),p=oi(t,s.lastIndex),0<s.lastIndex&&(!s.multiline||s.multiline&&"\n"!==ti(t,s.lastIndex-1))&&(c="(?: "+c+")",p=" "+p,f++),e=new RegExp("^(?:"+c+")",h)),ai&&(e=new RegExp("^"+c+"$(?!\\s)",h)),ri&&(n=s.lastIndex),o=m(Qr,l?e:s,p),l?o?(o.input=oi(o.input,f),o[0]=oi(o[0],f),o.index=s.lastIndex,s.lastIndex+=o[0].length):s.lastIndex=0:ri&&o&&(s.lastIndex=s.global?o.index+o[0].length:n),ai&&o&&1<o.length&&m(Jr,o[0],e,function(){for(r=1;r<arguments.length-2;r++)void 0===arguments[r]&&(o[r]=void 0)}),o&&u)for(o.groups=i=Wn(null),r=0;r<u.length;r++)i[(a=u[r])[0]]=o[a[1]];return o}:Zr,ci=(e({target:"RegExp",proto:!0,forced:/./.exec!==si},{exec:si}),f("species")),li=RegExp.prototype,ui=l("".charAt),hi=l("".charCodeAt),fi=l("".slice),pi={codeAt:_r(!1),charAt:_r(!0)}.charAt,di=Math.floor,gi=l("".charAt),vi=l("".replace),yi=l("".slice),mi=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,bi=/\$([$&'`]|\d{1,2})/g,wi=TypeError,Si=f("replace"),xi=Math.max,Ei=Math.min,Ti=l([].concat),Ci=l([].push),Ai=l("".indexOf),Oi=l("".slice),k="$0"==="a".replace(/./,"$0"),ki=!!/./[Si]&&""===/./[Si]("a","$0"),ji=(Lr("replace",function(t,b,w){var S=ki?"$":"$0";return[function(t,e){var n=K(this),o=Pt(t)?void 0:Gt(t,Si);return o?m(o,t,n,e):m(b,_(n),t,e)},function(t,e){var n=E(this),o=_(t);if("string"==typeof e&&-1===Ai(e,S)&&-1===Ai(e,"$<")){t=w(b,n,o,e);if(t.done)return t.value}for(var r,i=x(e),a=(i||(e=_(e)),n.global),s=(a&&(r=n.unicode,n.lastIndex=0),[]);null!==(f=Hr(n,o))&&(Ci(s,f),a);)""===_(f[0])&&(n.lastIndex=Mr(o,Ve(n.lastIndex),r));for(var c,l="",u=0,h=0;h<s.length;h++){for(var f,p=_((f=s[h])[0]),d=xi(Ei(Le(f.index),o.length),0),g=[],v=1;v<f.length;v++)Ci(g,void 0===(c=f[v])?c:String(c));var y=f.groups,m=i?(m=Ti([p],g,d,o),void 0!==y&&Ci(m,y),_(io(e,void 0,m))):function(i,a,s,c,l,t){var u=s+i.length,h=c.length,e=bi;return void 0!==l&&(l=J(l),e=mi),vi(t,e,function(t,e){var n;switch(gi(e,0)){case"$":return"$";case"&":return i;case"`":return yi(a,0,s);case"'":return yi(a,u);case"<":n=l[yi(e,1,-1)];break;default:var o,r=+e;if(0==r)return t;if(h<r)return 0!==(o=di(r/10))&&o<=h?void 0===c[o-1]?gi(e,1):c[o-1]+gi(e,1):t;n=c[r-1]}return void 0===n?"":n})}(p,o,d,g,y,e);u<=d&&(l+=Oi(o,u,d)+m,u=d+p.length)}return l+Oi(o,u)}]},!!c(function(){var t=/./;return t.exec=function(){var t=[];return t.groups={a:"7"},t},"7"!=="".replace(t,"$<a>")})||!k||ki),Lr("match",function(o,s,c){return[function(t){var e=K(this),n=Pt(t)?void 0:Gt(t,o);return n?m(n,t,e):new RegExp(t)[o](_(e))},function(t){var e=E(this),n=_(t),t=c(s,e,n);if(t.done)return t.value;if(!e.global)return Hr(e,n);for(var o=e.unicode,r=[],i=e.lastIndex=0;null!==(a=Hr(e,n));){var a=_(a[0]);""===(r[i]=a)&&(e.lastIndex=Mr(n,Ve(e.lastIndex),o)),i++}return 0===i?null:r}]}),TypeError),Pi=Object.getOwnPropertyDescriptor,Ii=p&&!function(){if(void 0!==this)return 1;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(t){return t instanceof TypeError}}()?function(t,e){if(Ze(t)&&!Pi(t,"length").writable)throw ji("Cannot set read only .length");return t.length=e}:function(t,e){return t.length=e},Ri=TypeError,i=ht("splice"),Li=Math.max,_i=Math.min,Mi=(e({target:"Array",proto:!0,forced:!i},{splice:function(t,e){var n,o,r,i,a,s,c=J(this),l=ot(c),u=nt(t,l),t=arguments.length;for(0===t?n=o=0:o=1===t?(n=0,l-u):(n=t-2,_i(Li(Le(e),0),l-u)),ft(l+n-o),r=pt(c,o),i=0;i<o;i++)(a=u+i)in c&&ut(r,i,c[a]);if(n<(r.length=o)){for(i=u;i<l-o;i++)s=i+n,(a=i+o)in c?c[s]=c[a]:Vr(c,s);for(i=l;l-o+n<i;i--)Vr(c,i-1)}else if(o<n)for(i=l-o;u<i;i--)s=i+n-1,(a=i+o-1)in c?c[s]=c[a]:Vr(c,s);for(i=0;i<n;i++)c[i+u]=arguments[i+2];return Ii(c,l-o+n),r}}),v.findIndex),j="findIndex",Hi=!0,Vi=(j in[]&&Array(1)[j](function(){Hi=!1}),e({target:"Array",proto:!0,forced:Hi},{findIndex:function(t){return Mi(this,t,1<arguments.length?arguments[1]:void 0)}}),Ln(j),e({target:"Array",stat:!0},{isArray:Ze}),v.every),T=(e({target:"Array",proto:!0,forced:!gt("every")},{every:function(t){return Vi(this,t,1<arguments.length?arguments[1]:void 0)}}),Dr.prototype.directionSwap=function(){var t=this.options.cellView.model;t.set({source:t.get("target"),target:t.get("source")},{halo:this.cid})},M.prototype.startLinking=function(t,e,n){this.startBatch();var o=this.options,r=o.paper,o=o.graph,t=this.createLinkConnectedToSource(t);t.set({target:{x:e,y:n}}).addTo(o,{validation:!1,halo:this.cid,async:!1}),r.undelegateEvents(),(this._linkView=t.findView(r)).startArrowheadMove("target",{whenNotAllowed:"remove"})},M.prototype.startForking=function(t,e,n){var o=this.options,r=o.paper,o=o.graph;this.startBatch();var i=D(this.cloneCell({fork:!0})),a=i[0],i=i.slice(1),i=[a].concat(B(h.util.sortBy(i,function(t){return t.isLink()}))),i=(o.addCells(i,{halo:this.cid,async:!1}),this.centerElementAtCursor(a,e,n),this.createLinkConnectedToSource(t)),a=a.findView(r),r=this.getElementMagnet(a,"target",t),r=this.getLinkEnd(a,r,t);i.set("target",r).addTo(o,{halo:this.cid,async:!1}),a.pointerdown(t,e,n),this.eventData(t,{cloneView:a})},M.prototype.getElementMagnet=function(t,e,n){var o=this.options.magnet;if(h.util.isFunction(o)){o=o.call(this,t,e,n);if(o instanceof SVGElement)return o}throw new Error("ui.Halo: magnet() has to return an SVGElement.")},M.prototype.getLinkEnd=function(t,e,n){var o,r={id:t.model.id};return e!==t.el&&((o=t.findAttribute("port",e))?r.port=o:r.selector=t.getSelector(e)),r},M.prototype.createLinkConnectedToSource=function(t){var e=this.options,n=e.paper,o=e.cellView,r=this.getElementMagnet(o,"source",t),t=this.getLinkEnd(o,r,t),n=n.getDefaultLink(o,r).set("source",t);return n.attr(e.linkAttributes),h.util.isBoolean(e.smoothLinks)&&n.set("smooth",e.smoothLinks),n},M.prototype.startResizing=function(t){this.startBatch(),this._flip=[1,0,0,1,1,0,0,1][Math.floor(h.g.normalizeAngle(this.options.cellView.model.get("angle"))/45)]},M.prototype.startRotating=function(t,e,n){this.startBatch();var o=this.options.cellView.model,r=o.getBBox().center(),i=[o];this.options.rotateEmbeds&&o.getEmbeddedCells({deep:!0}).reduce(function(t,e){return e.isElement()&&t.push(e),t},i),this.eventData(t,{center:r,elements:i,rotationStartAngles:i.map(function(t){return t.angle()}),clientStartAngle:new h.g.Point(e,n).theta(r)})},M.prototype.doResize=function(t,e,n,o,r){var i=this.options.cellView.model.get("size"),a=Math.max(i.width+(this._flip?o:r),1),i=Math.max(i.height+(this._flip?r:o),1);this.options.cellView.model.resize(a,i,{absolute:!0})},M.prototype.doRotate=function(t,e,n){var o=this.eventData(t),r=o.clientStartAngle-new h.g.Point(e,n).theta(o.center);o.elements.forEach(function(t,e){e=o.rotationStartAngles[e],e=h.g.snapToGrid(e+r,this.options.rotateAngleGrid);t.rotate(e,!0,o.center,{halo:this.cid})},this)},M.prototype.doClone=function(t,e,n){var o=this.eventData(t).cloneView;o&&o.pointermove(t,e,n)},M.prototype.startCloning=function(t,e,n){var o=this.options.paper,r=o.model;this.startBatch();var i=D(this.cloneCell({clone:!0})),a=i[0],i=i.slice(1),i=[a].concat(B(h.util.sortBy(i,function(t){return t.isLink()}))),r=(r.addCells(i,{halo:this.cid,async:!1}),this.centerElementAtCursor(a,e,n),a.findView(o));r.pointerdown(t,e,n),this.eventData(t,{cloneView:r})},M.prototype.centerElementAtCursor=function(t,e,n){var o=t.getBBox().center(),e=e-o.x,n=n-o.y;t.translate(e,n,{deep:!0})},M.prototype.doFork=function(t,e,n){var o=this.eventData(t).cloneView;o&&o.pointermove(t,e,n)},M.prototype.doLink=function(t,e,n){this._linkView&&this._linkView.pointermove(t,e,n)},M.prototype.stopLinking=function(t,e,n){var o=this._linkView;o&&(o.pointerup(t,e,n),(t=o.model).hasLoop()&&this.makeLoopLink(t),this.stopBatch(),this.triggerAction("link","add",t),this._linkView=null),this.options.paper.delegateEvents()},M.prototype.stopForking=function(t,e,n){var o=this.eventData(t).cloneView;o&&o.pointerup(t,e,n),this.stopBatch()},M.prototype.stopCloning=function(t,e,n){var o=this.eventData(t).cloneView;o&&o.pointerup(t,e,n),this.stopBatch()},M.prototype.unlinkElement=function(t){this.startBatch(),this.options.graph.removeLinks(this.options.cellView.model),this.stopBatch()},h.mvc.View.extend({PIE_INNER_RADIUS:20,PIE_OUTER_RADIUS:50,className:"halo",events:{"mousedown .handle":"onHandlePointerDown","touchstart .handle":"onHandlePointerDown","mousedown .pie-toggle":"onPieTogglePointerDown","touchstart .pie-toggle":"onPieTogglePointerDown"},documentEvents:{mousemove:"pointermove",touchmove:"pointermove",mouseup:"pointerup",touchend:"pointerup"},options:{clearAll:!0,clearOnBlankPointerdown:!0,useModelGeometry:!(M.prototype.makeLoopLink=function(t){var r,i,a=this.options.loopLinkWidth,e=this.options.paper.options,s=h.g.rect({x:0,y:0,width:e.width,height:e.height}),c=this.options.paper.paperToLocalRect(this.options.cellView.getBBox());h.util.uniq([this.options.loopLinkPreferredSide,"top","bottom","left","right"]).find(function(t){var e,n=0,o=0;switch(t){case"top":e=h.g.point(c.x+c.width/2,c.y-a),n=a/2;break;case"bottom":e=h.g.point(c.x+c.width/2,c.y+c.height+a),n=a/2;break;case"left":e=h.g.point(c.x-a,c.y+c.height/2),o=a/2;break;case"right":e=h.g.point(c.x+c.width+a,c.y+c.height/2),o=a/2}return r=h.g.point(e).offset(-n,-o),i=h.g.point(e).offset(n,o),s.containsPoint(r)&&s.containsPoint(i)},this)&&t.set("vertices",[r,i])}),clone:function(t,e){return t.clone().unset("z")},type:"surrounding",pieSliceAngle:45,pieStartAngleOffset:0,pieIconSize:14,pieToggles:[{name:"default",position:"e"}]},init:function(){var t=this.options,e=t.cellView,n=e.model,o=new(n.isLink()?Dr:M),e=(h.util.assign(this,h.util.omit(o,"options")),e.paper),r=e.model;h.util.defaults(t,o.options,{paper:e,graph:r}),h.util.bindAll(this,"render","update"),t.clearAll&&this.constructor.clear(e),this.listenTo(r,"reset",this.close),this.listenTo(n,"remove",this.close),this.listenTo(e,"halo:create",this.close),t.clearOnBlankPointerdown&&this.listenTo(e,"blank:pointerdown",this.close),this.listenTo(r,"all",this.update),this.listenTo(e,"scale translate",this.update),this.handles=[],h.util.toArray(t.handles).forEach(this.addHandle,this)},render:function(){var t=this.options;switch(this.$el.empty(),this.$handles=u("<div/>").addClass("handles").appendTo(this.el),this.$box=u("<label/>").addClass("box").appendTo(this.el),this.$pieToggles={},this.$el.addClass(t.type),this.$el.addClass(this.cellTypeCssClass()),this.$el.attr("data-type",t.cellView.model.get("type")),this.$handles.append(h.util.toArray(this.handles).map(this.renderHandle,this)),t.type){case"toolbar":case"surrounding":this.hasHandle("fork")&&this.toggleFork();break;case"pie":h.util.toArray(this.options.pieToggles).forEach(function(t){var e=u("<div/>");e.addClass("pie-toggle "+(t.position||"e")),e.attr("data-name",t.name),h.util.setAttributesBySelector(e,t.attrs),e.appendTo(this.el),this.$pieToggles[t.name]=e},this);break;default:throw new Error("ui.Halo: unknown type")}return this.update(),this.$el.addClass("animate").appendTo(t.paper.el),this.setPieIcons(),this},setPieIcons:function(){"pie"===this.options.type&&this.$el.find(".handle").each(function(t,e){var n,o=u(e),r=o.attr("data-action"),r=this.getHandle(r);r&&r.icon||((r=window.getComputedStyle(e,":before").getPropertyValue("content"))&&"none"!==r&&0<(n=o.find(".slice-text-icon")).length&&h.V(n[0]).text(r.replace(/['"]/g,"")),(e=o.css("background-image"))&&(r=e.match(/url\(['"]?([^'"]+)['"]?\)/))&&(e=r[1],0<(n=o.find(".slice-img-icon")).length&&h.V(n[0]).attr("xlink:href",e)))}.bind(this))},update:function(){var t;this.isRendered()&&(this.updateBoxContent(),t=this.getBBox(),this.$el.toggleClass("tiny",t.width<this.options.tinyThreshold&&t.height<this.options.tinyThreshold),this.$el.toggleClass("small",!this.$el.hasClass("tiny")&&t.width<this.options.smallThreshold&&t.height<this.options.smallThreshold),this.$el.css({width:t.width,height:t.height,left:t.x,top:t.y}),this.hasHandle("unlink")&&this.toggleUnlink())},getBBox:function(){var t=this.options.cellView,e=this.options.bbox,t=h.util.isFunction(e)?e(t,this):e,t=h.util.defaults({},t,{x:0,y:0,width:1,height:1});return h.g.rect(t)},cellTypeCssClass:function(){return this.options.typeCssName},updateBoxContent:function(){var t=this.options.boxContent,e=this.options.cellView;h.util.isFunction(t)?(e=t.call(this,e,this.$box[0]))&&this.$box.html(e):t?this.$box.html(t):this.$box.remove()},extendHandles:function(t){h.util.forIn(t,function(t){var e=this.getHandle(t.name);e&&h.util.assign(e,t)}.bind(this))},addHandles:function(t){return h.util.toArray(t).forEach(this.addHandle,this),this},addHandle:function(n){return this.getHandle(n.name)||(this.handles.push(n),h.util.forIn(n.events,function(t,e){h.util.isString(t)?this.on("action:"+n.name+":"+e,this[t],this):this.on("action:"+n.name+":"+e,t)}.bind(this)),this.$handles&&this.renderHandle(n).appendTo(this.$handles)),this},renderHandle:function(t){var e=this.getHandleIdx(t.name),n=u("<div/>").addClass("handle").addClass(t.name).attr("data-action",t.name).prop("draggable",!1);switch(this.options.type){case"toolbar":case"surrounding":n.addClass(t.position),t.content&&n.html(t.content);break;case"pie":var o=this.PIE_OUTER_RADIUS,r=this.PIE_INNER_RADIUS,i=(o+r)/2,a=h.g.point(o,o),s=h.g.toRad(this.options.pieSliceAngle),c=e*s+h.g.toRad(this.options.pieStartAngleOffset),r=h.V.createSlicePathData(r,o,c,c+s),l=h.V("svg").addClass("slice-svg"),r=h.V("path").attr("d",r).translate(o,o).addClass("slice"),o=h.g.point.fromPolar(i,-c-s/2,a),i=this.options.pieIconSize,c=h.V("image").attr(o).addClass("slice-img-icon"),s=(o.y=o.y+i-2,h.V("text",{"font-size":i}).attr(o).addClass("slice-text-icon"));c.attr({width:i,height:i}),c.translate(-i/2,-i/2),s.translate(-i/2,-i/2),l.append([r,c,s]),n.append(l.node)}return t.icon&&this.setHandleIcon(n,t.icon),h.util.setAttributesBySelector(n,t.attrs),n},setHandleIcon:function(t,e){switch(this.options.type){case"pie":var n=t.find(".slice-img-icon");h.V(n[0]).attr("xlink:href",e);break;case"toolbar":case"surrounding":t.css("background-image","url("+e+")")}},removeHandles:function(){for(;this.handles.length;)this.removeHandle(this.handles[0].name);return this},removeHandle:function(n){var t=this.getHandleIdx(n),e=this.handles[t];return e&&(h.util.forIn(e.events,function(t,e){this.off("action:"+n+":"+e)}.bind(this)),this.$(".handle."+n).remove(),this.handles.splice(t,1)),this},changeHandle:function(t,e){var n=this.getHandle(t);return n&&(this.removeHandle(t),this.addHandle(h.util.merge({name:t},n,e))),this},hasHandle:function(t){return-1!==this.getHandleIdx(t)},getHandleIdx:function(e){return h.util.toArray(this.handles).findIndex(function(t){return t.name===e})},getHandle:function(e){return h.util.toArray(this.handles).find(function(t){return t.name===e})},toggleHandle:function(t,e){var n=this.getHandle(t);return n&&(t=this.$(".handle."+t),void 0===e&&(e=!t.hasClass("selected")),t.toggleClass("selected",e),(e=e?n.iconSelected:n.icon)&&this.setHandleIcon(t,e)),this},selectHandle:function(t){return this.toggleHandle(t,!0)},deselectHandle:function(t){return this.toggleHandle(t,!1)},deselectAllHandles:function(){return h.util.toArray(this.handles).forEach(function(t){this.deselectHandle(t.name)},this),this},onHandlePointerDown:function(t){var e,n,o=this._action=t.currentTarget.dataset.action;o&&(t.preventDefault(),t.stopPropagation(),t=h.util.normalizeEvent(t),e=(n=this.options.paper.snapToGrid({x:t.clientX,y:t.clientY})).x,n=n.y,this._localX=e,this._localY=n,"mousedown"===(this._evt=t).type&&2===t.button?this.triggerAction(o,"contextmenu",t,e,n):(this.triggerAction(o,"pointerdown",t,e,n),this.delegateDocumentEvents(null,t.data)))},onPieTogglePointerDown:function(t){t.stopPropagation();t=u(t.target).closest(".pie-toggle").attr("data-name");this.isOpen(t)||this.isOpen()&&this.toggleState(),this.toggleState(t)},triggerAction:function(t,e,n){var o=Array.prototype.slice.call(arguments,2);o.unshift("action:"+t+":"+e),this.trigger.apply(this,o)},stopBatch:function(){var t=this.options.graph;t.hasActiveBatch("halo")&&t.stopBatch("halo",{halo:this.cid})},startBatch:function(){this.options.graph.startBatch("halo",{halo:this.cid})},pointermove:function(t){var e,n,o;this._action&&(t.preventDefault(),t.stopPropagation(),t=h.util.normalizeEvent(t),n=(e=this.options.paper.snapToGrid({x:t.clientX,y:t.clientY})).x-this._localX,o=e.y-this._localY,this._localX=e.x,this._localY=e.y,this._evt=t,this.triggerAction(this._action,"pointermove",t,e.x,e.y,n,o))},pointerup:function(t){var e,n=this._action;n&&(this._action=null,this._evt=null,e=this.options.paper.snapToGrid({x:t.clientX,y:t.clientY}),this.triggerAction(n,"pointerup",t,e.x,e.y),this.undelegateDocumentEvents())},onRemove:function(){this._action&&this._evt&&this.pointerup(this._evt),this.stopBatch()},close:function(){return this.closed||(this.closed=!0,this.remove(),this.trigger("close")),this},onSetTheme:function(){this.setPieIcons()},removeElement:function(){this.options.cellView.model.remove()},toggleUnlink:function(){var t=0<this.options.graph.getConnectedLinks(this.options.cellView.model).length;this.$handles.children(".unlink").toggleClass("hidden",!t)},toggleFork:function(){var t=this.canFork();this.$handles.children(".fork").toggleClass("hidden",!t)},canFork:function(){var t,e=this.options,n=e.cellView,e=e.paper,o=e.options.validateConnection;return"function"!=typeof o||(t=V(this.cloneCell({fork:!0,validation:!0}),1)[0],t=e.createViewForModel(t),o=o.call(e,n,null,t,null,"target"),t.remove(),o)},cloneCell:function(){var t=this.options,e=t.cellView,t=(0,t.clone)(e.model,0<arguments.length&&void 0!==arguments[0]?arguments[0]:{});if(t instanceof h.dia.Cell)return[t];if(Array.isArray(t)&&0<t.length&&t.every(function(t){return t instanceof h.dia.Cell}))return t;throw new Error('ui.Halo: option "clone" has to return a cell.')},toggleState:function(e){var t,n;this.isRendered()&&(t=this.$el,h.util.forIn(this.$pieToggles,function(t){t.removeClass("open")}),this.isOpen()?(this.trigger("state:close",e),t.removeClass("open")):(this.trigger("state:open",e),e&&((n=h.util.toArray(this.options.pieToggles).find(function(t){return t.name===e}))&&t.attr({"data-pie-toggle-position":n.position,"data-pie-toggle-name":n.name}),this.$pieToggles[e].addClass("open")),t.addClass("open")))},isOpen:function(t){return!!this.isRendered()&&(t?this.$pieToggles[t]:this.$el).hasClass("open")},isRendered:function(){return void 0!==this.$box}},{clear:function(t){t.trigger("halo:create")},HandlePosition:{N:"n",NW:"nw",W:"w",SW:"sw",S:"s",SE:"se",E:"e",NE:"ne"}}));H.Halo=T}(this.joint.ui=this.joint.ui||{},$,joint);