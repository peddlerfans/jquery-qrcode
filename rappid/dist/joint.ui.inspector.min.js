/*! JointJS+ v3.6.3 - HTML5 Diagramming Framework

Copyright (c) 2022 client IO

 2022-12-09 


This Source Code Form is subject to the terms of the JointJS+ License
, v. 2.0. If a copy of the JointJS+ License was not distributed with this
file, You can obtain one at http://jointjs.com/license/rappid_v2.txt
 or from the JointJS+ archive as was distributed by client IO. See the LICENSE file.*/


this.joint=this.joint||{},function(L,d,f){"use strict";function B(t){return(B="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}d=d&&Object.prototype.hasOwnProperty.call(d,"default")?d.default:d;var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function V(t,e){return t(e={exports:{}},e.exports),e.exports}function M(t){return t&&t.Math==Math&&t}function u(t){try{return!!t()}catch(t){return!0}}function N(t){return lt?gt(t):function(){return vt.apply(t,arguments)}}function c(t){if("Function"===i(t))return N(t)}function D(t){if(Ot(t))throw St("Can't call method on "+t);return t}function G(t){return xt(D(t))}function H(t,e){return arguments.length<2?(n=b[t],S(n)?n:void 0):b[t]&&b[t][e];var n}function W(t){return Gt(D(t))}function U(t){return"Symbol("+(void 0===t?"":t)+")_"+qt(++Wt+Ut,36)}function l(t){var e;return m(Kt,t)&&(Pt||"string"==typeof Kt[t])||(e="Symbol."+t,Pt&&m(zt,t)?Kt[t]=zt[t]:Kt[t]=(Tt&&Yt?Yt:Xt)(e)),Kt[t]}function q(t){return t=Zt(t,"string"),_t(t)?t:t+""}function K(t){return be[t]||(be[t]=U(t))}function y(t,e,n,i){var o=(i=i||{}).enumerable,r=void 0!==i.name?i.name:e;if(S(n)&&Ee(n,r,i),i.global)o?t[e]=n:Nt(e,n);else{try{i.unsafe?t[e]&&(o=!0):delete t[e]}catch(t){}o?t[e]=n:w.f(t,e,{value:n,enumerable:!1,configurable:!i.nonConfigurable,writable:!i.nonWritable})}return t}function z(t,e){return(t=je(t))<0?Pe(t+e,0):Te(t,e)}function Y(t){return _e(t.length)}function X(a){return function(t,e,n){var i,o=G(t),r=Y(o),s=z(n,r);if(a&&e!=e){for(;s<r;)if((i=o[s++])!=i)return!0}else for(;s<r;s++)if((a||s in o)&&o[s]===e)return a||s||0;return!a&&-1}}function J(t,e){var n,i=G(t),o=0,r=[];for(n in i)!m(me,n)&&m(i,n)&&ke(r,n);for(;e.length>o;)!m(i,n=e[o++])||~Re(r,n)||ke(r,n);return r}function Q(t,e){return(t=He[Ge(t)])==Ue||t!=We&&(S(e)?u(e):!!e)}function e(t,e){var n,i,o,r=t.target,s=t.global,a=t.stat,u=s?b:a?b[r]||Nt(r,{}):(b[r]||{}).prototype;if(u)for(n in e){if(i=e[n],o=t.dontCallGetSet?(o=Ke(u,n))&&o.value:u[n],!qe(s?n:r+(a?".":"#")+n,t.forced)&&void 0!==o){if(typeof i==typeof o)continue;for(var c=i,l=o,p=g=v=f=d=h=void 0,h=Ne(l),d=w.f,f=re.f,v=0;v<h.length;v++){var g=h[v];m(c,g)||p&&m(p,g)||d(c,g,f(l,g))}}(t.sham||o&&o.sham)&&fe(i,"sham",!0),y(u,n,i,t)}}function Z(t,e){return v(t),void 0===e?t:lt?ze(t,e):function(){return t.apply(e,arguments)}}function tt(){}function et(t){if(!S(t))return!1;try{return en(tt,tn,t),!0}catch(t){return!1}}function nt(t){if(!S(t))return!1;switch(Ze(t)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return rn||!!on(nn,ye(t))}catch(t){return!0}}function it(t,e){return new(cn(t))(0===e?0:e)}function ot(h){var d=1==h,f=2==h,v=3==h,g=4==h,y=6==h,b=7==h,m=5==h||y;return function(t,e,n,i){for(var o,r,s=W(t),a=xt(s),u=Z(e,n),c=Y(a),l=0,e=i||it,p=d?e(t,c):f||b?e(t,0):void 0;l<c;l++)if((m||l in a)&&(r=u(o=a[l],l,s),h))if(d)p[l]=r;else if(r)switch(h){case 3:return!0;case 5:return o;case 6:return l;case 2:ln(p,o)}else switch(h){case 4:return!1;case 7:ln(p,o)}return y?-1:v||g?g:p}}function rt(e){return 51<=jt||!u(function(){var t=[];return(t.constructor={})[pn]=function(){return{foo:1}},1!==t[e](Boolean).foo})}function st(t,e){var n=[][t];return!!n&&u(function(){n.call(null,e||function(){return 1},1)})}var at,ut,n,ct,b=M("object"==typeof globalThis&&globalThis)||M("object"==typeof window&&window)||M("object"==typeof self&&self)||M("object"==typeof t&&t)||function(){return this}()||Function("return this")(),p=!u(function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}),lt=!u(function(){var t=function(){}.bind();return"function"!=typeof t||t.hasOwnProperty("prototype")}),pt=Function.prototype.call,O=lt?pt.bind(pt):function(){return pt.apply(pt,arguments)},t={}.propertyIsEnumerable,ht=Object.getOwnPropertyDescriptor,dt={f:ht&&!t.call({1:2},1)?function(t){t=ht(this,t);return!!t&&t.enumerable}:t},ft=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}},t=Function.prototype,vt=t.call,gt=lt&&t.bind.bind(vt,vt),yt=N({}.toString),bt=N("".slice),i=function(t){return bt(yt(t),8,-1)},mt=Object,wt=c("".split),xt=u(function(){return!mt("z").propertyIsEnumerable(0)})?function(t){return"String"==i(t)?wt(t,""):mt(t)}:mt,Ot=function(t){return null==t},St=TypeError,t="object"==typeof document&&document.all,t={all:t,IS_HTMLDDA:void 0===t&&void 0!==t},Et=t.all,S=t.IS_HTMLDDA?function(t){return"function"==typeof t||t===Et}:function(t){return"function"==typeof t},Ct=t.all,h=t.IS_HTMLDDA?function(t){return"object"==typeof t?null!==t:S(t)||t===Ct}:function(t){return"object"==typeof t?null!==t:S(t)},It=c({}.isPrototypeOf),t=H("navigator","userAgent")||"",o=b.process,At=b.Deno,o=o&&o.versions||At&&At.version,At=o&&o.v8,jt=s=!(s=At?0<(r=At.split("."))[0]&&r[0]<4?1:+(r[0]+r[1]):s)&&t&&(!(r=t.match(/Edge\/(\d+)/))||74<=r[1])&&(r=t.match(/Chrome\/(\d+)/))?+r[1]:s,Pt=!!Object.getOwnPropertySymbols&&!u(function(){var t=Symbol();return!String(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&jt&&jt<41}),Tt=Pt&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,$t=Object,_t=Tt?function(t){return"symbol"==typeof t}:function(t){var e=H("Symbol");return S(e)&&It(e.prototype,$t(t))},Rt=String,kt=function(t){try{return Rt(t)}catch(t){return"Object"}},Ft=TypeError,v=function(t){if(S(t))return t;throw Ft(kt(t)+" is not a function")},Lt=function(t,e){t=t[e];return Ot(t)?void 0:v(t)},Bt=TypeError,Vt=function(t,e){var n,i;if("string"===e&&S(n=t.toString)&&!h(i=O(n,t)))return i;if(S(n=t.valueOf)&&!h(i=O(n,t)))return i;if("string"!==e&&S(n=t.toString)&&!h(i=O(n,t)))return i;throw Bt("Can't convert object to primitive value")},Mt=Object.defineProperty,Nt=function(e,n){try{Mt(b,e,{value:n,configurable:!0,writable:!0})}catch(t){b[e]=n}return n},o="__core-js_shared__",Dt=b[o]||Nt(o,{}),At=V(function(t){(t.exports=function(t,e){return Dt[t]||(Dt[t]=void 0!==e?e:{})})("versions",[]).push({version:"3.25.5",mode:"global",copyright:"Â© 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.25.5/LICENSE",source:"https://github.com/zloirock/core-js"})}),Gt=Object,Ht=c({}.hasOwnProperty),m=Object.hasOwn||function(t,e){return Ht(W(t),e)},Wt=0,Ut=Math.random(),qt=c(1..toString),Kt=At("wks"),zt=b.Symbol,Yt=zt&&zt.for,Xt=Tt?zt:zt&&zt.withoutSetter||U,Jt=TypeError,Qt=l("toPrimitive"),Zt=function(t,e){if(!h(t)||_t(t))return t;var n=Lt(t,Qt);if(n){if(n=O(n,t,e=void 0===e?"default":e),!h(n)||_t(n))return n;throw Jt("Can't convert object to primitive value")}return Vt(t,e=void 0===e?"number":e)},te=b.document,ee=h(te)&&h(te.createElement),ne=function(t){return ee?te.createElement(t):{}},ie=!p&&!u(function(){return 7!=Object.defineProperty(ne("div"),"a",{get:function(){return 7}}).a}),oe=Object.getOwnPropertyDescriptor,re={f:p?oe:function(t,e){if(t=G(t),e=q(e),ie)try{return oe(t,e)}catch(t){}if(m(t,e))return ft(!O(dt.f,t,e),t[e])}},r=p&&u(function(){return 42!=Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype}),se=String,ae=TypeError,E=function(t){if(h(t))return t;throw ae(se(t)+" is not an object")},ue=TypeError,ce=Object.defineProperty,le=Object.getOwnPropertyDescriptor,pe="enumerable",he="configurable",de="writable",w={f:p?r?function(t,e,n){var i;return E(t),e=q(e),E(n),"function"==typeof t&&"prototype"===e&&"value"in n&&de in n&&!n[de]&&((i=le(t,e))&&i[de]&&(t[e]=n.value,n={configurable:(he in n?n:i)[he],enumerable:(pe in n?n:i)[pe],writable:!1})),ce(t,e,n)}:ce:function(t,e,n){if(E(t),e=q(e),E(n),ie)try{return ce(t,e,n)}catch(t){}if("get"in n||"set"in n)throw ue("Accessors not supported");return"value"in n&&(t[e]=n.value),t}},fe=p?function(t,e,n){return w.f(t,e,ft(1,n))}:function(t,e,n){return t[e]=n,t},s=Function.prototype,o=p&&Object.getOwnPropertyDescriptor,a=m(s,"name"),ve={EXISTS:a,PROPER:a&&"something"===function(){}.name,CONFIGURABLE:a&&(!p||o(s,"name").configurable)},ge=c(Function.toString),ye=(S(Dt.inspectSource)||(Dt.inspectSource=function(t){return ge(t)}),Dt.inspectSource),a=b.WeakMap,o=S(a)&&/native code/.test(String(a)),be=At("keys"),me={},we="Object already initialized",xe=b.TypeError,s=b.WeakMap,Oe=o||Dt.state?((n=Dt.state||(Dt.state=new s)).get=n.get,n.has=n.has,n.set=n.set,at=function(t,e){if(n.has(t))throw xe(we);return e.facade=t,n.set(t,e),e},ut=function(t){return n.get(t)||{}},function(t){return n.has(t)}):(ct=K("state"),me[ct]=!0,at=function(t,e){if(m(t,ct))throw xe(we);return e.facade=t,fe(t,ct,e),e},ut=function(t){return m(t,ct)?t[ct]:{}},function(t){return m(t,ct)}),Se={set:at,get:ut,has:Oe,enforce:function(t){return Oe(t)?ut(t):at(t,{})},getterFor:function(e){return function(t){if(h(t)&&(t=ut(t)).type===e)return t;throw xe("Incompatible receiver, "+e+" required")}}},Ee=V(function(t){var i=ve.CONFIGURABLE,o=Se.enforce,e=Se.get,r=Object.defineProperty,s=p&&!u(function(){return 8!==r(function(){},"length",{value:8}).length}),a=String(String).split("String"),t=t.exports=function(t,e,n){"Symbol("===String(e).slice(0,7)&&(e="["+String(e).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),n&&n.getter&&(e="get "+e),n&&n.setter&&(e="set "+e),(!m(t,"name")||i&&t.name!==e)&&(p?r(t,"name",{value:e,configurable:!0}):t.name=e),s&&n&&m(n,"arity")&&t.length!==n.arity&&r(t,"length",{value:n.arity});try{n&&m(n,"constructor")&&n.constructor?p&&r(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch(t){}n=o(t);return m(n,"source")||(n.source=a.join("string"==typeof e?e:"")),t};Function.prototype.toString=t(function(){return S(this)&&e(this).source||ye(this)},"toString")}),Ce=Math.ceil,Ie=Math.floor,Ae=Math.trunc||function(t){t=+t;return(0<t?Ie:Ce)(t)},je=function(t){t=+t;return t!=t||0==t?0:Ae(t)},Pe=Math.max,Te=Math.min,$e=Math.min,_e=function(t){return 0<t?$e(je(t),9007199254740991):0},a={includes:X(!0),indexOf:X(!1)},Re=a.indexOf,ke=c([].push),Fe=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],Le=Fe.concat("length","prototype"),Be={f:Object.getOwnPropertyNames||function(t){return J(t,Le)}},Ve={f:Object.getOwnPropertySymbols},Me=c([].concat),Ne=H("Reflect","ownKeys")||function(t){var e=Be.f(E(t)),n=Ve.f;return n?Me(e,n(t)):e},De=/#|\.prototype\./,Ge=Q.normalize=function(t){return String(t).replace(De,".").toLowerCase()},He=Q.data={},We=Q.NATIVE="N",Ue=Q.POLYFILL="P",qe=Q,Ke=re.f,ze=c(c.bind),Ye=Array.isArray||function(t){return"Array"==i(t)},o={},s=(o[l("toStringTag")]="z","[object z]"===String(o)),Xe=l("toStringTag"),Je=Object,Qe="Arguments"==i(function(){return arguments}()),Ze=s?i:function(t){var e;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(e=function(t,e){try{return t[e]}catch(t){}}(t=Je(t),Xe))?e:Qe?i(t):"Object"==(e=i(t))&&S(t.callee)?"Arguments":e},tn=[],en=H("Reflect","construct"),nn=/^\s*(?:class|function)\b/,on=c(nn.exec),rn=!nn.exec(tt),sn=(nt.sham=!0,!en||u(function(){var t;return et(et.call)||!et(Object)||!et(function(){t=!0})||t})?nt:et),an=l("species"),un=Array,cn=function(t){var e;return Ye(t)&&(e=t.constructor,(sn(e)&&(e===un||Ye(e.prototype))||h(e)&&null===(e=e[an]))&&(e=void 0)),void 0===e?un:e},ln=c([].push),o={forEach:ot(0),map:ot(1),filter:ot(2),some:ot(3),every:ot(4),find:ot(5),findIndex:ot(6),filterReject:ot(7)},pn=l("species"),hn=o.map,g=rt("map"),dn=(e({target:"Array",proto:!0,forced:!g},{map:function(t){return hn(this,t,1<arguments.length?arguments[1]:void 0)}}),Object.keys||function(t){return J(t,Fe)}),g=u(function(){dn(1)}),fn=(e({target:"Object",stat:!0,forced:g},{keys:function(t){return dn(W(t))}}),o.forEach),vn=st("forEach")?[].forEach:function(t){return fn(this,t,1<arguments.length?arguments[1]:void 0)};e({target:"Array",proto:!0,forced:[].forEach!=vn},{forEach:vn});function gn(e){if(e&&e.forEach!==vn)try{fe(e,"forEach",vn)}catch(t){e.forEach=vn}}s||y(Object.prototype,"toString",s?{}.toString:function(){return"[object "+Ze(this)+"]"},{unsafe:!0});var yn,bn={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},g=ne("span").classList,s=g&&g.constructor&&g.constructor.prototype,g=s===Object.prototype?void 0:s;for(yn in bn)bn[yn]&&gn(b[yn]&&b[yn].prototype);gn(g);function mn(t,e,n){return jn&&S(e=e.constructor)&&e!==n&&h(e=e.prototype)&&e!==n.prototype&&jn(t,e),t}function C(t){if("Symbol"===Ze(t))throw TypeError("Cannot convert a Symbol value to a string");return Tn(t)}function wn(e){return function(t){t=C(D(t));return 1&e&&(t=$n(t,_n,"")),t=2&e?$n(t,Rn,""):t}}var xn=c([].slice),On=Function,Sn=c([].concat),En=c([].join),Cn={},s=lt?On.bind:function(s){var a=v(this),t=a.prototype,u=xn(arguments,1),c=function(){var t=Sn(u,xn(arguments));if(this instanceof c){var e=a,n=t.length,i=t;if(!m(Cn,n)){for(var o=[],r=0;r<n;r++)o[r]="a["+r+"]";Cn[n]=On("C,a","return new C("+En(o,",")+")")}return Cn[n](e,i)}return a.apply(s,t)};return h(t)&&(c.prototype=t),c},In=(e({target:"Function",proto:!0,forced:Function.bind!==s},{bind:s}),String),An=TypeError,jn=Object.setPrototypeOf||("__proto__"in{}?function(){var n,i=!1,t={};try{(n=c(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))(t,[]),i=t instanceof Array}catch(t){}return function(t,e){return E(t),function(t){if("object"==typeof t||S(t))return;throw An("Can't set "+In(t)+" as a prototype")}(e),i?n(t,e):t.__proto__=e,t}}():void 0),Pn=c(1..valueOf),Tn=String,g="\t\n\v\f\r Â áââââââââââââ¯âã\u2028\u2029\ufeff",$n=c("".replace),s="["+g+"]",_n=RegExp("^"+s+s+"*"),Rn=RegExp(s+s+"*$"),s={start:wn(1),end:wn(2),trim:wn(3)},x=Be.f,kn=re.f,Fn=w.f,Ln=s.trim,Bn="Number",Vn=b[Bn],Mn=Vn.prototype,Nn=b.TypeError,Dn=c("".slice),Gn=c("".charCodeAt),Hn=function(t){var e,n,i,o,r,s,a,u=Zt(t,"number");if(_t(u))throw Nn("Cannot convert a Symbol value to a number");if("string"==typeof u&&2<u.length)if(u=Ln(u),43===(t=Gn(u,0))||45===t){if(88===(e=Gn(u,2))||120===e)return NaN}else if(48===t){switch(Gn(u,1)){case 66:case 98:n=2,i=49;break;case 79:case 111:n=8,i=55;break;default:return+u}for(r=(o=Dn(u,2)).length,s=0;s<r;s++)if((a=Gn(o,s))<48||i<a)return NaN;return parseInt(o,n)}return+u};if(qe(Bn,!Vn(" 0o1")||!Vn("0b1")||Vn("+0x1"))){for(var Wn,Un=function(t){var t=arguments.length<1?0:Vn(function(t){t=Zt(t,"number");return"bigint"==typeof t?t:Hn(t)}(t)),e=this;return It(Mn,e)&&u(function(){Pn(e)})?mn(Object(t),e,Un):t},qn=p?x(Vn):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,isFinite,isInteger,isNaN,isSafeInteger,parseFloat,parseInt,fromString,range".split(","),Kn=0;qn.length>Kn;Kn++)m(Vn,Wn=qn[Kn])&&!m(Un,Wn)&&Fn(Un,Wn,kn(Vn,Wn));(Un.prototype=Mn).constructor=Un,y(b,Bn,Un,{constructor:!0})}e({target:"Array",stat:!0},{isArray:Ye});function zn(t){if(9007199254740991<t)throw Qn("Maximum allowed index exceeded")}function Yn(t,e,n){(e=q(e))in t?w.f(t,e,ft(0,n)):t[e]=n}function Xn(t){return void 0!==t&&(ei.Array===t||ii[ni]===t)}function Jn(t,e){if(e=arguments.length<2?ri(t):e,v(e))return E(O(e,t));throw si(kt(t)+" is not iterable")}var Qn=TypeError,Zn=l("isConcatSpreadable"),x=51<=jt||!u(function(){var t=[];return t[Zn]=!1,t.concat()[0]!==t}),Bn=rt("concat"),ti=(e({target:"Array",proto:!0,arity:1,forced:!x||!Bn},{concat:function(t){for(var e,n,i,o,r,s=W(this),a=it(s,0),u=0,c=-1,l=arguments.length;c<l;c++)if(r=void 0,!h(o=i=-1===c?s:arguments[c])||(void 0!==(r=o[Zn])?!r:!Ye(o)))zn(u+1),Yn(a,u++,i);else for(n=Y(i),zn(u+n),e=0;e<n;e++,u++)e in i&&Yn(a,u,i[e]);return a.length=u,a}}),function(t,e,n){var i,o;E(t);try{if(!(i=Lt(t,"return"))){if("throw"===e)throw n;return n}i=O(i,t)}catch(t){o=!0,i=t}if("throw"===e)throw n;if(o)throw i;return E(i),n}),ei={},ni=l("iterator"),ii=Array.prototype,oi=l("iterator"),ri=function(t){if(!Ot(t))return Lt(t,oi)||Lt(t,"@@iterator")||ei[Ze(t)]},si=TypeError,ai=Array,ui=l("iterator"),ci=!1;try{var li=0,I={next:function(){return{done:!!li++}},return:function(){ci=!0}};I[ui]=function(){return this},Array.from(I,function(){throw 2})}catch(t){}function pi(t,e){if(e||ci){var n=!1;try{var i={};i[ui]=function(){return{next:function(){return{done:n=!0}}}},t(i)}catch(t){}return n}}function hi(o){return function(t,e){var n,t=C(D(t)),e=je(e),i=t.length;return e<0||i<=e?o?"":void 0:(n=wi(t,e))<55296||56319<n||e+1===i||(i=wi(t,e+1))<56320||57343<i?o?mi(t,e):n:o?xi(t,e,e+2):i-56320+(n-55296<<10)+65536}}function di(){}function fi(t){t.write(Ai("")),t.close();var e=t.parentWindow.Object;return t=null,e}function vi(){return this}function gi(t,e){return{value:t,done:e}}var yi,bi,x=!pi(function(t){Array.from(t)}),mi=(e({target:"Array",stat:!0,forced:x},{from:function(t){var e,n,i,o,r,s,a=W(t),t=sn(this),u=arguments.length,c=1<u?arguments[1]:void 0,l=void 0!==c,u=(l&&(c=Z(c,2<u?arguments[2]:void 0)),ri(a)),p=0;if(!u||this===ai&&Xn(u))for(e=Y(a),n=t?new this(e):ai(e);p<e;p++)s=l?c(a[p],p):a[p],Yn(n,p,s);else for(r=(o=Jn(a,u)).next,n=t?new this:[];!(i=O(r,o)).done;p++)s=l?function(e,t,n,i){try{return i?t(E(n)[0],n[1]):t(n)}catch(t){ti(e,"throw",t)}}(o,c,[i.value,p],!0):i.value,Yn(n,p,s);return n.length=p,n}}),c("".charAt)),wi=c("".charCodeAt),xi=c("".slice),Bn={codeAt:hi(!1),charAt:hi(!0)},Oi={f:p&&!r?Object.defineProperties:function(t,e){E(t);for(var n,i=G(e),o=dn(e),r=o.length,s=0;s<r;)w.f(t,n=o[s++],i[n]);return t}},Si=H("document","documentElement"),Ei="prototype",Ci="script",Ii=K("IE_PROTO"),Ai=function(t){return"<"+Ci+">"+t+"</"+Ci+">"},ji=function(){try{yi=new ActiveXObject("htmlfile")}catch(t){}ji="undefined"==typeof document||document.domain&&yi?fi(yi):(t=ne("iframe"),e="java"+Ci+":",t.style.display="none",Si.appendChild(t),t.src=String(e),(e=t.contentWindow.document).open(),e.write(Ai("document.F=Object")),e.close(),e.F);for(var t,e,n=Fe.length;n--;)delete ji[Ei][Fe[n]];return ji()},Pi=(me[Ii]=!0,Object.create||function(t,e){var n;return null!==t?(di[Ei]=E(t),n=new di,di[Ei]=null,n[Ii]=t):n=ji(),void 0===e?n:Oi.f(n,e)}),I=!u(function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype}),Ti=K("IE_PROTO"),$i=Object,_i=$i.prototype,x=I?$i.getPrototypeOf:function(t){var e,t=W(t);return m(t,Ti)?t[Ti]:(e=t.constructor,S(e)&&t instanceof e?e.prototype:t instanceof $i?_i:null)},Ri=l("iterator"),r=!1,I=([].keys&&("next"in(I=[].keys())?(I=x(x(I)))!==Object.prototype&&(bi=I):r=!0),!h(bi)||u(function(){var t={};return bi[Ri].call(t)!==t})),I=(S((bi=I?{}:bi)[Ri])||y(bi,Ri,function(){return this}),{IteratorPrototype:bi,BUGGY_SAFARI_ITERATORS:r}),ki=w.f,Fi=l("toStringTag"),r=function(t,e,n){(t=t&&!n?t.prototype:t)&&!m(t,Fi)&&ki(t,Fi,{configurable:!0,value:e})},Li=I.IteratorPrototype,Bi=function(){return this},A=ve.PROPER,j=ve.CONFIGURABLE,Vi=I.IteratorPrototype,Mi=I.BUGGY_SAFARI_ITERATORS,I=l("iterator"),Ni="values",Di="entries",Gi=Bn.charAt,Hi="String Iterator",Wi=Se.set,Ui=Se.getterFor(Hi),qi=String,P="String",Ki=function(t){Wi(this,{type:Hi,string:C(t),index:0})},T=function(){var t=Ui(this),e=t.string,n=t.index;return n>=e.length?gi(void 0,!0):(e=Gi(e,n),t.index+=e.length,gi(e,!1))},zi=void 0,Yi=void 0,Xi=void 0;function Ji(t){if(t===zi&&no)return no;if(!Mi&&t in k)return k[t];switch(t){case"keys":case Ni:case Di:return function(){return new Ki(this,t)}}return function(){return new Ki(this)}}var Qi,Zi,$=Ki,_=P,R=void 0,R=(_+=" Iterator",$.prototype=Pi(Li,{next:ft(+!R,T)}),r($,_,!1),ei[_]=Bi,P+" Iterator"),to=!1,k=qi.prototype,eo=k[I]||k["@@iterator"]||zi&&k[zi],no=!Mi&&eo||Ji(zi);if((T="Array"==P&&k.entries||eo)&&($=x(T.call(new qi)))!==Object.prototype&&$.next&&(x($)!==Vi&&(jn?jn($,Vi):S($[I])||y($,I,vi)),r($,R,!0)),A&&zi==Ni&&eo&&eo.name!==Ni&&(j?fe(k,"name",Ni):(to=!0,no=function(){return O(eo,this)})),zi)if(Qi={values:Ji(Ni),keys:Yi?no:Ji("keys"),entries:Ji(Di)},Xi)for(Zi in Qi)!Mi&&!to&&Zi in k||y(k,Zi,Qi[Zi]);else e({target:P,proto:!0,forced:Mi||to},Qi);k[I]!==no&&y(k,I,no,{name:zi}),ei[P]=no;function io(t){lo[co][t]=!0}function oo(t){var e;return h(t)&&(void 0!==(e=t[bo])?!!e:"RegExp"==i(t))}function ro(t){var t=H(t),e=w.f;p&&t&&!t[Io]&&e(t,Io,{configurable:!0,get:function(){return this}})}function so(t,e){var n,t=E(t).constructor;if(void 0===t||Ot(n=E(t)[Po]))return e;if(sn(t=n))return t;throw jo(kt(t)+" is not a constructor")}var ao,uo,Li=w.f,co=l("unscopables"),lo=Array.prototype,po=(null==lo[co]&&Li(lo,co,{configurable:!0,value:Pi(null)}),o.find),_="find",ho=!0,Bi=(_ in[]&&Array(1)[_](function(){ho=!1}),e({target:"Array",proto:!0,forced:ho},{find:function(t){return po(this,t,1<arguments.length?arguments[1]:void 0)}}),io(_),rt("slice")),fo=l("species"),vo=Array,go=Math.max,yo=(e({target:"Array",proto:!0,forced:!Bi},{slice:function(t,e){var n,i,o,r=G(this),s=Y(r),a=z(t,s),u=z(void 0===e?s:e,s);if(Ye(r)&&(n=r.constructor,(n=sn(n)&&(n===vo||Ye(n.prototype))||h(n)&&null===(n=n[fo])?void 0:n)===vo||void 0===n))return xn(r,a,u);for(i=new(void 0===n?vo:n)(go(u-a,0)),o=0;a<u;a++,o++)a in r&&Yn(i,o,r[a]);return i.length=o,i}}),a.includes),T=u(function(){return!Array(1).includes()}),bo=(e({target:"Array",proto:!0,forced:T},{includes:function(t){return yo(this,t,1<arguments.length?arguments[1]:void 0)}}),io("includes"),l("match")),mo=TypeError,wo=l("match"),xo=c("".indexOf),Oo=(e({target:"String",proto:!0,forced:!function(e){var n=/./;try{"/./"[e](n)}catch(t){try{return n[wo]=!1,"/./"[e](n)}catch(t){}}return!1}("includes")},{includes:function(t){return!!~xo(C(D(this)),C(function(t){if(oo(t))throw mo("The method doesn't accept regular expressions");return t}(t)),1<arguments.length?arguments[1]:void 0)}}),a.indexOf),So=c([].indexOf),Eo=!!So&&1/So([1],1,-0)<0,qi=st("indexOf"),Co=(e({target:"Array",proto:!0,forced:Eo||!qi},{indexOf:function(t){var e=1<arguments.length?arguments[1]:void 0;return Eo?So(this,t,e)||0:Oo(this,t,e)}}),"process"==i(b.process)),Io=l("species"),Ao=TypeError,jo=TypeError,Po=l("species"),x=Function.prototype,To=x.apply,$o=x.call,_o="object"==typeof Reflect&&Reflect.apply||(lt?$o.bind(To):function(){return $o.apply(To,arguments)}),Ro=TypeError,Vi=/(?:ipad|iphone|ipod).*applewebkit/i.test(t),$=b.setImmediate,R=b.clearImmediate,ko=b.process,Fo=b.Dispatch,Lo=b.Function,A=b.MessageChannel,Bo=b.String,Vo=0,Mo={},No="onreadystatechange";try{ao=b.location}catch(t){}function Do(t){return function(){ir(t)}}function Go(t){ir(t.data)}function Ho(t){b.postMessage(Bo(t),ao.protocol+"//"+ao.host)}function Wo(){this.head=null,this.tail=null}function Uo(t){var n,i;this.promise=new t(function(t,e){if(void 0!==n||void 0!==i)throw fr("Bad Promise constructor");n=t,i=e}),this.resolve=v(n),this.reject=v(i)}function qo(t,e){var n,i,o,r,s=e.value,a=e.state==$r,u=a?t.ok:t.fail,c=t.resolve,l=t.reject,p=t.domain;try{u?(a||(e.rejection===kr&&(r=e,O(gr,b,function(){var t=r.facade;Co?Cr.emit("rejectionHandled",t):Br(Tr,t,r.value)})),e.rejection=Rr),!0===u?n=s:(p&&p.enter(),n=u(s),p&&(p.exit(),o=!0)),n===t.promise?l(Sr("Promise-chain cycle")):(i=Fr(n))?O(i,n,c,l):c(n)):l(s)}catch(t){p&&!o&&p.exit(),l(t)}}var Ko,zo,Yo,Xo,Jo,Qo,Zo,tr,er,nr,ir=function(t){var e;m(Mo,t)&&(e=Mo[t],delete Mo[t],e())},Xi=($&&R||($=function(t){var e=arguments.length,n=1;if(e<n)throw Ro("Not enough arguments");var i=S(t)?t:Lo(t),o=xn(arguments,1);return Mo[++Vo]=function(){_o(i,void 0,o)},uo(Vo),Vo},R=function(t){delete Mo[t]},Co?uo=function(t){ko.nextTick(Do(t))}:Fo&&Fo.now?uo=function(t){Fo.now(Do(t))}:A&&!Vi?(Yi=(j=new A).port2,j.port1.onmessage=Go,uo=Z(Yi.postMessage,Yi)):b.addEventListener&&S(b.postMessage)&&!b.importScripts&&ao&&"file:"!==ao.protocol&&!u(Ho)?(uo=Ho,b.addEventListener("message",Go,!1)):uo=No in ne("script")?function(t){Si.appendChild(ne("script"))[No]=function(){Si.removeChild(this),ir(t)}}:function(t){setTimeout(Do(t),0)}),{set:$,clear:R}),P=/ipad|iphone|ipod/i.test(t)&&void 0!==b.Pebble,Li=/web0s(?!.*chrome)/i.test(t),_=re.f,or=Xi.set,Bi=b.MutationObserver||b.WebKitMutationObserver,T=b.document,rr=b.process,a=b.Promise,qi=_(b,"queueMicrotask"),x=qi&&qi.value,sr=(x||(Ko=function(){var t,e;for(Co&&(t=rr.domain)&&t.exit();zo;){e=zo.fn,zo=zo.next;try{e()}catch(t){throw zo?Xo():Yo=void 0,t}}Yo=void 0,t&&t.enter()},Xo=Vi||Co||Li||!Bi||!T?!P&&a&&a.resolve?((A=a.resolve(void 0)).constructor=a,Zo=Z(A.then,A),function(){Zo(Ko)}):Co?function(){rr.nextTick(Ko)}:(or=Z(or,b),function(){or(Ko)}):(Jo=!0,Qo=T.createTextNode(""),new Bi(Ko).observe(Qo,{characterData:!0}),function(){Qo.data=Jo=!Jo})),x||function(t){t={fn:t,next:void 0};Yo&&(Yo.next=t),zo||(zo=t,Xo()),Yo=t}),ar=function(t){try{return{error:!1,value:t()}}catch(t){return{error:!0,value:t}}},ur=(Wo.prototype={add:function(t){t={item:t,next:null};this.head?this.tail.next=t:this.head=t,this.tail=t},get:function(){var t=this.head;if(t)return this.head=t.next,this.tail===t&&(this.tail=null),t.item}},Wo),F=b.Promise,cr="object"==typeof Deno&&Deno&&"object"==typeof Deno.version,lr=!cr&&!Co&&"object"==typeof window&&"object"==typeof document,pr=(F&&F.prototype,l("species")),hr=!1,dr=S(b.PromiseRejectionEvent),j={CONSTRUCTOR:qe("Promise",function(){var t=ye(F),e=t!==String(F);if(!e&&66===jt)return!0;if(!jt||jt<51||!/native code/.test(t)){var t=new F(function(t){t(1)}),n=function(t){t(function(){},function(){})};if((t.constructor={})[pr]=n,!(hr=t.then(function(){})instanceof n))return!0}return!e&&(lr||cr)&&!dr}),REJECTION_EVENT:dr,SUBCLASSING:hr},fr=TypeError,vr={f:function(t){return new Uo(t)}},gr=Xi.set,yr="Promise",Yi=j.CONSTRUCTOR,br=j.REJECTION_EVENT,$=j.SUBCLASSING,mr=Se.getterFor(yr),wr=Se.set,R=F&&F.prototype,xr=F,Or=R,Sr=b.TypeError,Er=b.document,Cr=b.process,Ir=vr.f,Ar=Ir,jr=!!(Er&&Er.createEvent&&b.dispatchEvent),Pr="unhandledrejection",Tr="rejectionhandled",$r=1,_r=2,Rr=1,kr=2,Fr=function(t){var e;return!(!h(t)||!S(e=t.then))&&e},Lr=function(n,o){n.notified||(n.notified=!0,sr(function(){for(var t,i,e=n.reactions;t=e.get();)qo(t,n);n.notified=!1,o&&!n.rejection&&(i=n,O(gr,b,function(){var t=i.facade,e=i.value,n=Vr(i);if(n&&(n=ar(function(){Co?Cr.emit("unhandledRejection",e,t):Br(Pr,t,e)}),i.rejection=Co||Vr(i)?kr:Rr,n.error))throw n.value}))}))},Br=function(t,e,n){var i;jr?((i=Er.createEvent("Event")).promise=e,i.reason=n,i.initEvent(t,!1,!0),b.dispatchEvent(i)):i={promise:e,reason:n},!br&&(e=b["on"+t])?e(i):t===Pr&&function(t,e){var n=b.console;n&&n.error&&(1==arguments.length?n.error(t):n.error(t,e))}("Unhandled promise rejection",n)},Vr=function(t){return t.rejection!==Rr&&!t.parent},Mr=function(e,n,i){return function(t){e(n,t,i)}},Nr=function(t,e,n){t.done||(t.done=!0,(t=n?n:t).value=e,t.state=_r,Lr(t,!0))},Dr=function(n,t,e){if(!n.done){n.done=!0,e&&(n=e);try{if(n.facade===t)throw Sr("Promise can't be resolved itself");var i=Fr(t);i?sr(function(){var e={done:!1};try{O(i,t,Mr(Dr,e,n),Mr(Nr,e,n))}catch(t){Nr(e,t,n)}}):(n.value=t,n.state=$r,Lr(n,!1))}catch(t){Nr({done:!1},t,n)}}};if(Yi&&(Or=(xr=function(t){!function(t,e){if(It(e,t))return;throw Ao("Incorrect invocation")}(this,Or),v(t),O(tr,this);var e=mr(this);try{t(Mr(Dr,e),Mr(Nr,e))}catch(t){Nr(e,t)}}).prototype,(tr=function(t){wr(this,{type:yr,done:!1,notified:!1,parent:!1,reactions:new ur,rejection:!1,state:0,value:void 0})}).prototype=y(Or,"then",function(t,e){var n=mr(this),i=Ir(so(this,xr));return n.parent=!0,i.ok=!S(t)||t,i.fail=S(e)&&e,i.domain=Co?Cr.domain:void 0,0==n.state?n.reactions.add(i):sr(function(){qo(i,n)}),i.promise}),er=function(){var t=new tr,e=mr(t);this.promise=t,this.resolve=Mr(Dr,e),this.reject=Mr(Nr,e)},vr.f=Ir=function(t){return t===xr||void 0===t?new er:Ar(t)},S(F)&&R!==Object.prototype)){nr=R.then,$||y(R,"then",function(t,e){var n=this;return new xr(function(t,e){O(nr,n,t,e)}).then(t,e)},{unsafe:!0});try{delete R.constructor}catch(t){}jn&&jn(R,Or)}e({global:!0,constructor:!0,wrap:!0,forced:Yi},{Promise:xr}),r(xr,yr,!1),ro(yr);function Gr(t,e){this.stopped=t,this.result=e}function Hr(t,e,n){function i(t){return r&&ti(r,"normal",t),new Gr(!0,t)}function o(t){return h?(E(t),v?g(t[0],t[1],i):g(t[0],t[1])):v?g(t,i):g(t)}var r,s,a,u,c,l,p=n&&n.that,h=!(!n||!n.AS_ENTRIES),d=!(!n||!n.IS_RECORD),f=!(!n||!n.IS_ITERATOR),v=!(!n||!n.INTERRUPTED),g=Z(e,p);if(d)r=t.iterator;else if(f)r=t;else{if(!(n=ri(t)))throw Wr(kt(t)+" is not iterable");if(Xn(n)){for(s=0,a=Y(t);s<a;s++)if((u=o(t[s]))&&It(Ur,u))return;return}r=Jn(t,n)}for(c=(d?t:r).next;!(l=O(c,r)).done;){try{u=o(l.value)}catch(t){ti(r,"throw",t)}if("object"==typeof u&&u&&It(Ur,u))return}}var Wr=TypeError,Ur=Gr.prototype,t=j.CONSTRUCTOR||!pi(function(t){F.all(t).then(void 0,function(){})}),_=(e({target:"Promise",stat:!0,forced:t},{all:function(t){var a=this,e=vr.f(a),u=e.resolve,c=e.reject,n=ar(function(){var i=v(a.resolve),o=[],r=0,s=1;Hr(t,function(t){var e=r++,n=!1;s++,O(i,a,t).then(function(t){n||(n=!0,o[e]=t,--s||u(o))},c)}),--s||u(o)});return n.error&&c(n.value),e.promise}}),j.CONSTRUCTOR),qi=F&&F.prototype;e({target:"Promise",proto:!0,forced:_,real:!0},{catch:function(t){return this.then(void 0,t)}}),S(F)&&(Vi=H("Promise").prototype.catch,qi.catch!==Vi&&y(qi,"catch",Vi,{unsafe:!0})),e({target:"Promise",stat:!0,forced:t},{race:function(t){var n=this,i=vr.f(n),o=i.reject,e=ar(function(){var e=v(n.resolve);Hr(t,function(t){O(e,n,t).then(i.resolve,o)})});return e.error&&o(e.value),i.promise}});e({target:"Promise",stat:!0,forced:j.CONSTRUCTOR},{reject:function(t){var e=vr.f(this);return O(e.reject,void 0,t),e.promise}});function qr(n,t,e,i){var s,o=l(n),a=!u(function(){var t={};return t[o]=function(){return 7},7!=""[n](t)}),r=a&&!u(function(){var t=!1,e=/a/;return"split"===n&&((e={constructor:{}}).constructor[fs]=function(){return e},e.flags="",e[o]=/./[o]),e.exec=function(){return t=!0,null},e[o](""),!t});a&&r&&!e||(s=c(/./[o]),r=t(o,""[n],function(t,e,n,i,o){var t=c(t),r=e.exec;return r===ds||r===vs.exec?a&&!o?{done:!0,value:s(e,n,i)}:{done:!0,value:t(n,e,i)}:{done:!1}}),y(String.prototype,n,r[0]),y(vs,o,r[1])),i&&fe(vs[o],"sham",!0)}function Kr(t,e,n){return e+(n?gs(t,e).length:1)}function zr(t,e){var n=t.exec;if(S(n))return null!==(n=O(n,t,e))&&E(n),n;if("RegExp"===i(t))return O(ds,t,e);throw ys("RegExp#exec called on incompatible receiver")}function Yr(t){var e=t.flags;return void 0!==e||"flags"in bs||m(t,"flags")||!It(bs,t)?e:O(Xr,t)}var Li=j.CONSTRUCTOR,Xr=(H("Promise"),e({target:"Promise",stat:!0,forced:Li},{resolve:function(t){return t=t,E(e=this),h(t)&&t.constructor===e?t:((0,(e=vr.f(e)).resolve)(t),e.promise);var e}}),function(){var t=E(this),e="";return t.hasIndices&&(e+="d"),t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.dotAll&&(e+="s"),t.unicode&&(e+="u"),t.unicodeSets&&(e+="v"),t.sticky&&(e+="y"),e}),Jr=b.RegExp,P=u(function(){var t=Jr("a","y");return t.lastIndex=2,null!=t.exec("abcd")}),a=P||u(function(){return!Jr("a","y").sticky}),A={BROKEN_CARET:P||u(function(){var t=Jr("^r","gy");return t.lastIndex=2,null!=t.exec("str")}),MISSED_STICKY:a,UNSUPPORTED_Y:P},Qr=b.RegExp,Zr=u(function(){var t=Qr(".","s");return!t.dotAll||!t.exec("\n")||"s"!==t.flags}),ts=b.RegExp,es=u(function(){var t=ts("(?<a>b)","g");return"b"!==t.exec("b").groups.a||"bc"!=="b".replace(t,"$<a>c")}),ns=Se.get,is=At("native-string-replace",String.prototype.replace),os=RegExp.prototype.exec,rs=os,ss=c("".charAt),as=c("".indexOf),us=c("".replace),cs=c("".slice),ls=(T=/b*/g,O(os,Bi=/a/,"a"),O(os,T,"a"),0!==Bi.lastIndex||0!==T.lastIndex),ps=A.BROKEN_CARET,hs=void 0!==/()??/.exec("")[1],ds=rs=ls||hs||ps||Zr||es?function(t){var e,n,i,o,r,s,a=this,u=ns(a),t=C(t),c=u.raw;if(c)return c.lastIndex=a.lastIndex,p=O(rs,c,t),a.lastIndex=c.lastIndex,p;var l=u.groups,c=ps&&a.sticky,p=O(Xr,a),u=a.source,h=0,d=t;if(c&&(p=us(p,"y",""),-1===as(p,"g")&&(p+="g"),d=cs(t,a.lastIndex),0<a.lastIndex&&(!a.multiline||a.multiline&&"\n"!==ss(t,a.lastIndex-1))&&(u="(?: "+u+")",d=" "+d,h++),e=new RegExp("^(?:"+u+")",p)),hs&&(e=new RegExp("^"+u+"$(?!\\s)",p)),ls&&(n=a.lastIndex),i=O(os,c?e:a,d),c?i?(i.input=cs(i.input,h),i[0]=cs(i[0],h),i.index=a.lastIndex,a.lastIndex+=i[0].length):a.lastIndex=0:ls&&i&&(a.lastIndex=a.global?i.index+i[0].length:n),hs&&i&&1<i.length&&O(is,i[0],e,function(){for(o=1;o<arguments.length-2;o++)void 0===arguments[o]&&(i[o]=void 0)}),i&&l)for(i.groups=r=Pi(null),o=0;o<l.length;o++)r[(s=l[o])[0]]=i[s[1]];return i}:rs,fs=(e({target:"RegExp",proto:!0,forced:/./.exec!==ds},{exec:ds}),l("species")),vs=RegExp.prototype,gs=Bn.charAt,ys=TypeError,bs=(qr("match",function(i,a,u){return[function(t){var e=D(this),n=Ot(t)?void 0:Lt(t,i);return n?O(n,t,e):new RegExp(t)[i](C(e))},function(t){var e=E(this),n=C(t),t=u(a,e,n);if(t.done)return t.value;if(!e.global)return zr(e,n);for(var i=e.unicode,o=[],r=e.lastIndex=0;null!==(s=zr(e,n));){var s=C(s[0]);""===(o[r]=s)&&(e.lastIndex=Kr(n,_e(e.lastIndex),i)),r++}return 0===r?null:o}]}),RegExp.prototype),ms=w.f,x=Be.f,ws=Se.enforce,xs=l("match"),Os=b.RegExp,Ss=Os.prototype,Es=b.SyntaxError,Cs=c(Ss.exec),Is=c("".charAt),As=c("".replace),js=c("".indexOf),Ps=c("".slice),Ts=/^\?<[^\s\d!#%&*+<=>@^][^\s!#%&*+<=>@^]*>/,$s=/a/g,_s=/a/g,Xi=new Os($s)!==$s,Rs=A.MISSED_STICKY,ks=A.UNSUPPORTED_Y,$=p&&(!Xi||Rs||Zr||es||u(function(){return _s[xs]=!1,Os($s)!=$s||Os(_s)==_s||"/a/i"!=Os($s,"i")}));if(qe("RegExp",$)){for(var Fs=function(t,e){var n,i,o=It(Ss,this),r=oo(t),s=void 0===e,a=[],u=t;if(!o&&r&&s&&t.constructor===Fs)return t;if((r||It(Ss,t))&&(t=t.source,s&&(e=Yr(u))),t=void 0===t?"":C(t),e=void 0===e?"":C(e),u=t,r=e=Zr&&"dotAll"in $s&&(n=!!e&&-1<js(e,"s"))?As(e,/s/g,""):e,Rs&&"sticky"in $s&&(i=!!e&&-1<js(e,"y"))&&ks&&(e=As(e,/y/g,"")),es&&(t=(s=function(t){for(var e,n=t.length,i=0,o="",r=[],s={},a=!1,u=!1,c=0,l="";i<=n;i++){if("\\"===(e=Is(t,i)))e+=Is(t,++i);else if("]"===e)a=!1;else if(!a)switch(!0){case"["===e:a=!0;break;case"("===e:Cs(Ts,Ps(t,i+1))&&(i+=2,u=!0),o+=e,c++;continue;case">"===e&&u:if(""===l||m(s,l))throw new Es("Invalid capture group name");s[l]=!0,u=!(r[r.length]=[l,c]),l="";continue}u?l+=e:o+=e}return[o,r]}(t))[0],a=s[1]),s=mn(Os(t,e),o?this:Ss,Fs),(n||i||a.length)&&(e=ws(s),n&&(e.dotAll=!0,e.raw=Fs(function(t){for(var e,n=t.length,i=0,o="",r=!1;i<=n;i++)"\\"===(e=Is(t,i))?o+=e+Is(t,++i):r||"."!==e?("["===e?r=!0:"]"===e&&(r=!1),o+=e):o+="[\\s\\S]";return o}(t),r)),i&&(e.sticky=!0),a.length&&(e.groups=a)),t!==u)try{fe(s,"source",""===u?"(?:)":u)}catch(t){}return s},Ls=x(Os),Bs=0;Ls.length>Bs;)!function(t,e,n){n in t||ms(t,n,{configurable:!0,get:function(){return e[n]},set:function(t){e[n]=t}})}(Fs,Os,Ls[Bs++]);(Ss.constructor=Fs).prototype=Ss,y(b,"RegExp",Fs,{constructor:!0})}ro("RegExp");function Vs(c){return function(t,e,n,i){v(e);var o=W(t),r=xt(o),s=Y(o),a=c?s-1:0,u=c?-1:1;if(n<2)for(;;){if(a in r){i=r[a],a+=u;break}if(a+=u,c?a<0:s<=a)throw Ns("Reduce of empty array with no initial value")}for(;c?0<=a:a<s;a+=u)a in r&&(i=e(i,r[a],a,o));return i}}var R=ve.PROPER,Yi="toString",Ms=RegExp.prototype[Yi],_=u(function(){return"/a/b"!=Ms.call({source:"a",flags:"b"})}),qi=R&&Ms.name!=Yi,Ns=((_||qi)&&y(RegExp.prototype,Yi,function(){var t=E(this);return"/"+C(t.source)+"/"+C(Yr(t))},{unsafe:!0}),TypeError),Ds={left:Vs(!1),right:Vs(!0)}.left,Vi=st("reduce"),Gs=(e({target:"Array",proto:!0,forced:!Vi||!Co&&79<jt&&jt<83},{reduce:function(t){var e=arguments.length;return Ds(this,t,e,1<e?arguments[1]:void 0)}}),o.findIndex),t="findIndex",Hs=!0,Ws=(t in[]&&Array(1)[t](function(){Hs=!1}),e({target:"Array",proto:!0,forced:Hs},{findIndex:function(t){return Gs(this,t,1<arguments.length?arguments[1]:void 0)}}),io(t),c([].join)),j=xt!=Object,Li=st("join",","),Us=(e({target:"Array",proto:!0,forced:j||!Li},{join:function(t){return Ws(G(this),void 0===t?",":t)}}),o.filter),a=rt("filter"),P=(e({target:"Array",proto:!0,forced:!a},{filter:function(t){return Us(this,t,1<arguments.length?arguments[1]:void 0)}}),ve.EXISTS),At=w.f,Bi=Function.prototype,qs=c(Bi.toString),Ks=/function\b(?:\s|\/\*[\S\s]*?\*\/|\/\/[^\n\r]*[\n\r]+)*([^\s(/]*)/,zs=c(Ks.exec),Ys=(p&&!P&&At(Bi,"name",{configurable:!0,get:function(){try{return zs(Ks,qs(this))[1]}catch(t){return""}}}),Math.floor),Xs=c("".charAt),Js=c("".replace),Qs=c("".slice),Zs=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,ta=/\$([$&'`]|\d{1,2})/g,ea=l("replace"),na=Math.max,ia=Math.min,oa=c([].concat),ra=c([].push),sa=c("".indexOf),aa=c("".slice),T="$0"==="a".replace(/./,"$0"),ua=!!/./[ea]&&""===/./[ea]("a","$0"),ca=(qr("replace",function(t,m,w){var x=ua?"$":"$0";return[function(t,e){var n=D(this),i=Ot(t)?void 0:Lt(t,ea);return i?O(i,t,n,e):O(m,C(n),t,e)},function(t,e){var n=E(this),i=C(t);if("string"==typeof e&&-1===sa(e,x)&&-1===sa(e,"$<")){t=w(m,n,i,e);if(t.done)return t.value}for(var o,r=S(e),s=(r||(e=C(e)),n.global),a=(s&&(o=n.unicode,n.lastIndex=0),[]);null!==(h=zr(n,i))&&(ra(a,h),s);)""===C(h[0])&&(n.lastIndex=Kr(i,_e(n.lastIndex),o));for(var u,c="",l=0,p=0;p<a.length;p++){for(var h,d=C((h=a[p])[0]),f=na(ia(je(h.index),i.length),0),v=[],g=1;g<h.length;g++)ra(v,void 0===(u=h[g])?u:String(u));var y=h.groups,b=r?(b=oa([d],v,f,i),void 0!==y&&ra(b,y),C(_o(e,void 0,b))):function(r,s,a,u,c,t){var l=a+r.length,p=u.length,e=ta;return void 0!==c&&(c=W(c),e=Zs),Js(t,e,function(t,e){var n;switch(Xs(e,0)){case"$":return"$";case"&":return r;case"`":return Qs(s,0,a);case"'":return Qs(s,l);case"<":n=c[Qs(e,1,-1)];break;default:var i,o=+e;if(0==o)return t;if(p<o)return 0!==(i=Ys(o/10))&&i<=p?void 0===u[i-1]?Xs(e,1):u[i-1]+Xs(e,1):t;n=u[o-1]}return void 0===n?"":n})}(d,i,f,v,y,e);l<=f&&(c+=aa(i,l,f)+b,l=f+d.length)}return c+aa(i,l)}]},!!u(function(){var t=/./;return t.exec=function(){var t=[];return t.groups={a:"7"},t},"7"!=="".replace(t,"$<a>")})||!T||ua),s.trim),la=b.parseInt,Bn=b.Symbol,pa=Bn&&Bn.iterator,ha=/^[+-]?0x/i,da=c(ha.exec),A=8!==la(g+"08")||22!==la(g+"0x16")||pa&&!u(function(){la(Object(pa))})?function(t,e){t=ca(C(t));return la(t,e>>>0||(da(ha,t)?16:10))}:la,fa=(e({global:!0,forced:parseInt!=A},{parseInt:A}),b.isFinite),Xi=Number.isFinite||function(t){return"number"==typeof t&&fa(t)},va=(e({target:"Number",stat:!0},{isFinite:Xi}),c([].reverse)),$=[1,2],ga=(e({target:"Array",proto:!0,forced:String($)===String($.reverse())},{reverse:function(){return Ye(this)&&(this.length=this.length),va(this)}}),e({target:"Number",stat:!0},{isNaN:function(t){return t!=t}}),s.trim),ya=c("".charAt),ba=b.parseFloat,x=b.Symbol,ma=x&&x.iterator,R=1/ba(g+"-0")!=-1/0||ma&&!u(function(){ba(Object(ma))})?function(t){var t=ga(C(t)),e=ba(t);return 0===e&&"-"==ya(t,0)?-0:e}:ba,wa=(e({global:!0,forced:parseFloat!=R},{parseFloat:R}),o.every),_=st("every"),xa=(e({target:"Array",proto:!0,forced:!_},{every:function(t){return wa(this,t,1<arguments.length?arguments[1]:void 0)}}),o.some),qi=st("some"),Oa=(e({target:"Array",proto:!0,forced:!qi},{some:function(t){return xa(this,t,1<arguments.length?arguments[1]:void 0)}}),f.mvc.View.extend({className:"select-box",events:{"click .select-box-selection":"onToggle"},options:{options:[],width:void 0,openPolicy:"auto",target:null,keyboardNavigation:!0,selected:void 0,selectBoxOptionsClass:void 0,disabled:!1},init:function(){this.options.target=this.options.target||document.body,f.util.bindAll(this,"onOutsideClick","onOptionSelect"),d(document).on("click.selectBox",this.onOutsideClick),this.$el.data("view",this),void 0===this.options.selected?this.selection=f.util.toArray(this.options.options).find(function(t){return!0===t.selected})||this.options.options[0]:this.selection=this.options.options[this.options.selected]},render:function(){return this.$el.empty(),this.$selection=null,this.renderSelection(this.selection),this.options.width&&this.$el.css("width",this.options.width),this.options.disabled&&this.disable(),this.$el.append(this.$options),this},renderOptions:function(){this.removeOptions();var t=this.options,e={selectBoxView:this,parentClassName:f.util.result(this,"className")||null,extraClassName:f.util.result(t,"selectBoxOptionsClass")||null,options:t.options},e=(t.width&&(e.width=t.width),t.theme&&(e.theme=t.theme),this.optionsView=new this.constructor.OptionsView(e));e.render(),this.listenTo(e,"option:select",this.onOptionSelect),this.listenTo(e,"option:hover",this.onOptionHover),this.listenTo(e,"options:mouseout",this.onOptionsMouseOut),this.$options=e.$el,this.$optionsArrow=e.$arrow,this.$target=d(t.target)},onOptionHover:function(t,e){this.trigger("option:hover",t,e)},onOptionsMouseOut:function(t){this.trigger("options:mouseout",t)},onOptionSelect:function(t,e){this.select(t,e)},removeOptions:function(){this.optionsView&&(this.stopListening(this.optionsView),this.optionsView.remove(),this.optionsView=null)},renderSelection:function(t){this.$selection||(this.$selection=d("<div/>",{class:"select-box-selection"}),this.$el.append(this.$selection)),this.$selection.empty(),t?(t=this.constructor.OptionsView.prototype.renderOptionContent.call(void 0,t),this.$selection.append(t)):this.options.placeholder&&(t=d("<div/>",{class:"select-box-placeholder",html:this.options.placeholder}),this.$selection.append(t))},onToggle:function(t){this.toggle()},onOutsideClick:function(t){!this.el.contains(t.target)&&this.$el.hasClass("opened")&&this.close()},getSelection:function(){return this.selection},getSelectionValue:function(t){return(t=t||this.selection)&&(void 0===t.value?t.content:t.value)},getSelectionIndex:function(){return f.util.toArray(this.options.options).findIndex(function(t){return t===this.selection}.bind(this))},select:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};this.selection=this.options.options[t],this.renderSelection(this.selection),this.trigger("option:select",this.selection,t,e),this.close()},selectByValue:function(t,e){for(var n=this.options.options||[],i=0;i<n.length;i++){var o=n[i];if(void 0===o.value&&o.content===t)return this.select(i,e);if(void 0!==o.value&&f.util.isEqual(o.value,t))return this.select(i,e)}},isOpen:function(){return this.$el.hasClass("opened")},toggle:function(){this.isOpen()?this.close():this.open()},position:function(){var t=this.$(".select-box-selection"),e=t.outerHeight(),t=t.offset(),n=t.left,i=t.top,o=this.$options.outerHeight(),r={left:0,top:0},t=(this.options.target!==document.body?((r=this.$target.offset()).width=this.$target.outerWidth(),r.height=this.$target.outerHeight(),r.left-=this.$target.scrollLeft(),r.top-=this.$target.scrollTop()):(r.width=d(window).width(),r.height=d(window).height()),n),s="auto",n=this.options.openPolicy;switch(n="selected"!==n||this.selection?n:"auto"){case"above":s=i-o;break;case"coverAbove":s=i-o+e;break;case"below":s=i+e;break;case"coverBelow":s=i;break;case"selected":s=i-this.$options.find(".selected").position().top;break;default:s=i-this.$target.scrollTop()+o>r.top+r.height?i-o+e:i}t-=r.left,s-=r.top,this.$options.css({left:t,top:s})},open:function(){this.isDisabled()||(this.renderOptions(),this.$options.appendTo(this.options.target),this.$options.addClass("rendered"),this.position(),this.$el.addClass("opened"),this.respectWindowBoundaries(),this.alignOptionsArrow())},respectWindowBoundaries:function(){var t=this.calculateElOverflow(this.$options,this.$target),e={left:0,top:0};this.$options.outerWidth()<=this.$target.innerWidth()&&(t.left&&t.right||(t.left?e.left=t.left:t.right&&(e.left=-t.right))),this.$options.outerHeight()<=this.$target.innerHeight()&&(t.top&&t.bottom||(t.top?e.top=t.top:t.bottom&&(e.top=-t.bottom))),this.$options.css({left:"+="+e.left,top:"+="+e.top})},alignOptionsArrow:function(){var t=this.$el[0].getBoundingClientRect(),e=this.$options[0].getBoundingClientRect(),t=t.left+t.width/2,t=(t-=e.left)-this.$optionsArrow.outerWidth()/2;this.$optionsArrow.css({left:t})},close:function(){this.removeOptions(),this.$el.removeClass("opened"),this.trigger("close")},onRemove:function(){this.removeOptions(),d(document).off(".selectBox",this.onOutsideClick)},isDisabled:function(){return this.$el.hasClass("disabled")},enable:function(){this.$el.removeClass("disabled")},disable:function(){this.close(),this.$el.addClass("disabled")},onSetTheme:function(t,e){this.$options&&(t&&this.$options.removeClass(this.themeClassNamePrefix+t),this.$options.addClass(this.themeClassNamePrefix+e))},calculateElOverflow:function(t,e){e=e||window,t instanceof d&&(t=t[0]),e instanceof d&&(e=e[0]);var n,i,o={},r=t.getBoundingClientRect();return i=e===window?{width:t=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,height:n=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,left:0,top:0,right:t,bottom:n}:e.getBoundingClientRect(),["left","top"].forEach(function(t){o[t]=Math.min(0,r[t]-i[t])}),["right","bottom"].forEach(function(t){o[t]=Math.min(0,i[t]-r[t])}),f.util.forIn(o,function(t,e){o[e]=Math.abs(Math.round(t))}),o}},{OptionsView:f.mvc.View.extend({events:{"mouseover .select-box-option":"onOptionHover","click .select-box-option":"onOptionClick"},className:function(){var t=["select-box-options"],e=this.options.parentClassName;return e&&t.push(e),t.join(" ")},init:function(){f.util.bindAll(this,"onMouseout","onKeydown"),d(document).on({"keydown.selectBoxOptions":this.onKeydown,"mouseleave.selectBoxOptions mouseout.selectBoxOptions":this.onMouseout})},render:function(){var t=this.options.extraClassName;return t&&this.$el.addClass(t),this.options.width&&this.$el.css("width",this.options.width),f.util.toArray(this.options.options).forEach(function(t,e){e=this.renderOption(t,e);this.options.selectBoxView.selection===t&&e.addClass("selected hover"),this.$el.append(e)},this),this.$arrow=d("<div/>").addClass("select-box-options-arrow").appendTo(this.$el),this},renderOption:function(t,e){t=this.renderOptionContent(t);return t.addClass("select-box-option"),t.data("index",e),t},renderOptionContent:function(t){var e=d("<div/>",{class:"select-box-option-content",html:t.content});return t.icon&&e.prepend(d("<img/>",{class:"select-box-option-icon",src:t.icon})),e},select:function(t){this.trigger("option:select",t,1<arguments.length&&void 0!==arguments[1]?arguments[1]:{})},hover:function(t){var e=this.options.options[t];this.markOptionHover(t),this.trigger("option:hover",e,t)},onOptionClick:function(t){t=this.getOptionIndex(t.target);this.select(t,{ui:!0})},onOptionHover:function(t){t=this.getOptionIndex(t.target);this.hover(t)},onMouseout:function(t){this.trigger("options:mouseout",t)},onKeydown:function(t){var e,n=this.options.selectBoxView;if(n.options.keyboardNavigation&&n.isOpen()){switch(t.which){case 39:case 40:e=1;break;case 38:case 37:e=-1;break;case 13:var i=this.getOptionHoverIndex();return void(0<=i&&this.select(i));case 27:return n.close();default:return}t.preventDefault();var t=this.getOptionHoverIndex()+e,o=this.options.options;(t=t<0?o.length-1:t)>=o.length&&(t=0),this.hover(t)}},onRemove:function(){d(document).off(".selectBoxOptions")},markOptionHover:function(t){this.$el.find(".hover").removeClass("hover"),d(this.$el.find(".select-box-option")[t]).addClass("hover")},getOptionHoverIndex:function(){return this.$el.find(".select-box-option.hover").index()},getOptionIndex:function(t){return d(t).closest(".select-box-option").data("index")}})})),Sa=f.mvc.View.extend({className:"select-button-group",events:{"click .select-button-group-button":"onSelect","mouseover .select-button-group-button":"onOptionHover",mouseleave:"onMouseOut","mousedown .select-button-group-button":"pointerdown","touchstart .select-button-group-button":"pointerdown","mouseup .select-button-group-button":"pointerup","touchend .select-button-group-button":"pointerup"},options:{options:[],disabled:!1,multi:!1,selected:void 0,singleDeselect:!1,noSelectionValue:void 0,width:void 0,buttonWidth:void 0,buttonHeight:void 0,iconWidth:void 0,iconHeight:void 0},init:function(){f.util.bindAll(this,"onSelect","pointerup"),this.$el.data("view",this);var t,e=this.options.options,n=this.options.multi,i=this.options.selected;void 0===i?(t=f.util.toArray(e).filter(function(t){return t&&!0===t.selected}),this.selection=n?t:t[0]):this.selection=n?Array.isArray(i)?e.filter(function(t,e){return i.includes(e)}):[e[i]]:e[i]},render:function(){return this.renderOptions(this.selection),this.options.width&&this.$el.css("width",this.options.width),this.options.disabled&&this.disable(),this.$el.append(this.$options),this},renderOptions:function(){this.removeOptions(),f.util.toArray(this.options.options).forEach(function(t,e){var n=this.options.multi?this.selection.includes(t):this.selection===t,t=this.renderOption(t,e,n);this.$el.append(t),n&&t.addClass("selected")},this)},removeOptions:function(){this.$el.empty()},renderOption:function(t,e,n){n=this.renderOptionContent(t,n),n.data("index",e),e=t.buttonWidth||this.options.buttonWidth,e&&n.css("width",e),e=t.buttonHeight||this.options.buttonHeight;return e&&n.css("height",e),n},renderOptionContent:function(t,e){var n,i=d("<div/>",{class:"select-button-group-button",html:t.content});return(t.icon||e&&t.iconSelected)&&(e=d("<img/>",{class:"select-button-group-button-icon",src:e&&t.iconSelected?t.iconSelected:t.icon}),(n=t.iconWidth||this.options.iconWidth)&&e.css("width",n),(n=t.iconHeight||this.options.iconHeight)&&e.css("height",n),i.prepend(e)),f.util.setAttributesBySelector(i,t.attrs),i},getOptionIndex:function(t){return d(t).closest(".select-button-group-button").data("index")},onSelect:function(t){this.isDisabled()||(t=this.getOptionIndex(t.target),this.select(t,{ui:!0}))},onOptionHover:function(t){this.isDisabled()||(t=this.getOptionIndex(t.target),this.trigger("option:hover",this.options.options[t],t))},onMouseOut:function(t){this.isDisabled()||this.trigger("mouseout",t)},getSelection:function(){return this.selection},getSelectionValue:function(t){t=t||this.selection;var e,n=this.options.noSelectionValue;return this.options.multi?0===(e=f.util.toArray(t)).length?void 0!==n?n:[]:e.map(function(t){var e=t.value;return void 0!==e?e:t.content}):t?void 0!==(e=t.value)?e:t.content:void 0!==n?n:void 0},select:function(t,e){var n,i,o=d(this.$(".select-button-group-button")[t]),r=this.options.options[t],s=null,a=null,u=null,c=null,l=(this.options.multi?(o.toggleClass("selected"),o.hasClass("selected")?(u=t,-1===this.selection.indexOf(c=r)&&this.selection.push(r),r.iconSelected&&o.find(".select-button-group-button-icon").attr("src",r.iconSelected)):(s=t,this.selection=f.util.without(this.selection,a=r),r.iconSelected&&o.find(".select-button-group-button-icon").attr("src",r.icon))):(l=(n=this.$(".selected")).index(),i=this.options.options[l],o.toggleClass("selected"),o.hasClass("selected")?(i&&(s=l,a=i,n.removeClass("selected"),i.iconSelected&&n.find(".select-button-group-button-icon").attr("src",i.icon)),u=t,(this.selection=c=r).iconSelected&&o.find(".select-button-group-button-icon").attr("src",r.iconSelected)):this.options.singleDeselect?(s=t,a=r,this.selection=void 0,r.iconSelected&&o.find(".select-button-group-button-icon").attr("src",r.icon)):o.addClass("selected")),f.util.assign({},e));l.deselectedIndex=s,l.deselectedOption=a,l.selectedIndex=u,l.selectedOption=c,this.trigger("option:select",this.selection,t,l)},selectByValue:function(t,e){Array.isArray(t)||(t=[t]);for(var n=this.options.options||[],i=0;i<n.length;i++){var o=n[i];(void 0===o.value&&t.includes(o.content)||void 0!==o.value&&t.find(function(t){return f.util.isEqual(t,o.value)}))&&this.select(i,e)}},deselect:function(){this.$(".selected").removeClass("selected"),this.options.multi?this.selection=[]:this.selection=void 0},isDisabled:function(){return this.$el.hasClass("disabled")},enable:function(){this.$el.removeClass("disabled")},disable:function(){this.$el.addClass("disabled")},pointerdown:function(t){t=this.getOptionIndex(t.target);d(this.$(".select-button-group-button")[t]).addClass("is-in-action"),d(document).on("mouseup.select-button-group touchend.select-button-group",this.pointerup)},pointerup:function(){this.$(".is-in-action").removeClass("is-in-action"),d(document).off("mouseup.select-button-group touchend.select-button-group")}}),Ea=Oa.extend({className:"select-box color-palette",position:function(){var t=this.$(".select-box-selection"),e=t.outerHeight(),t=t.offset(),n=t.left,t=t.top+e;this.options.target!==document.body&&(this.$target=this.$target||d(this.options.target),n-=(e=this.$target.offset()).left-this.$target.scrollLeft(),t-=e.top-this.$target.scrollTop()),this.$options.css({left:n,top:t})}},{OptionsView:Oa.OptionsView.extend({renderOptionContent:function(t){var e=d("<div/>",{class:"select-box-option-content"});return e.css("background-color",t.content),t.icon&&e.prepend(d("<img/>",{class:"select-box-option-icon",src:t.icon})),e}})}),Ca=f.mvc.View.extend({className:"inspector",options:{cellView:void 0,cell:void 0,live:!0,validateInput:function(t,e,n,i){return!t.validity||t.validity.valid},renderFieldContent:void 0,renderLabel:void 0,focusField:void 0,operators:{},multiOpenGroups:!0,container:null,stateKey:function(t){return t.id}},events:{"change [data-attribute]:not([data-custom-field])":"onChangeInput","click .group-label":"onGroupLabelClick","click .btn-list-add":"addListItem","click .btn-list-del":"deleteListItem","mousedown .field":"pointerdown","touchstart .field":"pointerdown","focusin .field":"pointerfocusin","focusout .field":"pointerfocusout"},HTMLEntities:{lt:"<",gt:">",amp:"&",nbsp:" ",quot:'"',cent:"Â¢",pound:"Â£",euro:"â¬",yen:"Â¥",copy:"Â©",reg:"Â®"},init:function(){var t,e=this.options.groups=this.options.groups||{},n=(f.util.bindAll(this,"stopBatchCommand","pointerup","onContentEditableBlur","replaceHTMLEntity"),this.DEFAULT_PATH_WILDCARD="${index}",this.pathWildcard=this.options.pathWildcard,this.widgets={},this._byPath={},this._attributeKeysInUse=[],this.flatAttributes=this.flattenInputs(this.options.inputs),this.expandAttributes=this.expandAttrs(this.options.inputs||{}),this._when={},this._bound={},Object.keys(this.flatAttributes).map(function(t){var e=this.flatAttributes[t];return this._registerDependants.call(this,e,t),e.path=t,e},this));for(t in e){var i=e[t];i&&e.hasOwnProperty(t)&&this.extractExpressionPaths(i.when).forEach(function(t){this._when[t]||(this._when[t]=[])},this)}n=f.util.sortBy(n,"index");this.groupedFlatAttributes=f.util.sortBy(n,function(t){t=this.options.groups[t.group];return t&&t.index||Number.MAX_VALUE}.bind(this)),this.listenTo(this.getModel(),"all",this.onCellChange,this)},_registerDependants:function(t,e){var n,i;t.when&&(n=t.when,i={expression:n,path:e},this.extractExpressionPaths(n).forEach(function(t){(this._when[t]||(this._when[t]=[])).push(i)},this)),this.needsResolving(t)&&(this._bound[e]=t.options),this._registerNestedDependants.call(this,t,e)},_registerNestedDependants:function(n,t){var i,e,o=Array.isArray(t)?t:t.split("/");"object"===n.type&&n.properties?(i=n.properties,Object.keys(i).forEach(function(t){var e=i[t],t=o.concat(t);this._registerDependants(e,t)},this)):"list"===n.type&&n.item?(t=n.item,e=o.concat(null),this._registerDependants(t,e)):"string"!=typeof n.type&&Object.keys(n).forEach(function(t){var e=n[t];"object"===B(e)&&(t=o.concat(t),this._registerDependants(e,t))},this)},cacheInputs:function(){var n={};Array.from(this.$("[data-attribute]")).forEach(function(t){var t=d(t),e=t.attr("data-attribute");n[e]=t},this),this._byPath=n,this._attributeKeysInUse=this.getAttributeKeysInUse()},updateGroupsVisibility:function(){for(var t=this.$groups,e=0,n=t.length;e<n;e++){var i=d(t[e]),o=i.attr("data-name"),o=this.options.groups[o],r=0===i.find("> .field:not(.hidden)").length,r=(i.toggleClass("empty",r),!(!o||!o.when||this.isExpressionValid(o.when)));i.toggleClass("hidden",r)}},expandAttrs:function(t){for(var e={},n=Object.keys(t),i=0;i<n.length;i++){var o=n[i],r=t[o],o=o.split("/");f.util.setByPath(e,o,f.util.isPlainObject(r)?this.expandAttrs(r):r)}return e},flattenInputs:function(t){return f.util.flattenObject(t,"/",function(t){return"string"==typeof t.type})},getModel:function(){return this.options.cell||this.options.cellView.model},onCellChange:function(t,e,n,i){if((i=i||{}).inspector!=this.cid)switch(t){case"remove":this.constructor.instance&&this.trigger("close"),this.remove();break;case"change:position":this.updateInputPosition();break;case"change:size":this.updateInputSize();break;case"change:angle":this.updateInputAngle();break;case"change:source":case"change:target":case"change:vertices":break;default:var o="change:";t.slice(0,o.length)===o&&(o=t.slice(o.length),this._attributeKeysInUse.includes(o)&&this.render({refresh:!0}))}},render:function(t){var n,i,o=t&&t.refresh,r=(o&&this.options.storeGroupsState&&this.storeGroupsState(),this.$el.empty(),this.removeWidgets(),[]);return this.groupedFlatAttributes.forEach(function(t){var e;n!==t.group&&(e=this.options.groups[t.group],i=this.renderGroup({name:t.group,label:e&&e.label}),o||(e&&e.closed?this.closeGroup(i,{init:!0}):this.openGroup(i,{init:!0})),r.push(i)),this.renderTemplate(i,t,t.path),n=t.group},this),this.$document=d(this.el.ownerDocument),this.$groups=d(r),this.$el.append(r),o&&this.options.restoreGroupsState&&this.restoreGroupsState(),this.afterRender(),this},getAttributeKeysInUse:function(){var t=Object.keys(this._byPath).map(function(t){return t.substring(0,t.indexOf("/"))||t}),e=f.util.toArray(this._bound),n=Object.keys(this._when);return f.util.uniq([].concat(t,e,n))},getCellAttributeValue:function(t,e){var n=this.getModel(),n=f.util.getByPath(n.attributes,t,"/");if((e=e||this.flatAttributes[t])&&(void 0===n&&void 0!==e.defaultValue&&(n=e.defaultValue),e.valueRegExp)){if(void 0===n)throw new Error("Inspector: defaultValue must be present when valueRegExp is used.");t=n.match(new RegExp(e.valueRegExp)),n=t&&t[2]}return n},resolvableTypes:["select","select-box","color-palette","select-button-group"],needsResolving:function(t){return!!t&&-1<this.resolvableTypes.indexOf(t.type)&&f.util.isString(t.options)},resolveBindings:function(t){var e;-1<this.resolvableTypes.indexOf(t.type)&&(e=t.options||[],f.util.isString(e)&&(e=f.util.getByPath(this.getModel().attributes,e,"/")||[]),f.util.isObject(e[0])||(e=f.util.toArray(e).map(function(t){return{value:t,content:t}})),t.items=e)},updateBindings:function(i){var t=Object.keys(this._bound).reduce(function(t,e){var n=this._bound[e];return 0===i.indexOf(n)&&t.push(e),t}.bind(this),[]);f.util.isEmpty(t)||(t.forEach(function(t){var e=this.flatAttributes[t];e&&this.renderTemplate(null,e,t,{replace:!0})},this),this.afterPartialRender())},renderFieldContent:function(o,t,r){var e,s;if(f.util.isFunction(this.options.renderFieldContent)&&(e=this.options.renderFieldContent(o,t,r,this)))return d(e).attr({"data-attribute":t,"data-type":o.type,"data-custom-field":!0});switch(o.type){case"select-box":var a,u=f.util.toArray(o.items).findIndex(function(t){var e=t.value,n=r;return void 0===e&&t.content===n||((t=o.key)&&(n=f.util.getByPath(n,t,"/"),e=f.util.getByPath(e,t,"/")),f.util.isEqual(e,n))}),n=f.util.assign({theme:this.options.theme,target:this.options.container},f.util.omit(o,"type","group","index","selectBoxOptionsClass","options"),{options:o.items,selected:u,selectBoxOptionsClass:[f.util.addClassNamePrefix("inspector-select-box-options"),o.selectBoxOptionsClass].filter(function(t){return!!t}).join(" ")});(a=new Oa(n)).$el.attr({"data-attribute":t,"data-type":o.type,"data-overwrite":o.overwrite}),a.render(),n=this.renderOwnLabel(o,t),e=d("<div/>").append(n,a.el),o.previewMode?(s=a.selection,a.on("options:mouseout close",function(){a.selection=s,this.processInput(a.$el,{previewCancel:!0,dry:!0})},this),a.on("option:hover",function(t,e){a.selection=t,this.processInput(a.$el,{dry:!0})},this),a.on("option:select",function(t,e){var n=void 0===s?void 0:a.getSelectionValue(s),i=a.getSelectionValue(t);this.processInput(a.$el,{previewDone:!0,dry:n===i,originalValue:n}),s=t},this)):a.on("option:select",function(t,e){this.processInput(a.$el)},this),this.widgets[t]=a;break;case"color-palette":u=f.util.toArray(o.items).findIndex(function(t){return t.value===r||void 0===t.value&&t.content===r});var i=f.util.assign({theme:this.options.theme,target:this.options.container},f.util.omit(o,"type","group","index","options"),{options:o.items,selected:u});(a=new Ea(i)).$el.attr({"data-attribute":t,"data-type":o.type}),a.render(),n=this.renderOwnLabel(o,t),e=d("<div/>").append(n,a.el),o.previewMode?(s=a.selection,a.on("options:mouseout close",function(){a.selection=s,this.processInput(a.$el,{previewCancel:!0,dry:!0})},this),a.on("option:hover",function(t,e){a.selection=t,this.processInput(a.$el,{dry:!0})},this),a.on("option:select",function(t,e){var n=void 0===s?void 0:a.getSelectionValue(s),i=a.getSelectionValue(t);this.processInput(a.$el,{previewDone:!0,dry:n===i,originalValue:n}),s=t},this)):a.on("option:select",function(t,e){this.processInput(a.$el)},this),this.widgets[t]=a;break;case"select-button-group":o.multi?(u=[],f.util.toArray(o.items).forEach(function(t,e){var n=void 0===t.value?t.content:t.value,i=o.key;i&&(n=f.util.getByPath(n,i,"/")),f.util.toArray(r).find(function(t){return i&&(t=f.util.getByPath(t,i,"/")),f.util.isEqual(n,t)})&&u.push(e)})):u=f.util.toArray(o.items).findIndex(function(t){var e=t.value,n=r;return void 0===e&&t.content===n||((t=o.key)&&(n=f.util.getByPath(n,t,"/"),e=f.util.getByPath(e,t,"/")),f.util.isEqual(e,n))});i=f.util.assign({theme:this.options.theme},f.util.omit(o,"type","group","index","options"),{options:o.items,selected:u});(a=new Sa(i)).$el.attr({"data-attribute":t,"data-type":o.type,"data-overwrite":o.overwrite}),a.render(),n=this.renderOwnLabel(o,t),e=d("<div/>").append(n,a.el),o.previewMode?(s=a.selection,a.on("mouseout",function(){a.selection=s,this.processInput(a.$el,{previewCancel:!0,dry:!0})},this),a.on("option:hover",function(t,e){o.multi?a.selection=f.util.uniq(a.selection.concat([t])):a.selection=t,this.processInput(a.$el,{dry:!0})},this),a.on("option:select",function(t,e){var n=void 0===s?void 0:a.getSelectionValue(s),i=a.getSelectionValue(t),i=f.util.isEqual(n,i);this.processInput(a.$el,{previewDone:!0,dry:i,originalValue:n}),s=t},this)):a.on("option:select",function(t,e){this.processInput(a.$el)},this),this.widgets[t]=a;break;default:e=this.renderOwnFieldContent({options:o,type:o.type,overwrite:o.overwrite,label:o.label||t,attribute:t,value:r})}return e},renderGroup:function(t){t=t||{};var e=d("<div/>").addClass("group").attr("data-name",t.name),t=d("<h3/>").addClass("group-label").text(t.label||t.name);return e.append(t)},renderOwnLabel:function(t,e){var n,i=this.options.renderLabel;if(void 0!==(n="function"==typeof i?i(t,e,this):n))return d(n);switch(t.type){case"select-box":case"color-palette":case"select-button-group":return d("<label/>").html(t.label||e);default:return d("<label/>").text(t.label||e)}},renderOwnFieldContent:function(i){var t,e,n,o,r=this.renderOwnLabel(i.options,i.attribute);switch(i.type){case"number":c=d("<input/>",{type:"number",min:i.options.min,max:i.options.max,step:i.options.step}).val(i.value),t=[r,d("<div/>").addClass("input-wrapper").append(c)];break;case"range":r.addClass("with-output"),e=d("<output/>").text(i.value),s=d("<span/>").addClass("units").text(i.options.unit),(c=d("<input/>",{type:"range",name:i.type,min:i.options.min,max:i.options.max,step:i.options.step}).val(i.value)).on("change input",function(){e.text(c.val())}),t=[r,e,s,c];break;case"textarea":c=d("<textarea/>").text(i.value),t=[r,d("<div/>").addClass("input-wrapper").append(c)];break;case"content-editable":var s=i.value,a=i.options,a=void 0===a?{}:a,u=a.html,u=void 0===u||u,a=a.readonly,a=void 0!==a&&a;u=f.util.isString(s)?(u?f.util.sanitizeHTML(s):this.encodeHTMLEntities(s)).replace(/\n/g,"<br>"):"",c=d("<div/>").prop("contenteditable",!a).toggleClass("content-editable-readonly",Boolean(a)).css("display","inline-block").html(u).on("blur",this.onContentEditableBlur),t=[r,d("<div/>").addClass("input-wrapper").append(c)];break;case"select":var s=i.options.items,c=d("<select/>");i.options.multiple&&c.prop({size:i.options.size||s.length,multiple:!0});f.util.toArray(s).forEach(function(t){var e,n=d("<option/>",{value:t.value}).text(t.content);e=t.value,(i.options.multiple?f.util.toArray(i.value).find(function(t){return f.util.isEqual(e,t)}):f.util.isEqual(e,i.value))&&n.attr("selected","selected"),c.append(n)}),t=[r,c];break;case"toggle":n=d("<span><i/></span>"),c=d("<input/>",{type:"checkbox"}).prop("checked",!!i.value),t=[r,d("<div/>").addClass(i.type).append(c,n)];break;case"color":t=[r,c=d("<input/>",{type:"color"}).val(i.value)];break;case"text":c=d("<input/>",{type:"text"}).val(i.value),t=[r,d("<div/>").addClass("input-wrapper").append(c)];break;case"object":c=d("<div/>"),o=d("<div/>").addClass("object-properties"),t=[r,c.append(o)];break;case"list":n=d("<button/>").addClass("btn-list-add").text(i.options.addButtonLabel||"+"),o=d("<div/>").addClass("list-items"),t=[r,(c=d("<div/>")).append(n,o)]}return c&&c.addClass(i.type).attr({"data-type":i.type,"data-attribute":i.attribute,"data-overwrite":i.overwrite}),d.fn.append.apply(d("<div>"),t).children()},onContentEditableBlur:function(t){var e=d("<input/>",{disabled:!0,tabIndex:-1,style:{width:"1px",height:"1px",border:"none",margin:0,padding:0}}).appendTo(this.$el);e.focus(),e[0].setSelectionRange(0,0),e.blur().remove(),d(t.target).trigger("change")},replaceHTMLEntity:function(t,e){return this.HTMLEntities[e]||""},encodeHTMLEntities:function(t){return t.replace(/[\u00A0-\u9999<>&]/g,function(t){return"&#".concat(t.charCodeAt(0),";")})},renderObjectProperty:function(t){return d("<div/>",{"data-property":(t=t||{}).property,class:"object-property"})},renderListItem:function(t){t=t||{};var e=d("<button/>").addClass("btn-list-del").text(t.options.removeButtonLabel||"-");return d("<div/>",{"data-index":t.index,class:"list-item"}).append(e)},renderFieldContainer:function(t){return d("<div/>",{"data-field":(t=t||{}).path,class:"field "+t.type+"-field"})},renderTemplate:function(t,i,o,e){t=t||this.$el,e=e||{},this.resolveBindings(i),"string"!=typeof i.type&&(i={type:"object",properties:i});var n,r,s,a=this.renderFieldContainer({path:o,type:i.type}),u=(e.hidden&&a.addClass("hidden"),this.getCellAttributeValue(o,i)),c=this.renderFieldContent(i,o,u);a.append(c),f.util.setAttributesBySelector(a,i.attrs),"list"===i.type&&i.item?(f.util.toArray(u).forEach(function(t,e){var n=this.renderListItem({index:e,options:i});this.renderTemplate(n,i.item,o+"/"+e),c.children(".list-items").append(n)},this),u=u&&u.length,n=i&&i.min,r=i&&i.max,this.fixListButtons(c,u,n,r)):"object"===i.type&&i.properties&&(s=this.flattenInputs(i.properties),u=Object.keys(s).map(function(t){var e=s[t];return e.path=t,e}),(u=f.util.sortBy(u,function(t){return t.index})).forEach(function(t){var e=this.renderObjectProperty({property:t.path});this.renderTemplate(e,t,o+"/"+t.path),c.children(".object-properties").append(e)},this)),e.replace?t.find('[data-field="'+o+'"]').replaceWith(a):t.append(a)},updateInputPosition:function(){var t=this._byPath["position/x"],e=this._byPath["position/y"],n=this.getModel().get("position");t&&t.val(n.x),e&&e.val(n.y)},updateInputSize:function(){var t=this._byPath["size/width"],e=this._byPath["size/height"],n=this.getModel().get("size");t&&t.val(n.width),e&&e.val(n.height)},updateInputAngle:function(){var t=this._byPath.angle,e=this.getModel().get("angle");t&&t.val(e)},validateInput:function(t,e,n){switch(t){case"select-box":case"color-palette":var i=this.widgets[n];return i?-1!==i.getSelectionIndex():!1;case"select-button-group":return!!this.widgets[n];default:return this.options.validateInput(e,n,t,this)}},focusField:function(t){var e=this.getOptionsFromPath(t),n=this._byPath[t];if(!n)throw"path not found";this._focusFieldInternal(e,t,n[0])},_focusListField:function(t,e,n){n=n.querySelector("[data-attribute]:not(.hidden)");n&&this._focusFieldInternal(t.item,n.getAttribute("data-attribute"),n)},_focusObjectField:function(t,e,n){var i,o,n=n.querySelector("[data-attribute]:not(.hidden)");n&&(i=n.getAttribute("data-attribute"),o=this.getOptionsFromPath(i),this._focusFieldInternal(o,i,n))},_focusFieldInternal:function(t,e,n){switch(t.type){case"number":case"text":case"range":case"color":case"toggle":case"select":case"textarea":case"content-editable":n.focus();break;case"object":this._focusObjectField(t,e,n);break;case"list":this._focusListField(t,e,n);break;default:this.options.focusField&&this.options.focusField(t,e,n,this)}},onChangeInput:function(t){t.target===t.currentTarget&&this.processInput(d(t.target))},processInput:function(t,e){var n,i=t.attr("data-attribute"),o=t.attr("data-type");this.validateInput(o,t[0],i)&&(this.options.live&&this.updateCell(t,i,e),n=this.getFieldValue(t[0],o),o=this.parse(o,n,t[0]),this.trigger("change:"+i,o,t[0],e))},updateFieldsVisibility:function(){var e=this;this._attributeKeysInUse.forEach(function(t){e.updateBindings(t),e.updateDependants(t)})},updateDependants:function(t){var a=this,e=this._when,n=Object.keys(e),u=this._byPath,i=Object.keys(u),c=this.flatAttributes;function d(t,e){var n,i={};for(n in t){var o,r,s=t[n];if(Array.isArray(s))for(var a=n,u=s,c=(i[a]=[],u.length),l=0;l<c;l++){var p=u[l],p=d.call(this,p,e);i[a].push(p)}else this._isComposite(t)?(r=n,o=d.call(this,s,e),i[r]=o):(r=n,h.call(this,r,s,e,i))}return i;function h(t,e,n,i){for(var o in i[t]={},e){var r=e[o],o=s.call(this,o,n);i[t][o]=r}function s(t,e){for(var n=this.pathWildcard||this.DEFAULT_PATH_WILDCARD,i=[],o=0,r=t.split("/"),s=r.length,a=0;a<s;a++){var u=r[a];u===n&&(u=e[o]||n,o+=1),i.push(u)}return i.join("/")}}}function o(t,e,n){for(var i,o=n.pathWildcard,r=n.comparisonWildcard,s=[],a=e.length,u=t.length,c=0;c<u;c++){var l=t[c],p=(i=l,Array.isArray(i)?i:i.split("/")),h=p.length;if(h===a){for(var d=!0,f=[],v=[],g=0;g<h;g++){var y=p[g],b=e[g],m=y===o,w=b===r;if(y!==b&&!m&&!w){d=!1;break}m?f.push(b):w&&v.push(y)}d&&s.push({path:l,pathWildcardValues:f,comparisonWildcardValues:v})}}return s}(function(t,e){var e=e.split("/"),n=this.pathWildcard||this.DEFAULT_PATH_WILDCARD;return o(t,e,{pathWildcard:n})}).call(this,n,t).forEach(function(t){t=t.path;f.util.toArray(e[t]).forEach(function(t){var e,n=t.path,t=t.expression,r=a._getBareExpression(t),s=a._getExpressionExtras(t);t=i,n=n,(Array.isArray(n)?-1!==(e=n).indexOf(null)?o(t,e,{comparisonWildcard:null}):[{path:e.join("/"),pathWildcardValues:[],comparisonWildcardValues:[]}]:[{path:n,pathWildcardValues:[],comparisonWildcardValues:[]}]).forEach(function(t){var e=t.path,t=t.comparisonWildcardValues,n=u[e],i=n.closest(".field"),o=i.hasClass("hidden"),t=d.call(a,r,t),t=a.isExpressionValid(t),i=(i.toggleClass("hidden",!t),s.otherwise);i&&i.unset&&a.options.live&&(t?o&&a.updateCell(n,e):(a.unsetProperty(e),(i=function(t,e){var n=t[e];if(null==n)for(var i=e.split("/"),o=i.length,r=i[0],s=n=t[r],a=1;a<o;a++){var u=i[a];if(void 0===n)n=(void 0===s?t:s)[r+="/"+u];else{if("object"===(s=n).type&&n.properties)n=n.properties[u];else if("list"===n.type&&n.item)n=n.item;else{if("string"==typeof n.type)break;n=n[u]}r=u}}return n}(c,e))&&a.renderTemplate(null,i,e,{replace:!0,hidden:!0}),a.afterPartialRender()))},a)},a)},this)},unsetProperty:function(t,e){var n=this.getModel(),i=t.split("/"),o=i[0],i=i.slice(1).join("/");(e=e||{}).inspector=this.cid,e["inspector_"+this.cid]=!0,"attrs"===t?n.removeAttr(i,e):t===o?n.unset(o,e):(t=void 0!==(t=n.get(o))?f.util.unsetByPath(t,i,"/"):void 0,n.set(o,t,e))},getOptions:function(t){if(0!==t.length)return t=t.attr("data-attribute"),this.getOptionsFromPath(t)},markForRemoval:function(t,e){var n=this.findParentListByPath(t);n&&(t=t.substr(n.length+1),t=parseInt(t,10),Number.isFinite(t)&&(e.remove[n]=e.remove[n]||[],e.remove[n].includes(t)||e.remove[n].push(t)))},markForUpdate:function(t,e,n,i){t=t.substr(i.length+1);e.update[i]&&f.util.setByPath(e.update[i].value,t,n,"/")},updateCell:function(t,e,n){var l=this.getModel(),i={},p=(t?i[e]=d(t):i=this._byPath,this.startBatchCommand(),{}),h={update:{},remove:{}};f.util.forIn(i,function(t,e){if(!t.closest(".field").hasClass("hidden")){var n,i,o,r,s=t.attr("data-type"),a=t.attr("data-overwrite"),u="false"!==a&&void 0!==a,c=t.hasClass("remove");switch(s){case"list":case"object":c&&this.markForRemoval(e,h);break;default:this.validateInput(s,t[0],e)&&(n=this.getFieldValue(t[0],s),n=this.parse(s,n,t[0]),(i=this.getOptionsFromPath(e)).valueRegExp&&(n=(f.util.getByPath(l.attributes,e,"/")||i.defaultValue).replace(new RegExp(i.valueRegExp),"$1"+n+"$3")),c?this.markForRemoval(e,h):(i=i.parent)&&"object"===i.type&&void 0!==i.overwrite&&!1!==i.overwrite?((o={})[(r=e.split("/"))[r.length-1]]=n,h.update[i.path]={value:o,overwrite:!0}):p[e]={value:n,overwrite:u})}}}.bind(this)),f.util.forIn(p,function(t,e){this.setProperty(e,t.value,f.util.assign({overwrite:t.overwrite},n))}.bind(this)),f.util.sortBy(Object.keys(h.remove),function(t){return t.split("/").length}).reverse().forEach(function(t){var e=h.remove[t];this.removeProperty(t,e,f.util.assign({rewrite:!0},n))}.bind(this)),f.util.forIn(h.update,function(t,e){this.setProperty(e,this.compactDeep(t.value),f.util.assign({rewrite:!0,overwrite:t.overwrite},n))}.bind(this)),this.updateFieldsVisibility(),this.updateGroupsVisibility(),this.stopBatchCommand()},compactDeep:function(t){return Array.isArray(t)?t.reduce(function(t,e){return e&&t.push(this.compactDeep(e)),t}.bind(this),[]):t},findParentListByPath:function(t){for(var e=t.split("/"),n=(e.pop(),e);n.length;){var i=this.getOptionsFromPath(n.join("/"));if(i&&"list"===i.type)return e.slice(0,n.length).join("/");n.pop()}return null},getOptionsFromPath:function(t){for(var e,n=t.split("/"),i=this.expandAttributes,o=[];n.length;){var r=s;i&&"object"===i.type?s="properties":(s=n.shift(),!n.length&&"list"!==i.type||(e=i,o.push(s)));var s=!Number.isNaN(parseInt(s))&&"list"===i.type?"item":s;if(Object(i)!==i||!(s in i||i[t]))return{};i=i[s]||i[t]}return i=f.util.assign({},i),(e=f.util.assign({},e)).path=o.join("/"),r&&"properties"===r&&(e.type="object"),i.parent=e,i},getFieldValue:function(t,e){if(f.util.isFunction(this.options.getFieldValue)){var n=this.options.getFieldValue(t,e,this);if(n)return n.value}var i=d(t);switch(e){case"select-box":case"color-palette":case"select-button-group":var o=i.attr("data-attribute");return this.widgets[o].getSelectionValue();case"content-editable":return i.html().replace(/((<br\s*\/*>)?<\/div>)|(((&nbsp;)|(<br\s*\/*>))?<\/p>)|(<br\s*\/*>)/gi,"\n").replace(/(<([^>]+)>)/gi,"").replace(/&(\w+);/gi,this.replaceHTMLEntity).replace(/\n$/,"");default:return i.val()}},removeProperty:function(t,i,e){var n,o=this.getModel(),r=f.dia.Cell.prototype.prop,s=r.call(o,t);s&&(s=s.reduce(function(t,e,n){return i.includes(n)||t.push(e),t},[]),n=this.flatAttributes[t],Array.isArray(s)&&0===s.length&&!n&&(s=null),r.call(o,t,s,e))},setProperty:function(t,e,n){(n=n||{}).inspector=this.cid;var i,o,r=f.dia.Cell.prototype.prop,s=this.getModel(),a=n.overwrite||!1;n.previewDone&&r.call(s,t,n.originalValue,{rewrite:!0,silent:!0}),void 0===e?f.dia.Cell.prototype.removeProp.call(s,t,n):(o=f.util.isObject(e)&&!a?(i=r.call(s,t),o=Array.isArray(e)?[]:{},f.util.merge(o,i,e)):f.util.clone(e),a&&(n.rewrite=!0),r.call(s,t,o,n))},parse:function(t,e,n){switch(t){case"number":case"range":e=parseFloat(e);break;case"toggle":e=n.checked}return e},startBatchCommand:function(){var t;this.inBatch||(this.inBatch=!0,(t=this.getModel())instanceof f.dia.Cell&&t.startBatch("inspector",{cid:this.cid}))},stopBatchCommand:function(){var t;this.inBatch&&((t=this.getModel())instanceof f.dia.Cell&&t.stopBatch("inspector",{cid:this.cid}),this.inBatch=!1)},afterRender:function(){this.cacheInputs(),this.updateFieldsVisibility(),this.updateGroupsVisibility(),this.trigger("render")},afterPartialRender:function(){this.cacheInputs(),this.updateGroupsVisibility(),this.trigger("render")},addListItem:function(t){var t=d(t.target).parent("[data-attribute]"),e=this.getOptions(t),n=t.children(".list-items"),i=n.children(".list-item"),o=i.last(),o=(0===o.length?-1:parseInt(o.attr("data-index"),10))+1,r=this.renderListItem({index:o,options:e}),o=t.attr("data-attribute")+"/"+o;this.renderTemplate(r,e.item,o),n.append(r);n=(i=n.children(".list-item")).not(".remove").length,this.fixListButtons(t,n,e.min,e.max),this.afterPartialRender(),i=r[0];"object"!==e.item.type&&"list"!==e.item.type&&(i=i.querySelector("[data-attribute]")),this.options.live&&this.updateCell(),this._focusFieldInternal(e.item,o,i)},deleteListItem:function(t){var t=d(t.target),e=t.closest("[data-attribute]"),n=this.getOptions(e),t=t.closest(".list-item");t.hide(),t.addClass("remove"),t.find("[data-field]").each(function(){d(this).hide().addClass("remove")}),t.find("[data-attribute]").each(function(){d(this).hide().addClass("remove")});t=e.children(".list-items").children(".list-item").not(".remove").length;this.fixListButtons(e,t,n.min,n.max),this.afterPartialRender(),this.options.live&&this.updateCell()},fixListButtons:function(t,e,n,i){var o=t.children(".btn-list-add");r=e;"number"!=typeof(i=i)||("number"!=typeof r||r<i)?o.removeClass("hidden"):o.addClass("hidden");var r=t.children(".list-items").children(".list-item").children(".btn-list-del");i=e,"number"!=typeof(o=n)||o<=0||!("number"!=typeof i||i<=0)&&o<i?r.removeClass("hidden"):r.addClass("hidden")},bindDocumentEvents:function(){var t=this.getEventNamespace();this.$document.on("mouseup"+t+" touchend"+t,this.pointerup)},unbindDocumentEvents:function(){this.$document.off(this.getEventNamespace())},pointerdown:function(t){t.stopPropagation(),this.bindDocumentEvents(),this.startBatchCommand(),this._$activeField=d(t.currentTarget).addClass("is-in-action")},pointerup:function(){this.unbindDocumentEvents(),this.stopBatchCommand(),this._$activeField&&(this._$activeField.removeClass("is-in-action"),this._$activeField=null)},pointerfocusin:function(t){t.stopPropagation(),d(t.currentTarget).addClass("is-focused")},pointerfocusout:function(t){t.stopPropagation(),d(t.currentTarget).removeClass("is-focused")},onRemove:function(){this.unbindDocumentEvents(),this.removeWidgets(),this===this.constructor.instance&&(this.constructor.instance=null)},removeWidgets:function(){var t,e=this.widgets;for(t in e)e[t].remove();this.widgets={}},onGroupLabelClick:function(t){t.preventDefault(),this.options.multiOpenGroups||this.closeGroups();t=d(t.target).closest(".group");this.toggleGroup(t)},toggleGroup:function(t){t=f.util.isString(t)?this.$('.group[data-name="'+t+'"]'):d(t);t.hasClass("closed")?this.openGroup(t):this.closeGroup(t)},closeGroup:function(t,e){e=e||{};t=f.util.isString(t)?this.$('.group[data-name="'+t+'"]'):d(t);!e.init&&t.hasClass("closed")||(t.addClass("closed"),this.trigger("group:close",t.data("name"),e))},openGroup:function(t,e){e=e||{};t=f.util.isString(t)?this.$('.group[data-name="'+t+'"]'):d(t);(e.init||t.hasClass("closed"))&&(t.removeClass("closed"),this.trigger("group:open",t.data("name"),e))},closeGroups:function(){for(var t=0,e=this.$groups.length;t<e;t++)this.closeGroup(this.$groups[t])},openGroups:function(){for(var t=0,e=this.$groups.length;t<e;t++)this.openGroup(this.$groups[t])},COMPOSITE_OPERATORS:["not","and","or","nor"],PRIMITIVE_OPERATORS:["eq","ne","regex","text","lt","lte","gt","gte","in","nin","equal"],_isComposite:function(t){return 0<f.util.intersection(this.COMPOSITE_OPERATORS,Object.keys(t)).length},_isPrimitive:function(t){var e=Object.keys(this.options.operators).concat(this.PRIMITIVE_OPERATORS);return 0<f.util.intersection(e,Object.keys(t)).length},_evalCustomPrimitive:function(t,e,n,i){return!!this.options.operators[t].apply(this,[this.getModel(),e].concat(n).concat([i]))},_evalPrimitive:function(e){return Object.keys(e).reduce(function(t,o){var r=e[o];return Object.keys(r).reduce(function(t,e){var n=r[e],i=this.getCellAttributeValue(e);if(f.util.isFunction(this.options.operators[o]))return this._evalCustomPrimitive(o,i,n,e);switch(o){case"eq":return n==i;case"ne":return n!=i;case"regex":return new RegExp(n).test(i);case"text":return!n||f.util.isString(i)&&-1<i.toLowerCase().indexOf(n);case"lt":return i<n;case"lte":return i<=n;case"gt":return n<i;case"gte":return n<=i;case"in":return Array.isArray(n)&&n.includes(i);case"nin":return Array.isArray(n)&&!n.includes(i);case"equal":return f.util.isEqual(n,i);default:return t}}.bind(this),!1)}.bind(this),!1)},_evalExpression:function(o){return this._isPrimitive(o)?this._evalPrimitive(o):Object.keys(o).reduce(function(t,e){var n=o[e];if("not"==e)return!this._evalExpression(n);var i=f.util.toArray(n).map(this._evalExpression,this);switch(e){case"and":return i.every(function(t){return!!t});case"or":return i.some(function(t){return!!t});case"nor":return!i.some(function(t){return!!t});default:return t}}.bind(this),!1)},_getBareExpression:function(t){return f.util.omit(t,"otherwise","dependencies")},_getExpressionExtras:function(t){return{otherwise:f.util.clone(t.otherwise),dependencies:f.util.clone(t.dependencies)}},_extractVariables:function(t){return Array.isArray(t)||this._isComposite(t)?f.util.toArray(t).reduce(function(t,e){return t.concat(this._extractVariables(e))}.bind(this),[]):f.util.toArray(t).reduce(function(t,e){return Object.keys(e)},[])},isExpressionValid:function(t){t=this._getBareExpression(t);return this._evalExpression(t)},extractExpressionPaths:function(t){var e=t&&t.dependencies||[],t=this._getBareExpression(t);return f.util.uniq(this._extractVariables(t).concat(e))},getGroupsStateKey:function(){if(f.util.isFunction(this.options.stateKey))return this.options.stateKey(this.getModel());throw new Error("Inspector: Option stateKey must be a function")},storeGroupsState:function(){var t=this.getGroupsStateKey(),e=f.util.toArray(this.$(".group.closed"));Ca.groupStates[t]=e.map(function(t){return d(t).attr("data-name")})},getGroupsState:function(){return Ca.groupStates[this.getGroupsStateKey()]},restoreGroupsState:function(){function t(n,t){f.util.forIn(t.options.groups,function(t,e){n(t,e)?this.closeGroup(e):this.openGroup(e)}.bind(t))}var n=this.getGroupsStateKey();Ca.groupStates[n]?t(function(t,e){return Ca.groupStates[n].includes(e)},this):t(function(t){return t.closed},this)}},{groupStates:{},instance:null,create:function(t,e){f.util.defaults(e=e||{},{updateCellOnClose:!0,restoreGroupsState:!0,storeGroupsState:!0});var n=e.cell||e.cellView.model,i=this.instance;return i&&i.getModel()===n||(i&&i.el.parentNode&&(e.storeGroupsState&&i.storeGroupsState(),e.updateCellOnClose&&i.updateCell(),i.trigger("close"),i.remove()),i=new this(e).render(),this.instance=i,d(t).html(i.el),e.restoreGroupsState&&i.restoreGroupsState()),i},close:function(){var t,e=this.instance;e&&(t=document.activeElement,d.contains(e.el,t)&&t.blur(),e.trigger("close"),e.remove())}});L.Inspector=Ca}(this.joint.ui=this.joint.ui||{},$,joint);